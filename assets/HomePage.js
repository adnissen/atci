import{c as ct,a as gr,r as i,j as e,b as Re,R as b,d as Ae,u as yn,e as nn,T as vr,f as br,g as Lt,h as at,i as wr,k as Ze,D as Tt}from"./index.js";import{S as jr,D as Fe,a as Be,b as We,c as Ct,d as et,e as tt,f as ge,g as kn,P as yr,h as Ke,u as Nn,i as st,j as rn,k as kr,C as Nr,l as Cr,m as Cn,n as Sr,o as sn,p as Ot,q as Er,r as Rr,R as _r,s as Dr,F as Mr,t as Lr,Q as on}from"./QueuePage.js";import{C as Tr}from"./chevron-left.js";import an from"./ConfigPage.js";/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Pr=ct("camera",Or);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $r=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],Ir=ct("pen-line",$r);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ln=ct("pen",Ar);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Br=ct("refresh-cw",Fr);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],Pt=ct("scissors",Wr);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=[["path",{d:"M12 2v13",key:"1km8f5"}],["path",{d:"m16 6-4-4-4 4",key:"13yo43"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}]],$t=ct("share",Hr);/**
 * @license lucide-react v0.522.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ur=ct("x",zr),cn=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,dn=gr,Vr=(t,n)=>r=>{var s;if((n==null?void 0:n.variants)==null)return dn(t,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:o}=n,m=Object.keys(a).map(c=>{const h=r==null?void 0:r[c],f=o==null?void 0:o[c];if(h===null)return null;const d=cn(h)||cn(f);return a[c][d]}),u=r&&Object.entries(r).reduce((c,h)=>{let[f,d]=h;return d===void 0||(c[f]=d),c},{}),x=n==null||(s=n.compoundVariants)===null||s===void 0?void 0:s.reduce((c,h)=>{let{class:f,className:d,...S}=h;return Object.entries(S).every(j=>{let[R,M]=j;return Array.isArray(M)?M.includes({...o,...u}[R]):{...o,...u}[R]===M})?[...c,f,d]:c},[]);return dn(t,m,x,r==null?void 0:r.class,r==null?void 0:r.className)},qr=Vr("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),pe=i.forwardRef(({className:t,variant:n,size:r,asChild:s=!1,...a},o)=>{const m=s?jr:"button";return e.jsx(m,{className:Re(qr({variant:n,size:r,className:t})),ref:o,...a})});pe.displayName="Button";function Gr(t){const[n,r]=i.useState(()=>window.matchMedia(t).matches);return i.useEffect(()=>{const s=window.matchMedia(t),a=o=>{r(o.matches)};return s.addEventListener("change",a),r(s.matches),()=>{s.removeEventListener("change",a)}},[t]),n}function Sn(){return!Gr("(min-width: 640px)")}function Xr({searchTerm:t,setSearchTerm:n,activeSearchTerm:r,setActiveSearchTerm:s,setSearchLineNumbers:a,setExpandedFiles:o,isSearching:m,isOpen:u,onClose:x,onSearch:c,onClearSearch:h,selectedWatchDirs:f,setSelectedWatchDirs:d,availableWatchDirs:S,selectedSources:j,setSelectedSources:R,availableSources:M}){const y=()=>{n(""),s(""),a({}),o(new Set),h()};return u?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-start justify-center pt-20",children:e.jsx("div",{className:"bg-background border border-border rounded-lg shadow-lg w-full max-w-md mx-4",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Search"}),e.jsx("button",{onClick:x,className:"p-1 text-muted-foreground hover:text-foreground transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search",value:t,onChange:k=>{const $=k.target.value;n($),$.trim()===""&&(s(""),a({}),o(new Set))},onKeyDown:k=>{k.key==="Enter"&&(c(),x())},className:"w-full px-3 py-2 pr-10 text-sm border border-input bg-background text-foreground rounded focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent",autoFocus:!0}),(t||r)&&e.jsx("button",{onClick:y,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",title:"Clear search",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(S.length>1||M.length>1)&&e.jsxs("div",{className:"mb-4 space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground",children:"Search Filters"}),S.length>1&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Watch Directories"}),e.jsxs(Fe,{modal:!1,children:[e.jsx(Be,{asChild:!0,children:e.jsxs("button",{className:"w-full inline-flex items-center justify-between whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[f.length===S.length||f.length===0?"All Directories":`${f.length} Director${f.length===1?"y":"ies"}`,e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsxs(We,{align:"start",className:"w-80",children:[e.jsx(Ct,{children:"Watch Directories"}),e.jsx(et,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 p-2",children:[e.jsx(tt,{checked:f.length===S.length,onCheckedChange:k=>{d(k?[...S]:[])},children:"Select All"}),e.jsx(et,{}),S.map(k=>e.jsx(tt,{checked:f.includes(k),onCheckedChange:$=>{d($?[...f,k]:f.filter(E=>E!==k))},children:e.jsx("span",{className:"truncate",title:k,children:k.split("/").pop()||k})},k))]})]})]})]}),M.length>1&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Transcript Sources"}),e.jsxs(Fe,{modal:!1,children:[e.jsx(Be,{asChild:!0,children:e.jsxs("button",{className:"w-full inline-flex items-center justify-between whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[j.length===M.length?"All Sources":j.length===0?"No Sources":`${j.length} Source${j.length===1?"":"s"}`,e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsxs(We,{align:"start",className:"w-80",children:[e.jsx(Ct,{children:"Sources"}),e.jsx(et,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 p-2",children:[e.jsx(tt,{checked:j.length===M.length,onCheckedChange:k=>{R(k?[...M]:[])},children:"Select All"}),e.jsx(et,{}),M.map(k=>e.jsx(tt,{checked:j.includes(k),onCheckedChange:$=>{R($?[...j,k]:j.filter(E=>E!==k))},children:k},k))]})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{c(),x()},disabled:m,className:"flex-1 px-4 py-2 text-sm bg-primary text-primary-foreground rounded hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-ring disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:`w-4 h-4 ${m?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7",strokeWidth:2}),e.jsx("line",{x1:"16.5",y1:"16.5",x2:"21",y2:"21",strokeWidth:2,strokeLinecap:"round"})]}),"Search"]}),e.jsx("button",{onClick:y,className:"px-4 py-2 text-sm border border-red-300 bg-red-50 text-red-700 rounded hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-500",children:"Clear"}),e.jsx("button",{onClick:x,className:"px-4 py-2 text-sm border border-input bg-background text-foreground rounded hover:bg-accent focus:outline-none focus:ring-2 focus:ring-ring",children:"Cancel"})]})]})})}):null}function Yr({show:t,searchTerm:n,setSearchTerm:r,activeSearchTerm:s,setActiveSearchTerm:a,setSearchLineNumbers:o,setExpandedFiles:m,isSearching:u,queue:x,isAtTop:c,clipStart:h,clipEnd:f,mobileClipPlayerComponent:d,selectedWatchDirs:S,setSelectedWatchDirs:j,availableWatchDirs:R,selectedSources:M,setSelectedSources:y,availableSources:k,showAllFiles:$,onToggleShowAllFiles:E,onSearch:W,onClearSearch:U,onScrollToTop:p,onConfigClick:w,onQueueClick:I,onPlayClip:A}){const[N,D]=i.useState(!1),v=Sn(),q=()=>{r(""),a(""),o({}),m(new Set),U()};return e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:`fixed top-0 left-0 right-0 bg-background/95 border-b border-border px-2 sm:px-4 z-10 backdrop-blur-sm ${v?"py-1":"py-2"}`,children:e.jsx("div",{className:"w-full",children:v?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center gap-1",children:[e.jsx("div",{className:"flex items-center flex-shrink-0",children:e.jsx("span",{className:"text-primary font-bold text-lg",children:"atci"})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(pe,{onClick:w,variant:"ghost",size:"sm",className:"px-2 py-1 rounded hover:bg-accent group text-xs gap-1",title:"Edit configuration",children:[e.jsx("svg",{className:"w-4 h-4 group-hover:animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"})}),e.jsx("span",{children:"Config"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs(pe,{onClick:I,variant:"ghost",size:"sm",className:"px-2 py-1 rounded hover:bg-accent text-xs gap-1",title:"View processing queue",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})}),e.jsx("span",{children:"Queue"})]}),x.length>0&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1",children:x.length})]}),e.jsxs(pe,{onClick:A,disabled:h==null||f===null||f===void 0||!A||d!==null,variant:"ghost",size:"sm",className:"px-2 py-1 rounded hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed text-xs gap-1",title:d!==null?"Clip player is already open":h!=null&&f!==null&&f!==void 0?"Play Clip":"No clip selected",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})}),e.jsx("span",{children:"Clip"})]})]})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"looking for something?",value:n,onChange:P=>{const X=P.target.value;r(X),X.trim()===""&&(a(""),o({}),m(new Set))},onKeyDown:P=>P.key==="Enter"&&W(),className:"w-full px-3 py-1.5 bg-muted text-foreground text-sm rounded-full border border-border focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),(n||s)&&e.jsx("button",{onClick:q,className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-0.5 text-muted-foreground hover:text-foreground transition-colors rounded-full hover:bg-accent",title:"Clear search",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx(pe,{onClick:()=>{$&&E(),W()},disabled:u,variant:$&&!s?"secondary":"default",className:`px-3 py-1.5 rounded-full text-sm font-medium disabled:opacity-50 ${$&&!s?"":"bg-primary hover:bg-primary/90 text-primary-foreground"}`,children:u?e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7",strokeWidth:2}),e.jsx("line",{x1:"16.5",y1:"16.5",x2:"21",y2:"21",strokeWidth:2,strokeLinecap:"round"})]}):"Search"}),e.jsx(pe,{onClick:()=>{q(),$||E(),p()},variant:$&&!s?"default":"secondary",className:"px-3 py-1.5 rounded-full text-sm font-medium",children:"All"})]})]}):e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"flex items-center flex-shrink-0",children:e.jsx("span",{className:"text-primary font-bold text-lg",children:"atci"})}),e.jsx("div",{className:"flex-1 max-w-md mx-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"looking for something?",value:n,onChange:P=>{const X=P.target.value;r(X),X.trim()===""&&(a(""),o({}),m(new Set))},onKeyDown:P=>P.key==="Enter"&&W(),className:"w-full px-4 py-2 bg-muted text-foreground rounded-full border border-border focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),(n||s)&&e.jsx("button",{onClick:q,className:"absolute right-3 top-1/2 transform -translate-y-1/2 p-1 text-muted-foreground hover:text-foreground transition-colors rounded-full hover:bg-accent",title:"Clear search",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex gap-1 items-center flex-shrink-0",children:[e.jsx(pe,{onClick:()=>{$&&E(),W()},disabled:u,variant:$&&!s?"secondary":"default",className:`px-4 py-2 rounded-full text-sm font-medium disabled:opacity-50 ${$&&!s?"":"bg-primary hover:bg-primary/90 text-primary-foreground"}`,children:u?e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7",strokeWidth:2}),e.jsx("line",{x1:"16.5",y1:"16.5",x2:"21",y2:"21",strokeWidth:2,strokeLinecap:"round"})]}):"Search"}),e.jsx(pe,{onClick:()=>{q(),$||E(),p()},variant:$&&!s?"default":"secondary",className:"px-4 py-2 rounded-full text-sm font-medium",children:"All"}),e.jsxs("div",{className:"relative",children:[e.jsx(pe,{onClick:I,variant:"ghost",size:"sm",className:"p-2 rounded-full hover:bg-accent",title:"View processing queue",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 10h16M4 14h16M4 18h16"})})}),x.length>0&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1",children:x.length})]}),e.jsx(pe,{variant:"ghost",size:"sm",onClick:()=>{c||p()},disabled:c,title:c?"Already at top":"Scroll to top",className:"p-2 rounded-full hover:bg-accent disabled:opacity-50",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})})}),e.jsx(pe,{onClick:w,variant:"ghost",size:"sm",className:"p-2 rounded-full hover:bg-accent group",title:"Edit configuration",children:e.jsx("svg",{className:"w-5 h-5 group-hover:animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"})})})]})]})})}),e.jsx(Xr,{searchTerm:n,setSearchTerm:r,activeSearchTerm:s,setActiveSearchTerm:a,setSearchLineNumbers:o,setExpandedFiles:m,isSearching:u,isOpen:N,onClose:()=>D(!1),onSearch:W,onClearSearch:U,selectedWatchDirs:S,setSelectedWatchDirs:j,availableWatchDirs:R,selectedSources:M,setSelectedSources:y,availableSources:k})]})}const Ut=({isOpen:t,filename:n,transcriptInitialValue:r,onTranscriptSave:s,onCancel:a,isTranscriptSubmitting:o,transcriptTargetLineNumber:m})=>{const[u,x]=b.useState(r),c=b.useRef(null);b.useEffect(()=>{t&&x(r)},[t,r]),b.useEffect(()=>{t&&m&&c.current&&setTimeout(()=>{const f=c.current;if(!f)return;const d=f.value.split(`
`);if(m<=d.length){let S=0;for(let M=0;M<m-1;M++)S+=d[M].length+1;f.setSelectionRange(S,S),f.focus();const j=f.scrollHeight/d.length,R=(m-1)*j;f.scrollTop=R-f.clientHeight/2}},100)},[t,m]);const h=()=>{s(u)};return t?e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-card border border-border rounded-lg max-w-5xl w-full mx-4 max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-border",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground",children:["Edit Transcript - ",n]}),e.jsx("button",{onClick:a,className:"p-1 text-muted-foreground hover:text-foreground hover:bg-accent rounded transition-colors",title:"Close",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"text-md font-medium text-foreground",children:"Transcript (.txt)"}),e.jsx("button",{onClick:h,disabled:o,className:"px-3 py-1.5 text-xs font-normal text-primary-foreground bg-primary border border-transparent rounded hover:bg-primary/90 disabled:opacity-50 transition-colors",children:o?"Saving...":"Save Transcript"})]}),e.jsx("textarea",{ref:c,value:u,onChange:f=>x(f.target.value),className:"w-full h-64 p-3 border border-input bg-background text-foreground rounded-md font-mono text-sm leading-6 focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent",placeholder:"Enter transcript content...",readOnly:o})]})})]})}):null},un=({open:t,onOpenChange:n,selectedTime:r,clipStart:s,clipEnd:a,clipTranscript:o,currentTranscript:m,onSetClipStart:u,onSetClipEnd:x,onClearClip:c,onClipBlock:h,blockStartTime:f,blockEndTime:d,children:S})=>{const j=o!==null&&o!==m,R=!j&&a!==null&&r>=a,M=!j&&s!==null&&r<=s;return e.jsxs(Fe,{modal:!1,open:t,onOpenChange:n,children:[e.jsx(Be,{asChild:!0,children:S}),e.jsxs(We,{align:"start",side:"right",sideOffset:8,children:[e.jsxs(ge,{onClick:()=>u(r),disabled:R,className:`flex items-center gap-2 ${R?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(Pt,{size:16,className:"text-green-600"}),"Set Clip Start"]}),e.jsxs(ge,{onClick:()=>x(r),disabled:M,className:`flex items-center gap-2 ${M?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(Pt,{size:16,className:"text-red-600"}),"Set Clip End"]}),h&&f!==void 0&&d!==void 0&&e.jsxs(ge,{onClick:()=>h(f,d),className:"flex items-center gap-2",children:[e.jsx(Pt,{size:16,className:"text-purple-600"}),"Clip Block"]}),(s!==null||a!==null)&&e.jsxs(ge,{onClick:c,className:"flex items-center gap-2",children:[e.jsx(Ur,{size:16,className:"text-gray-600"}),"Clear Clip"]})]})]})},Qr=b.memo(({startTime:t,endTime:n,visible:r,text:s,name:a,fullPath:o,isSearchResult:m=!1,lineNumbers:u,onEditSuccess:x,fullTranscript:c="",isSmallScreen:h=!1,onSetRightPaneUrl:f,clipStart:d,clipEnd:S,clipTranscript:j,onSetClipStart:R,onSetClipEnd:M,onClearClip:y,onClipBlock:k})=>{const[$,E]=b.useState(!1),[W,U]=b.useState(!1),[p,w]=b.useState(!1),[I,A]=b.useState(null),[N,D]=b.useState(null),[v,q]=b.useState(!1),[P,X]=b.useState(null),T=C=>{const g=C.split(":"),V=parseInt(g[0],10),ce=parseInt(g[1],10),ie=g[2].split("."),Se=parseInt(ie[0],10),Te=parseInt(ie[1]||"0",10);return V*3600+ce*60+Se+Te/1e3},te=b.useMemo(()=>{if(!t||!n||d===null||d===void 0||j!==a)return!1;const C=T(t),g=T(n);return d>=C&&d<=g},[t,n,d,j,a]),Z=b.useMemo(()=>{if(!t||!n||S===null||S===void 0||j!==a)return!1;const C=T(t),g=T(n);return S>=C&&S<=g},[t,n,S,j,a]),we=b.useMemo(()=>{if(!t||!n||d===null||d===void 0||S===null||S===void 0||j!==o)return!1;const C=T(t),g=T(n);return C>=d&&g<=S},[t,n,d,S,j,a]),ee=te||Z||we,he=(C,g)=>{X({time:C,type:g}),q(!0)};if(b.useEffect(()=>{},[s]),b.useEffect(()=>{},[t,n]),b.useEffect(()=>{const C=g=>{const V=g.target;if(V.classList.contains("timestamp-link")){g.preventDefault();const ce=V.getAttribute("data-url");ce&&f&&f(ce)}};return document.addEventListener("click",C),()=>{document.removeEventListener("click",C)}},[f]),!r||s==="WEBVTT")return null;const ae=b.useMemo(()=>{const C=/(\d{2}:\d{2}:\d{2}\.\d{3})/g;return s.replace(C,g=>{const V=T(g);return`<span class="text-sky-700 hover:text-sky-600 underline cursor-pointer timestamp-link" data-timestamp="${g}" data-url="/player/${encodeURIComponent(a)}?time=${V}">${g}</span>`})},[s,a]),ve=()=>{E(!0)},ue=async C=>{var g;if(C.trim()===c.trim()){E(!1);return}U(!0);try{const V=(g=document.querySelector('meta[name="csrf-token"]'))==null?void 0:g.getAttribute("content"),ce=await fetch(Ae("/api/transcripts/replace"),{method:"POST",headers:{"X-CSRF-Token":V||"","Content-Type":"application/json"},body:JSON.stringify({video_path:a,new_content:C})});if(ce.ok)x&&x(),E(!1);else{const ie=await ce.json();alert(`Error: ${ie.error||"Failed to update transcript"}`)}}catch(V){console.error("Error updating transcript:",V),alert("Error: Failed to update transcript. Please try again.")}finally{U(!1)}},se=()=>{E(!1)},fe=()=>{w(!0)},ne=async C=>{var g;if(C.trim()===c.trim()){w(!1);return}U(!0);try{const V=(g=document.querySelector('meta[name="csrf-token"]'))==null?void 0:g.getAttribute("content"),ce=await fetch(Ae("/api/transcripts/replace"),{method:"POST",headers:{"X-CSRF-Token":V||"","Content-Type":"application/json"},body:JSON.stringify({video_path:o,new_content:C})});if(ce.ok)x&&x(),w(!1);else{const ie=await ce.json();alert(`Error: ${ie.error||"Failed to update timestamp"}`)}}catch(V){console.error("Error updating timestamp:",V),alert("Error: Failed to update timestamp. Please try again.")}finally{U(!1)}},ke=()=>{w(!1)};if(t&&n&&t===n)return e.jsx(e.Fragment,{});const Y=u[0],le=u[u.length-1],L=()=>{const C=[];return m&&ee?C.push("bg-gradient-to-r","from-primary/10","to-amber-500/10","border-l-4","border-primary","pl-2"):m?C.push("bg-primary/10","border-l-4","border-primary","pl-2"):ee&&C.push("bg-amber-500/10","border-l-4","border-amber-500","pl-2"),C.join(" ")};return e.jsxs("div",{className:L(),children:[ee&&e.jsx("div",{className:"flex items-center gap-1 text-xs text-amber-600 dark:text-amber-400 mb-1",children:e.jsx("span",{className:"bg-amber-500/20 px-1 py-0.5 rounded text-amber-700 dark:text-amber-300 font-medium",children:"Clip"})}),t&&n&&e.jsx("div",{className:"group",children:e.jsxs("span",{className:"relative",children:[e.jsx("div",{className:"flex items-center gap-1 min-w-0",children:e.jsxs("div",{className:"text-muted-foreground text-sm font-mono flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:`text-xs mr-2 flex-shrink-0 text-right w-8 cursor-pointer transition-colors duration-200 ${I===Y||N==="timestamp"?"text-blue-600 hover:text-blue-700":"text-muted-foreground hover:text-blue-500"}`,onClick:()=>D(N==="timestamp"?null:"timestamp"),onMouseEnter:()=>A(Y),onMouseLeave:()=>A(null),children:Y}),e.jsxs("span",{className:"min-w-0",children:[e.jsx(un,{open:v&&(P==null?void 0:P.type)==="start",onOpenChange:C=>{q(C),C||X(null)},selectedTime:(P==null?void 0:P.time)||(t?T(t):0),clipStart:d??null,clipEnd:S??null,clipTranscript:j??null,currentTranscript:a,onSetClipStart:R||(()=>{}),onSetClipEnd:M||(()=>{}),onClearClip:y||(()=>{}),onClipBlock:k?(C,g)=>k(C,g,s,o):void 0,blockStartTime:t?T(t):void 0,blockEndTime:n?T(n):void 0,children:e.jsx("span",{onClick:()=>t&&he(T(t),"start"),className:"text-sky-700 hover:text-sky-600 underline cursor-pointer",onMouseEnter:()=>A(Y),onMouseLeave:()=>A(null),children:t})})," --> ",e.jsx(un,{open:v&&(P==null?void 0:P.type)==="end",onOpenChange:C=>{q(C),C||X(null)},selectedTime:(P==null?void 0:P.time)||(n?T(n):0),clipStart:d??null,clipEnd:S??null,clipTranscript:j??null,currentTranscript:a,onSetClipStart:R||(()=>{}),onSetClipEnd:M||(()=>{}),onClearClip:y||(()=>{}),onClipBlock:k?(C,g)=>k(C,g,s,o):void 0,blockStartTime:t?T(t):void 0,blockEndTime:n?T(n):void 0,children:e.jsx("span",{onClick:()=>n&&he(T(n),"end"),className:"text-sky-700 hover:text-sky-600 underline cursor-pointer",onMouseEnter:()=>A(Y),onMouseLeave:()=>A(null),children:n})})]})]})}),e.jsx("div",{className:"flex items-center gap-1 min-w-0",children:e.jsxs("div",{className:"text-muted-foreground text-sm font-mono flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("span",{className:`text-xs mr-2 flex-shrink-0 text-right w-8 cursor-pointer transition-colors duration-200 ${I===le||N==="content"?"text-blue-600 hover:text-blue-700":"text-muted-foreground hover:text-blue-500"}`,onClick:()=>D(N==="content"?null:"content"),onMouseEnter:()=>A(le),onMouseLeave:()=>A(null),children:le}),e.jsx("div",{className:"text-foreground font-mono text-sm leading-relaxed whitespace-pre-wrap break-words flex-1 min-w-0",dangerouslySetInnerHTML:{__html:ae},onMouseEnter:()=>A(le),onMouseLeave:()=>A(null)})]})}),N&&e.jsx("div",{className:"absolute left-0 top-0 z-10 dropdown-menu-container",children:e.jsxs(Fe,{modal:!1,open:N==="timestamp"||N==="content",onOpenChange:C=>!C&&D(null),children:[e.jsx(Be,{asChild:!0,children:e.jsx("div",{className:"invisible"})}),e.jsxs(We,{align:"start",side:"right",sideOffset:8,children:[e.jsx(ge,{asChild:!0,children:e.jsxs("a",{href:`/api/frame?filename=${encodeURIComponent(o)}&time=${T(t)+(T(n)-T(t))/2}&text=${encodeURIComponent(s)}`,target:"_blank",className:"flex items-center gap-2 w-full",children:[e.jsx(Pr,{size:16,className:"text-[#6d28d9]"}),"View Frame"]})}),e.jsxs(ge,{onClick:()=>fe(),className:"flex items-center gap-2",children:[e.jsx(ln,{size:16,className:"text-[#3b82f6]"}),"Edit Line"]})]})]})})]})}),s!=null&&!t&&!n&&e.jsx("div",{className:"group",children:e.jsxs("span",{className:"relative",children:[e.jsx("div",{className:"flex items-center gap-1 min-w-0",children:e.jsxs("div",{className:"text-muted-foreground text-sm font-mono flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("span",{className:`text-xs mr-2 flex-shrink-0 text-right w-8 cursor-pointer transition-colors duration-200 ${I===le||N==="content"?"text-blue-600 hover:text-blue-700":"text-muted-foreground hover:text-blue-500"}`,onClick:()=>D(N==="content"?null:"content"),onMouseEnter:()=>A(le),onMouseLeave:()=>A(null),children:le}),e.jsx("div",{className:"text-foreground font-mono text-sm leading-relaxed whitespace-pre-wrap break-words flex-1 min-w-0",dangerouslySetInnerHTML:{__html:ae},onMouseEnter:()=>A(le),onMouseLeave:()=>A(null)})]})}),N==="content"&&e.jsx("div",{className:"absolute left-0 top-0 z-10 dropdown-menu-container",children:e.jsxs(Fe,{modal:!1,open:!0,onOpenChange:C=>!C&&D(null),children:[e.jsx(Be,{asChild:!0,children:e.jsx("div",{className:"invisible"})}),e.jsx(We,{align:"start",side:"right",sideOffset:8,children:e.jsxs(ge,{onClick:ve,className:"flex items-center gap-2",children:[e.jsx(ln,{size:16,className:"text-[#3b82f6]"}),"Edit Line"]})})]})})]})}),e.jsx(Ut,{isOpen:$,filename:o,transcriptInitialValue:c,onTranscriptSave:ue,onCancel:se,isTranscriptSubmitting:W,transcriptTargetLineNumber:le}),e.jsx(Ut,{isOpen:p,filename:o,transcriptInitialValue:c,onTranscriptSave:ne,onCancel:ke,isTranscriptSubmitting:W,transcriptTargetLineNumber:Y})]})}),En=({visible:t=!1,name:n,fullPath:r,className:s="",searchTerm:a="",text:o="",loading:m=!1,error:u=null,visibleLines:x=[],expandContext:c,onEditSuccess:h,isSmallScreen:f=!1,onSetRightPaneUrl:d,clipStart:S,clipEnd:j,clipTranscript:R,onSetClipStart:M,onSetClipEnd:y,onClearClip:k,onClipBlock:$})=>{const E=b.useRef(null),W=N=>{const D=/\d{2}:\d{2}:\d{2}\.\d{3}/g,v=N.match(D);return v&&v.length>=2&&N.includes("-->")?{hasRange:!0,time1:v[0],time2:v[1]}:{hasRange:!1}},U=(N,D)=>{const v=N.split(`
`).flatMap(T=>T.split("\r")),q=[],P=a.toLowerCase(),X=D.length===1&&D[0]===-1||D.length===0;for(let T=0;T<v.length;T++){const te=v[T],Z=W(te);if(Z.hasRange&&Z.time1&&Z.time2){const we=T<v.length-1?v[T+1]:"",ee=we.toLowerCase(),he=a?ee.includes(P):!1,ae=[T+1,T+2],ve=X||ae.some(ue=>D.includes(ue));q.push({startTime:Z.time1,endTime:Z.time2,text:we,visible:ve,isSearchResult:he,originalIndex:q.length,lineNumbers:ae}),T++}else{const we=te.toLowerCase(),ee=a?we.includes(P):!1,he=[T+1],ae=X||he.some(ve=>D.includes(ve));q.push({text:te,visible:ae,isSearchResult:ee,originalIndex:q.length,lineNumbers:he})}}return q},p=b.useMemo(()=>U(o,x),[o,x,a]),w=b.useMemo(()=>{const N=x.length===1&&x[0]===-1;if(x.length===0||N)return p.map(q=>({type:"block",data:q}));const D=[];let v=0;for(let q=0;q<p.length;q++){const P=p[q];if(P.visible){v>0&&(D.push({type:"message",data:{count:v,line:P.lineNumbers[P.lineNumbers.length-1],direction:"up"}}),v=0),D.push({type:"block",data:P});let X=0;for(let T=q+1;T<p.length;T++){const te=p[T];if(te.visible)break;X+=te.lineNumbers.length}X>0&&D.push({type:"message",data:{count:X,line:P.lineNumbers[P.lineNumbers.length-1],direction:"down"}})}else v+=P.lineNumbers.length}return D},[p,x]),I=b.useMemo(()=>w.map((N,D)=>({...N,virtualIndex:D,originalIndex:D})),[w]),A=(N,D)=>{c(r,D,N)};return t?e.jsx("div",{className:`w-full ${f?"px-4 py-4 bg-transparent":"p-3 sm:p-6 bg-card border border-border"} ${s}`,children:e.jsxs("div",{className:"space-y-4",children:[m&&e.jsx("div",{className:"text-muted-foreground",children:"Loading transcript..."}),u&&e.jsxs("div",{className:"text-destructive",children:["Error: ",u]}),!m&&!u&&e.jsxs("div",{className:"text-muted-foreground text-left relative",children:[a&&p.filter(N=>N.isSearchResult).length===0&&e.jsxs("div",{className:"text-muted-foreground italic",children:['No matches found for "',a,'" in this transcript.']}),p.length>0&&e.jsx("div",{ref:E,className:"space-y-0.5 max-h-[600px] overflow-y-auto",style:{WebkitOverflowScrolling:"touch",scrollBehavior:"smooth"},children:I.map(N=>e.jsx("div",{children:N.type==="block"?e.jsx(Qr,{fullPath:r,startTime:N.data.startTime,endTime:N.data.endTime,visible:N.data.visible,text:N.data.text,name:n,isSearchResult:N.data.isSearchResult,lineNumbers:N.data.lineNumbers,onEditSuccess:h,fullTranscript:o,isSmallScreen:f,onSetRightPaneUrl:d,clipStart:S,clipEnd:j,clipTranscript:R,onSetClipStart:M,onSetClipEnd:y,onClearClip:k,onClipBlock:$}):e.jsx("div",{className:"text-muted-foreground italic",children:e.jsxs("span",{className:"cursor-pointer hover:text-primary hover:underline",onClick:()=>A(N.data.line,N.data.direction),children:["[",N.data.count," lines ",N.data.direction==="up"?"above":"below","]"]})})},N.type==="block"?`${N.data.originalIndex}-${N.virtualIndex}`:`message-${N.virtualIndex}`))})]})]})}):null},St=i.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Re("rounded-xl border bg-card text-card-foreground shadow",t),...n}));St.displayName="Card";const Rn=i.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Re("flex flex-col space-y-1.5 p-6",t),...n}));Rn.displayName="CardHeader";const Kr=i.forwardRef(({className:t,...n},r)=>e.jsx("h3",{ref:r,className:Re("font-semibold leading-none tracking-tight",t),...n}));Kr.displayName="CardTitle";const Jr=i.forwardRef(({className:t,...n},r)=>e.jsx("p",{ref:r,className:Re("text-sm text-muted-foreground",t),...n}));Jr.displayName="CardDescription";const Et=i.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Re("p-6 pt-0",t),...n}));Et.displayName="CardContent";const _n=i.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Re("flex items-center p-6 pt-0",t),...n}));_n.displayName="CardFooter";function Vt({isOpen:t,videoPath:n,source:r,onClose:s,onRegenerate:a}){var W,U;const[,o]=i.useState([]),[,m]=i.useState([]),[u,x]=i.useState([]),[c,h]=i.useState(""),[f,d]=i.useState(!1),[S,j]=i.useState(null),[R,M]=i.useState(!1),y=p=>{if(!r)return!1;if(p.type==="subtitle"){const w=r.match(/subtitles.*\((\d+)\)/);return!!(w&&parseInt(w[1])===p.subtitle_stream_index)}else if(p.type==="whisper")return r===p.model;return!1};i.useEffect(()=>{t&&n&&k()},[t,n]);const k=async()=>{d(!0),j(null);try{const[p,w]=await Promise.all([fetch(Ae(`/api/video/subtitle-streams?path=${encodeURIComponent(n)}`)),fetch(Ae("/api/models/list"))]);let I=[],A=[];if(p.ok){const D=await p.json();D.success&&(I=D.data)}if(w.ok){const D=await w.json();D.success&&(A=D.data.filter(v=>v.downloaded))}o(I),m(A);const N=[];I.forEach(D=>{const v=D.language||"Unknown",q={id:`subtitle_${D.index}`,type:"subtitle",label:`Subtitles: ${v} (${D.index})`,subtitle_stream_index:D.index};y(q)&&(q.label+=" (last used)"),N.push(q)}),A.forEach(D=>{const v={id:`whisper_${D.name}`,type:"whisper",label:`Whisper Model: ${D.name}`,model:D.name};y(v)&&(v.label+=" (last used)"),N.push(v)}),x(N),h("")}catch(p){console.error("Error fetching regeneration data:",p),j("Failed to load regeneration options")}finally{d(!1)}},$=async()=>{if(!c)return;const p=u.find(w=>w.id===c);if(p){M(!0);try{await a(p.type==="whisper"?p.model:void 0,p.type==="subtitle"?p.subtitle_stream_index:void 0),s()}catch(w){console.error("Regeneration failed:",w),j("Failed to regenerate transcript")}finally{M(!1)}}},E=()=>{R||s()};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background border border-border rounded-lg p-6 w-96 max-w-90vw max-h-80vh overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Regenerate Transcript"}),e.jsx("button",{onClick:E,disabled:R,className:"text-muted-foreground hover:text-foreground disabled:opacity-50",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose a processing method for: ",((W=n.split("/").pop())==null?void 0:W.split("\\").pop())||n]}),f&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Loading options..."]})}),S&&e.jsx("div",{className:"text-sm text-destructive mb-4 p-3 bg-destructive/10 border border-destructive/20 rounded",children:S}),!f&&!S&&u.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground mb-4 p-3 bg-muted border border-border rounded",children:"No processing options available. Make sure you have subtitle streams or downloaded Whisper models."}),!f&&!S&&u.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Processing Method:"}),e.jsxs(Fe,{children:[e.jsx(Be,{asChild:!0,children:e.jsxs(pe,{variant:"outline",className:"w-full justify-between",disabled:R,children:[c&&((U=u.find(p=>p.id===c))==null?void 0:U.label)||"Select a processing method...",e.jsx("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsx(We,{className:"w-full min-w-[400px]",children:u.map(p=>e.jsxs(ge,{onClick:()=>h(p.id),className:"flex flex-col items-start p-3",children:[e.jsx("div",{className:"font-medium",children:p.label}),e.jsx("div",{className:"text-xs text-muted-foreground",children:p.type==="subtitle"?"Extract from embedded subtitles":"AI transcription"})]},p.id))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:E,disabled:R,className:"px-4 py-2 text-sm border border-input bg-background text-foreground rounded hover:bg-accent focus:outline-none focus:ring-1 focus:ring-ring disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{onClick:$,disabled:R||!c,className:"px-4 py-2 text-sm bg-primary text-primary-foreground rounded hover:bg-primary/90 focus:outline-none focus:ring-1 focus:ring-ring disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:R?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Regenerating..."]}):"Regenerate"})]})]})]})}):null}function Zr({file:t,onExpand:n,isExpanded:r,isRegenerating:s,isReplacing:a,isProcessing:o,onRegenerate:m,onReplace:u,onRename:x,onRegenerateMeta:c,formatDate:h,getSourceChipColor:f,isSmallScreen:d=!1,mobileTranscriptRowRefs:S}){var E;const[j,R]=i.useState(!1),M=((E=t.name.split("/").pop())==null?void 0:E.split("\\").pop())||t.name,y=W=>{W.stopPropagation(),R(!0)},k=async(W,U)=>{await m({stopPropagation:()=>{}},W,U)};if(d){const W=e.jsxs("div",{className:"w-full bg-background py-4 px-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1 mr-2 min-w-0 text-left",id:"ref",ref:U=>{S.current[t.base_name]=U},children:[e.jsx("h3",{className:"font-medium text-base break-all overflow-hidden text-left",title:t.name,children:M}),t.source&&e.jsx("div",{className:"text-left",children:e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium mt-2 ${f(t.source)}`,children:t.source})})]}),e.jsxs(Fe,{modal:!1,children:[e.jsx(Be,{asChild:!0,children:e.jsx("button",{onClick:U=>U.stopPropagation(),className:"p-2 text-muted-foreground hover:text-primary hover:bg-accent rounded-md transition-colors",title:"Actions",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})}),e.jsxs(We,{align:"end",children:[e.jsxs(ge,{onClick:U=>x(U),disabled:o||s||a,children:[e.jsx("span",{children:"Rename"}),e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]}),t.transcript&&e.jsxs(ge,{onClick:U=>u(U),disabled:a,className:"text-blue-600 hover:text-blue-700",children:[e.jsx("span",{children:"Edit transcript"}),!a&&e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})]}),t.transcript&&e.jsxs(ge,{onClick:y,disabled:s,className:"text-green-600 hover:text-green-700",children:[e.jsx("span",{children:"Regenerate transcript"}),s?e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]}),o&&e.jsxs(ge,{disabled:!0,children:[e.jsx("span",{children:"Processing transcript..."}),e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]})]})]})]}),e.jsx("div",{className:"space-y-3 mb-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"min-w-0 text-left",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Date:"}),e.jsx("div",{className:"font-medium break-words text-xs",children:h(t.created_at)})]}),e.jsxs("div",{className:"min-w-0 text-left",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Last Generated:"}),e.jsx("div",{className:"font-medium break-words text-xs",children:h(t.last_generated||"")})]}),e.jsxs("div",{className:"min-w-0 text-left",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Lines:"}),e.jsx("div",{className:"font-medium text-xs",children:t.line_count||0})]}),e.jsxs("div",{className:"min-w-0 text-left",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Length:"}),e.jsx("div",{className:"font-medium flex items-center gap-1 text-xs",children:t.length?t.length:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"-"}),e.jsx("button",{onClick:U=>c(U),disabled:s,className:"p-1 text-muted-foreground hover:text-primary hover:bg-accent rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate video length",children:s?e.jsx("svg",{className:"w-3 h-3 animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})})]})]})}),t.transcript&&e.jsx("button",{onClick:n,className:"w-full px-4 py-2 text-sm font-medium text-primary-foreground bg-primary hover:bg-primary/90 rounded-md transition-colors flex items-center justify-center gap-2",children:r?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Hide Transcript"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Show Transcript"]})})]});return e.jsxs(e.Fragment,{children:[W,e.jsx(Vt,{isOpen:j,videoPath:t.full_path||t.name,source:t.source,onClose:()=>R(!1),onRegenerate:k})]})}const $=e.jsxs(St,{className:"w-full",children:[e.jsx(Rn,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 mr-2 min-w-0",children:[e.jsx("h3",{className:"font-medium text-base break-all overflow-hidden",title:t.name,children:M}),t.source&&e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium mt-2 ${f(t.source)}`,children:t.source})]}),e.jsxs(Fe,{modal:!1,children:[e.jsx(Be,{asChild:!0,children:e.jsx("button",{onClick:W=>W.stopPropagation(),className:"p-2 text-muted-foreground hover:text-primary hover:bg-accent rounded-md transition-colors",title:"Actions",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})}),e.jsxs(We,{align:"end",children:[e.jsxs(ge,{onClick:W=>x(W),disabled:o||s||a,children:[e.jsx("span",{children:"Rename"}),e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]}),t.transcript&&e.jsxs(ge,{onClick:W=>u(W),disabled:a,className:"text-blue-600 hover:text-blue-700",children:[e.jsx("span",{children:"Edit transcript"}),!a&&e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})]}),t.transcript&&e.jsxs(ge,{onClick:y,disabled:s,className:"text-green-600 hover:text-green-700",children:[e.jsx("span",{children:"Regenerate transcript"}),s?e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]}),o&&e.jsxs(ge,{disabled:!0,children:[e.jsx("span",{children:"Processing transcript..."}),e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]})]})]})]})}),e.jsx(Et,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-muted-foreground",children:"Date:"}),e.jsx("div",{className:"font-medium break-words",children:h(t.created_at)})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Generated:"}),e.jsx("div",{className:"font-medium break-words",children:h(t.last_generated||"")})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-muted-foreground",children:"Lines:"}),e.jsx("div",{className:"font-medium",children:t.line_count||0})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-muted-foreground",children:"Length:"}),e.jsx("div",{className:"font-medium flex items-center justify-center gap-1",children:t.length?t.length:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"-"}),e.jsx("button",{onClick:W=>c(W),disabled:s,className:"p-1 text-muted-foreground hover:text-primary hover:bg-accent rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate video length",children:s?e.jsx("svg",{className:"w-3 h-3 animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})})]})]})}),t.transcript&&e.jsx(_n,{className:"pt-3",children:e.jsx("button",{onClick:n,className:"w-full px-4 py-2 text-sm font-medium text-primary-foreground bg-primary hover:bg-primary/90 rounded-md transition-colors flex items-center justify-center gap-2",children:r?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Hide Transcript"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Show Transcript"]})})})]});return e.jsxs(e.Fragment,{children:[$,e.jsx(Vt,{isOpen:j,videoPath:t.full_path||t.name,source:t.source,onClose:()=>R(!1),onRegenerate:k})]})}function es({sortedFiles:t,activeSearchTerm:n,searchResults:r,showAllFiles:s,transcriptData:a,expandedFiles:o,searchLineNumbers:m,onExpandFile:u,onRegenerate:x,onReplace:c,onRename:h,onFetchTranscript:f,onSetRightPaneUrl:d,formatDate:S,getSourceChipColor:j,expandContext:R,clipStart:M,clipEnd:y,clipTranscript:k,onSetClipStart:$,onSetClipEnd:E,onClearClip:W,onClipBlock:U,mobileTranscriptRowRefs:p}){return e.jsx("div",{className:"divide-y divide-border",children:t.map(w=>{if(!(n?r.includes(w.full_path):s))return null;const A=a[w.full_path]||{text:"",loading:!1,error:null},N=o.has(w.full_path);return e.jsxs("div",{className:"w-full",children:[e.jsx("div",{id:"ref",children:e.jsx(Zr,{file:w,onExpand:()=>u(w.full_path),isExpanded:N,isRegenerating:!w.transcript,isReplacing:!w.transcript,isProcessing:!1,onRegenerate:D=>x(w.full_path,w.source,D),onReplace:D=>c(w.full_path,D),onRename:D=>h(w.full_path,D),onRegenerateMeta:D=>x(w.full_path,w.source,D),formatDate:S,getSourceChipColor:j,isSmallScreen:!0,mobileTranscriptRowRefs:p})}),N&&e.jsx(En,{visible:!0,name:w.base_name,fullPath:w.full_path,className:"w-full",searchTerm:n,text:A.text,loading:A.loading,error:A.error,visibleLines:m[w.full_path]||[],expandContext:R,onEditSuccess:()=>{f(w.full_path)},isSmallScreen:!0,onSetRightPaneUrl:d,clipStart:M,clipEnd:y,clipTranscript:k,onSetClipStart:D=>$(D,w.full_path),onSetClipEnd:D=>E(D,w.full_path),onClearClip:W,onClipBlock:U})]},w.base_name)})})}function ts({watchDirectory:t,isSmallScreen:n,activeSearchTerm:r,searchLineNumbers:s,setSearchLineNumbers:a,expandedFiles:o,setExpandedFiles:m,transcriptData:u,setTranscriptData:x,currentProcessingFile:c,showAllFiles:h,leftPaneWidth:f,setLeftPaneWidth:d,isLeftPaneWidthMeasured:S,setIsLeftPaneWidthMeasured:j,clipStart:R,clipEnd:M,clipTranscript:y,fileRowRefs:k,transcriptRowRefs:$,mobileTranscriptRowRefs:E,leftPaneRef:W,onSetRightPaneUrl:U,onSetClipStart:p,onSetClipEnd:w,onClearClip:I,onClipBlock:A}){var en;const{files:N,refreshFiles:D,selectedWatchDirs:v,setSelectedWatchDirs:q,availableWatchDirs:P,selectedSources:X,setSelectedSources:T,availableSources:te}=yn(),[Z,we]=nn("sortColumn","created_at"),[ee,he]=nn("sortDirection","desc"),[ae,ve]=i.useState(!1),[ue,se]=i.useState(!1),[fe,ne]=i.useState(""),[ke,Y]=i.useState(""),[le,L]=i.useState(!1),[C,g]=i.useState(!1),[V,ce]=i.useState(""),[ie,Se]=i.useState(""),[Te,Oe]=i.useState(!1),[ot,Pe]=i.useState(""),[je,ze]=i.useState(!1),[$e,_e]=i.useState(""),[ft,Je]=i.useState(void 0),mt=l=>{var _;return c?((_=c.video_path.split("/").pop())==null?void 0:_.replace(/\.(mp4|MP4)$/,""))===l:!1},De=Object.keys(s).filter(l=>s[l]&&s[l].length>0),Ue=n||S&&f<753;i.useEffect(()=>{if(!W.current)return;const l=new ResizeObserver(O=>{for(const _ of O)d(_.contentRect.width),j(!0)});return l.observe(W.current),()=>{l.disconnect()}},[d,j]),i.useEffect(()=>{F()},[o]);const Me=[...N].sort((l,O)=>{let _,B;switch(Z){case"created_at":_=l.created_at||"",B=O.created_at||"";break;case"last_generated":_=l.last_generated||"",B=O.last_generated||"";break;case"name":_=l.name||"",B=O.name||"";break;case"line_count":_=l.line_count||0,B=O.line_count||0;break;case"length":_=l.length||"0:00",B=O.length||"0:00";break;case"source":_=l.source||"",B=O.source||"";break;default:return 0}if(Z==="created_at"||Z==="last_generated"){const H=new Date(_.replace(" ","T")).getTime(),oe=new Date(B.replace(" ","T")).getTime();return ee==="asc"?H-oe:oe-H}return typeof _=="string"&&typeof B=="string"?ee==="asc"?_.localeCompare(B):B.localeCompare(_):ee==="asc"?_-B:B-_}),Ve=(l,O,_)=>{const B=s[l];if(!B)return;const H=[...B];if(O==="up")for(let oe=1;oe<=16;oe++){const J=_-oe;J>0&&!H.includes(J)&&H.push(J)}else for(let oe=1;oe<=16;oe++){const J=_+oe;H.includes(J)||H.push(J)}a(oe=>({...oe,[l]:H}))},qe=l=>{Z===l?he(O=>O==="asc"?"desc":"asc"):(we(l),he("asc"))},Ge=l=>Z!==l?e.jsx("svg",{className:"w-4 h-4 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):ee==="asc"?e.jsx("svg",{className:"w-4 h-4 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):e.jsx("svg",{className:"w-4 h-4 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),z=l=>{if(!l)return"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300";const O={tiny:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",base:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",small:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",medium:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",large:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",subtitles:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-200",manual:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200"};for(const[_,B]of Object.entries(O))if(l.includes(_))return B;return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"},re=(l,O=!0)=>{if(!l||l==="N/A")return"N/A";try{const _=new Date(l.replace(" ","T"));if(isNaN(_.getTime()))return"N/A";const B=(_.getMonth()+1).toString().padStart(2,"0"),H=_.getDate().toString().padStart(2,"0"),oe=_.getFullYear();if(!O)return`${B}-${H}-${oe}`;let J=_.getHours();const Qe=_.getMinutes().toString().padStart(2,"0"),ht=J>=12?"pm":"am";return J=J%12,J=J||12,`${B}-${H}-${oe} ${J}:${Qe}${ht}`}catch{return"N/A"}},Ne=async l=>{x(O=>({...O,[l]:{text:"",loading:!0,error:null}}));try{const O=await fetch(Ae(`/api/transcripts?video_path=${encodeURIComponent(l)}`));if(!O.ok)throw new Error(`Failed to fetch transcript: ${O.status} ${O.statusText}`);const _=await O.json();if(_.success){const B=_.data;x(H=>({...H,[l]:{text:B,loading:!1,error:null}}))}else throw new Error(`Failed to fetch transcript: ${_.error}`)}catch(O){x(_=>({..._,[l]:{text:"",loading:!1,error:O instanceof Error?O.message:"An unknown error occurred"}}))}},F=async()=>{const O=Array.from(o).filter(_=>{const B=u[_];return!B||!B.loading&&!B.text&&!B.error});await Promise.all(O.map(_=>Ne(_)))},K=(l,O,_)=>{_.stopPropagation(),_e(l),Je(O),ze(!0)},Q=async(l,O)=>{await G($e,{stopPropagation:()=>{}},l,O)},G=async(l,O,_,B)=>{var oe;O.stopPropagation();const H=(oe=document.querySelector('meta[name="csrf-token"]'))==null?void 0:oe.getAttribute("content");try{const J={video_path:l};_&&(J.model=_),B!==void 0&&(J.subtitle_stream_index=B);const Qe=await fetch(Ae("/api/transcripts/regenerate"),{method:"POST",headers:{"X-CSRF-Token":H||"","Content-Type":"application/json"},body:JSON.stringify(J)});if(Qe.ok)await D();else{const ht=await Qe.json().catch(()=>({error:"Unknown error"}));console.error("Failed to regenerate transcript:",ht.error),alert(`Failed to regenerate transcript: ${ht.error}`)}}catch(J){console.error("Regeneration error:",J),alert("Error regenerating transcript. Please try again.")}},de=async(l,O)=>{O.stopPropagation();try{const _=await fetch(Ae(`/api/transcripts?video_path=${encodeURIComponent(l)}`));if(_.ok){const B=await _.json();if(B.success){const H=B.data;ne(l),Y(H),se(!0)}else throw new Error(B.error)}else throw new Error("Failed to fetch transcript")}catch(_){console.error("Error fetching transcript for replacement:",_),alert("Error loading transcript. Please try again.")}finally{}},ye=async l=>{var O;L(!0);try{const _=(O=document.querySelector('meta[name="csrf-token"]'))==null?void 0:O.getAttribute("content"),B=await fetch(Ae("/api/transcripts/replace"),{method:"POST",headers:{"X-CSRF-Token":_||"","Content-Type":"application/json"},body:JSON.stringify({video_path:fe,new_content:l})});if(B.ok)se(!1),ne(""),Y(""),o.has(fe)&&await Ne(fe),await D();else{const H=await B.json().catch(()=>({error:"Unknown error"}));console.error("Failed to replace transcript:",H.error),alert(`Failed to replace transcript: ${H.error}`)}}catch(_){console.error("Replace transcript error:",_),alert("Error replacing transcript. Please try again.")}finally{L(!1)}},Ce=()=>{se(!1),ne(""),Y("")},Ie=async(l,O)=>{var B;O.stopPropagation();const _=((B=l.split("/").pop())==null?void 0:B.split("\\").pop())||l;ce(l),Se(_),Pe(""),g(!0),setTimeout(()=>{const H=document.getElementById("new-filename");H&&H.select()},100)},Ee=async()=>{var O,_;if(!ie.trim()){Pe("Filename cannot be empty");return}const l=((O=V.split("/").pop())==null?void 0:O.split("\\").pop())||V;if(ie===l){Pe("New filename must be different from current filename");return}if(/[\/\\]/.test(ie)){Pe("Filename cannot contain path separators");return}Oe(!0),Pe("");try{const B=(_=document.querySelector('meta[name="csrf-token"]'))==null?void 0:_.getAttribute("content"),H=V.split("/");H[H.length-1]=ie.trim();const oe=H.join("/"),J=await fetch(Ae("/api/transcripts/rename"),{method:"POST",headers:{"X-CSRF-Token":B||"","Content-Type":"application/json"},body:JSON.stringify({video_path:V,new_path:oe})});if(!J.ok){const Qe=await J.json();throw new Error(Qe.error||`Failed to rename file: ${J.status} ${J.statusText}`)}g(!1),ce(""),Se(""),await D()}catch(B){console.error("Error renaming file:",B),Pe(B instanceof Error?B.message:"An error occurred while renaming the file")}finally{Oe(!1)}},Xe=()=>{g(!1),ce(""),Se(""),Pe("")},Ye=l=>{q(O=>O.includes(l)?O.filter(B=>B!==l):[...O,l])},Le=()=>{q(P)},dt=()=>{q([])},wt=l=>{T(O=>O.includes(l)?O.filter(B=>B!==l):[...O,l])},fr=()=>{T(te)},mr=()=>{T([])},hr=l=>{m(O=>{const _=new Set(O);return _.has(l)?_.delete(l):_.add(l),_})},pr=async()=>{var oe;const l=Me.filter(J=>r&&!De.includes(J.full_path)?!1:J.transcript);if(l.length===0){alert("No files with transcripts to regenerate");return}const O=X[0],_=l.length,B=`Regenerate ${_} file${_===1?"":"s"} using "${O}" source?`;if(!confirm(B))return;ve(!0);const H=(oe=document.querySelector('meta[name="csrf-token"]'))==null?void 0:oe.getAttribute("content");try{let J=0,Qe=0;(await Promise.allSettled(l.map(async ut=>{const tn=await fetch(Ae("/api/transcripts/regenerate"),{method:"POST",headers:{"X-CSRF-Token":H||"","Content-Type":"application/json"},body:JSON.stringify({video_path:ut.full_path})});if(!tn.ok){const xr=await tn.json().catch(()=>({error:"Unknown error"}));throw new Error(`${ut.full_path}: ${xr.error}`)}return ut.full_path}))).forEach(ut=>{ut.status==="fulfilled"?J++:(Qe++,console.error("Bulk regeneration error:",ut.reason))}),Qe>0?alert(`Bulk regeneration completed with ${J} successes and ${Qe} errors. Check console for details.`):alert(`Successfully queued ${J} files for regeneration`)}catch(J){console.error("Bulk regeneration error:",J),alert("Error during bulk regeneration. Please try again.")}finally{ve(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:W,className:`${`w-full overflow-y-auto scrollbar-hide px-2 sm:px-4 ${t?n?"pt-24 pb-4":"pt-16 pb-4":"py-10"}`}`,children:[(P.length>1||te.length>1)&&e.jsxs("div",{className:`mb-6 flex items-center gap-4 ${Ue?"px-4":""}`,children:[P.length>1&&e.jsxs(Fe,{modal:!1,children:[e.jsx(Be,{asChild:!0,children:e.jsxs("button",{className:"inline-flex items-center justify-center whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[v.length===P.length||v.length===0?"All Directories":`${v.length} Director${v.length===1?"y":"ies"}`,e.jsx("svg",{className:"ml-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsxs(We,{align:"start",className:"w-80",children:[e.jsx(Ct,{children:"Watch Directories"}),e.jsx(et,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 p-2",children:[e.jsx(tt,{checked:v.length===P.length,onCheckedChange:l=>{l?Le():dt()},className:"font-medium",children:"Select All"}),e.jsx(et,{}),P.map(l=>e.jsx(tt,{checked:v.includes(l),onCheckedChange:()=>Ye(l),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"font-medium text-sm",children:l.split("/").pop()||l}),e.jsx("span",{className:"text-xs text-muted-foreground",children:l})]})},l))]})]})]}),te.length>1&&e.jsxs(Fe,{modal:!1,children:[e.jsx(Be,{asChild:!0,children:e.jsxs("button",{className:"inline-flex items-center justify-center whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[X.length===te.length||X.length===0?"All Transcript Sources":`${X.length} Source${X.length===1?"":"s"}`,e.jsx("svg",{className:"ml-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsxs(We,{align:"start",className:"w-80",children:[e.jsx(Ct,{children:"Sources"}),e.jsx(et,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 p-2",children:[e.jsx(tt,{checked:X.length===te.length,onCheckedChange:l=>{l?fr():mr()},className:"font-medium",children:"Select All"}),e.jsx(et,{}),te.map(l=>e.jsx(tt,{checked:X.includes(l),onCheckedChange:()=>wt(l),children:e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${z(l)}`,children:l})})},l))]})]})]})]}),X.length===1&&e.jsxs("div",{className:`mb-6 flex items-center justify-between ${Ue?"px-4":""}`,children:[e.jsx("button",{onClick:pr,disabled:ae,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:ae?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2 animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Regenerating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Regenerate All (",X[0],")"]})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:(()=>{const l=Me.filter(O=>r&&!De.includes(O.full_path)?!1:O.transcript);return`${l.length} file${l.length===1?"":"s"} with transcripts`})()})]}),e.jsxs("div",{children:[De.length>0&&e.jsx("div",{className:`mb-6 p-4 bg-accent/10 border border-accent/20 rounded-md ${Ue?"mx-4":""}`,children:e.jsxs("h3",{className:"text-sm font-medium text-accent-foreground mb-2",children:["Found in ",De.length," file(s)"]})}),r&&De.length===0&&e.jsx("div",{className:`mb-6 p-4 bg-muted border border-border rounded-md ${Ue?"mx-4":""}`,children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:['No files found containing "',r,'"']})}),!r&&!h&&e.jsx("div",{className:`mb-6 p-4 bg-muted border border-border rounded-md ${Ue?"mx-4":""}`,children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Search to get started!"})}),!n&&!S?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading..."})}):Ue?e.jsx(es,{sortedFiles:Me,activeSearchTerm:r,searchResults:De,showAllFiles:h,transcriptData:u,expandedFiles:o,searchLineNumbers:s,onExpandFile:l=>{const O=Me.find(_=>_.full_path===l);O!=null&&O.transcript&&hr(l)},onRegenerate:K,onReplace:de,onRename:Ie,onFetchTranscript:Ne,onSetRightPaneUrl:U,formatDate:l=>re(l,f>=1129),getSourceChipColor:z,expandContext:Ve,clipStart:R,clipEnd:M,clipTranscript:y,onSetClipStart:p,onSetClipEnd:w,onClearClip:I,onClipBlock:A,mobileTranscriptRowRefs:E}):e.jsxs(vr,{className:"table-fixed w-full",children:[e.jsx(br,{children:e.jsxs(Lt,{children:[e.jsxs(at,{className:"text-center w-[34%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>qe("name"),children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Filename",Ge("name")]}),r&&De.length>0&&e.jsx("span",{className:"text-xs text-primary ml-2",children:"(Search Results)"})]}),e.jsx(at,{className:"text-center w-[14%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>qe("created_at"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Date",Ge("created_at")]})}),e.jsx(at,{className:"text-center w-[14%] pl-6 cursor-pointer hover:bg-accent transition-colors",onClick:()=>qe("last_generated"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Generated",Ge("last_generated")]})}),e.jsx(at,{className:"text-center w-[10%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>qe("line_count"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Lines",Ge("line_count")]})}),e.jsx(at,{className:"text-center w-[10%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>qe("length"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Length",Ge("length")]})}),e.jsx(at,{className:"text-center w-[8%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>qe("source"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Source",Ge("source")]})}),e.jsx(at,{className:"text-center w-[10%]",children:"Actions"})]})}),e.jsx(wr,{children:Me.map(l=>{var B;if(!(r?De.includes(l.full_path):h))return e.jsx(e.Fragment,{});const _=u[l.full_path]||{text:"",loading:!1,error:null};return e.jsxs(e.Fragment,{children:[e.jsxs(Lt,{ref:H=>{k.current[l.full_path]=H},"data-filename":l.full_path,className:"",onClick:()=>{l.transcript&&m(H=>{const oe=new Set(H);return oe.has(l.full_path)?oe.delete(l.full_path):oe.add(l.full_path),oe})},children:[e.jsx(Ze,{className:"font-medium w-[34%] max-w-0",children:e.jsx("div",{className:"leading-tight overflow-hidden whitespace-nowrap text-ellipsis",style:{direction:"rtl",textAlign:"left",unicodeBidi:"plaintext",fontSize:(()=>{var J;const oe=(((J=l.name.split("/").pop())==null?void 0:J.split("\\").pop())||l.name).length;return oe<=15?"14px":oe<=20?"13px":"12px"})()},title:l.name,children:((B=l.name.split("/").pop())==null?void 0:B.split("\\").pop())||l.name})}),e.jsx(Ze,{className:"w-[14%] pr-10 text-foreground",children:re(l.created_at,f>=1129)}),e.jsx(Ze,{className:"w-[14%] text-center text-foreground",children:re(l.last_generated||"",f>=1129)}),e.jsx(Ze,{className:"w-[10%] text-foreground",children:l.line_count||0}),e.jsx(Ze,{className:"w-[10%] text-foreground",children:l.length?l.length:e.jsx("button",{onClick:H=>G(l.full_path,H),disabled:!l.transcript,className:"p-1 text-muted-foreground hover:text-primary hover:bg-accent rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate video length",children:l.transcript?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-4 h-4 animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),e.jsx(Ze,{className:"w-[8%] text-center",children:l.source?f>=1129?e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{className:`inline-flex items-center rounded-full font-medium ${z(l.source)} ${l.source.length>10?"px-1.5 py-0.5 text-xs scale-75":"px-2.5 py-0.5 text-xs"}`,children:l.source})}):e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`w-3 h-3 rounded-full ${z(l.source).split(" ").find(H=>H.startsWith("bg-"))||"bg-gray-200"} ${z(l.source).split(" ").find(H=>H.startsWith("dark:bg-"))||""}`,title:l.source})}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(Ze,{className:"w-[10%] text-center p-2",children:e.jsxs(Fe,{modal:!1,children:[e.jsx(Be,{asChild:!0,children:e.jsx("button",{onClick:H=>H.stopPropagation(),className:"p-2 text-muted-foreground hover:text-primary hover:bg-accent rounded-md transition-colors",title:"Actions",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})}),e.jsxs(We,{align:"end",children:[e.jsxs(ge,{onClick:H=>Ie(l.full_path,H),disabled:!l.transcript,children:[e.jsx("span",{children:"Rename"}),e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]}),l.transcript&&e.jsxs(ge,{onClick:H=>de(l.full_path,H),disabled:!l.transcript,className:"text-blue-600 hover:text-blue-700",children:[e.jsx("span",{children:"Edit transcript"}),!l.transcript&&e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})]}),l.transcript&&e.jsxs(ge,{onClick:H=>K(l.full_path,l.source,H),disabled:!l.transcript,className:"text-green-600 hover:text-green-700",children:[e.jsx("span",{children:"Regenerate transcript"}),l.transcript?e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]}),mt(l.full_path)&&e.jsxs(ge,{disabled:!0,children:[e.jsx("span",{children:"Processing transcript..."}),e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]})]})]})})]},l.full_path),e.jsx(Lt,{ref:H=>{$.current[l.full_path]=H},"data-filename":l.full_path,children:e.jsx(Ze,{colSpan:7,className:"p-0",children:e.jsx(En,{visible:o.has(l.full_path),name:l.base_name,fullPath:l.full_path,className:"w-full",searchTerm:r,text:_.text,loading:_.loading,error:_.error,visibleLines:s[l.full_path]||[],expandContext:Ve,onEditSuccess:()=>{Ne(l.full_path)},onSetRightPaneUrl:U,clipStart:R,clipEnd:M,clipTranscript:y,onSetClipStart:H=>p(H,l.full_path),onSetClipEnd:H=>w(H,l.full_path),onClearClip:I,onClipBlock:A})})})]})})})]})]})]}),e.jsx(Ut,{isOpen:ue,filename:fe,transcriptInitialValue:ke,onTranscriptSave:ye,onCancel:Ce,isTranscriptSubmitting:le}),C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background border border-border rounded-lg p-6 w-96 max-w-90vw",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Rename File"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:['Renaming "',((en=V.split("/").pop())==null?void 0:en.split("\\").pop())||V,'" (this will rename the video, transcript, and meta files)']}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"new-filename",className:"block text-sm font-medium mb-2",children:"New filename (without extension):"}),e.jsx("input",{id:"new-filename",type:"text",value:ie,onChange:l=>Se(l.target.value),onKeyDown:l=>{l.key==="Enter"&&!Te&&ie.trim()?Ee():l.key==="Escape"&&Xe()},className:"w-full px-3 py-2 border border-input bg-background text-foreground rounded focus:outline-none focus:ring-1 focus:ring-ring focus:border-transparent",placeholder:"Enter new filename",disabled:Te,autoFocus:!0})]}),ot&&e.jsx("div",{className:"text-sm text-destructive",children:ot}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:Xe,className:"px-4 py-2 text-sm border border-input bg-background text-foreground rounded hover:bg-accent focus:outline-none focus:ring-1 focus:ring-ring",disabled:Te,children:"Cancel"}),e.jsx("button",{onClick:Ee,className:"px-4 py-2 text-sm bg-primary text-primary-foreground rounded hover:bg-primary/90 focus:outline-none focus:ring-1 focus:ring-ring disabled:opacity-50 disabled:cursor-not-allowed",disabled:Te||!ie.trim(),children:Te?"Renaming...":"Rename"})]})]})]})}),e.jsx(Vt,{isOpen:je,videoPath:$e,source:ft,onClose:()=>ze(!1),onRegenerate:Q})]})}function ns(){return e.jsx("div",{className:"w-full h-full flex items-center justify-center p-8 bg-background",children:e.jsxs("div",{className:"text-center text-foreground",children:[e.jsx("div",{className:"mb-6",children:e.jsx("svg",{className:"w-16 h-16 mx-auto text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),e.jsx("h3",{className:"text-xl font-medium mb-3 text-foreground",children:"Clip Editor"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Click on any timestamp in a transcript to open the clip editor and create video clips from specific moments."})]})})}const Nt=i.forwardRef(({className:t,type:n,...r},s)=>e.jsx("input",{type:n,className:Re("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...r}));Nt.displayName="Input";const Dn=i.forwardRef(({className:t,...n},r)=>e.jsx("textarea",{className:Re("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n}));Dn.displayName="Textarea";function rs(t){const n=i.useRef({value:t,previous:t});return i.useMemo(()=>(n.current.value!==t&&(n.current.previous=n.current.value,n.current.value=t),n.current.previous),[t])}var _t="Checkbox",[ss,bo]=kn(_t),[os,Yt]=ss(_t);function as(t){const{__scopeCheckbox:n,checked:r,children:s,defaultChecked:a,disabled:o,form:m,name:u,onCheckedChange:x,required:c,value:h="on",internal_do_not_use_render:f}=t,[d,S]=Nn({prop:r,defaultProp:a??!1,onChange:x,caller:_t}),[j,R]=i.useState(null),[M,y]=i.useState(null),k=i.useRef(!1),$=j?!!m||!!j.closest("form"):!0,E={checked:d,disabled:o,setChecked:S,control:j,setControl:R,name:u,form:m,value:h,hasConsumerStoppedPropagationRef:k,required:c,defaultChecked:nt(a)?!1:a,isFormControl:$,bubbleInput:M,setBubbleInput:y};return e.jsx(os,{scope:n,...E,children:is(f)?f(E):s})}var Mn="CheckboxTrigger",Ln=i.forwardRef(({__scopeCheckbox:t,onKeyDown:n,onClick:r,...s},a)=>{const{control:o,value:m,disabled:u,checked:x,required:c,setControl:h,setChecked:f,hasConsumerStoppedPropagationRef:d,isFormControl:S,bubbleInput:j}=Yt(Mn,t),R=st(a,h),M=i.useRef(x);return i.useEffect(()=>{const y=o==null?void 0:o.form;if(y){const k=()=>f(M.current);return y.addEventListener("reset",k),()=>y.removeEventListener("reset",k)}},[o,f]),e.jsx(Ke.button,{type:"button",role:"checkbox","aria-checked":nt(x)?"mixed":x,"aria-required":c,"data-state":An(x),"data-disabled":u?"":void 0,disabled:u,value:m,...s,ref:R,onKeyDown:rn(n,y=>{y.key==="Enter"&&y.preventDefault()}),onClick:rn(r,y=>{f(k=>nt(k)?!0:!k),j&&S&&(d.current=y.isPropagationStopped(),d.current||y.stopPropagation())})})});Ln.displayName=Mn;var Tn=i.forwardRef((t,n)=>{const{__scopeCheckbox:r,name:s,checked:a,defaultChecked:o,required:m,disabled:u,value:x,onCheckedChange:c,form:h,...f}=t;return e.jsx(as,{__scopeCheckbox:r,checked:a,defaultChecked:o,disabled:u,required:m,onCheckedChange:c,name:s,form:h,value:x,internal_do_not_use_render:({isFormControl:d})=>e.jsxs(e.Fragment,{children:[e.jsx(Ln,{...f,ref:n,__scopeCheckbox:r}),d&&e.jsx(In,{__scopeCheckbox:r})]})})});Tn.displayName=_t;var On="CheckboxIndicator",Pn=i.forwardRef((t,n)=>{const{__scopeCheckbox:r,forceMount:s,...a}=t,o=Yt(On,r);return e.jsx(yr,{present:s||nt(o.checked)||o.checked===!0,children:e.jsx(Ke.span,{"data-state":An(o.checked),"data-disabled":o.disabled?"":void 0,...a,ref:n,style:{pointerEvents:"none",...t.style}})})});Pn.displayName=On;var $n="CheckboxBubbleInput",In=i.forwardRef(({__scopeCheckbox:t,...n},r)=>{const{control:s,hasConsumerStoppedPropagationRef:a,checked:o,defaultChecked:m,required:u,disabled:x,name:c,value:h,form:f,bubbleInput:d,setBubbleInput:S}=Yt($n,t),j=st(r,S),R=rs(o),M=kr(s);i.useEffect(()=>{const k=d;if(!k)return;const $=window.HTMLInputElement.prototype,W=Object.getOwnPropertyDescriptor($,"checked").set,U=!a.current;if(R!==o&&W){const p=new Event("click",{bubbles:U});k.indeterminate=nt(o),W.call(k,nt(o)?!1:o),k.dispatchEvent(p)}},[d,R,o,a]);const y=i.useRef(nt(o)?!1:o);return e.jsx(Ke.input,{type:"checkbox","aria-hidden":!0,defaultChecked:m??y.current,required:u,disabled:x,name:c,value:h,form:f,...n,tabIndex:-1,ref:j,style:{...n.style,...M,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});In.displayName=$n;function is(t){return typeof t=="function"}function nt(t){return t==="indeterminate"}function An(t){return nt(t)?"indeterminate":t?"checked":"unchecked"}function ls({className:t,...n}){return e.jsx(Tn,{"data-slot":"checkbox",className:Re("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:e.jsx(Pn,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(Nr,{className:"size-3.5"})})})}const fn=({buttons:t})=>{const n=t.reduce((s,a,o)=>{const m=a.group??0;return s[m]||(s[m]=[]),s[m].push({...a,originalIndex:o}),s},{}),r=Object.keys(n).map(Number).sort((s,a)=>s-a);return e.jsx("div",{className:"mt-2 space-y-3",children:r.map(s=>e.jsx("div",{className:"flex items-center gap-2 justify-center flex-wrap",children:n[s].map(a=>e.jsx(pe,{variant:"outline",size:"sm",onClick:a.onClick,className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:a.color?{borderColor:a.color,color:a.color}:void 0,children:a.text},a.originalIndex))},s))})},pt=({filename:t,clip_url:n,start_time_formatted:r="00:00:00.000",end_time_formatted:s="00:00:10.000",font_size:a="",text:o="",display_text:m=!1,onBack:u,onStartTimeChange:x,onEndTimeChange:c})=>{const[h,f]=i.useState(r),[d,S]=i.useState(s),[j,R]=i.useState(a),[M,y]=i.useState(o),[k,$]=i.useState(m),[E,W]=i.useState(!1),[U,p]=i.useState(n||""),[w,I]=i.useState(!1),[A,N]=i.useState(!1),[D]=i.useState(t),[v,q]=i.useState({}),[P,X]=i.useState("video"),T=i.useRef(null),te=i.useRef(null),Z=L=>{const C=L.split(":"),g=parseInt(C[0],10),V=parseInt(C[1],10),ce=parseFloat(C[2]);return g*3600+V*60+ce},we=L=>{L=Math.max(0,L);const C=Math.floor(L/3600),g=Math.floor(L%3600/60),V=L%60;return`${C.toString().padStart(2,"0")}:${g.toString().padStart(2,"0")}:${V.toFixed(3).padStart(6,"0")}`},ee=L=>/^(\d{2}):(\d{2}):(\d{2})\.(\d{3})$/.test(L),he=(L="mp4")=>{if(!h||!d||!ee(h)||!ee(d))return"";const C=Z(h),g=Z(d);if(C<0||g<=C)return"";const V=new URLSearchParams({filename:t,start_time:C.toString(),end_time:g.toString(),format:L,cachebuster:Date.now().toString()});return M&&M.trim()!==""&&V.set("text",M),j&&j.trim()!==""&&V.set("font_size",j),k&&V.set("display_text","true"),"/api/clip?"+V.toString()},ae=L=>{let C=`${D}_clip_start_${h}_end_${d}.${L}`;if(M&&M.trim()!==""){const g=M.trim().substring(0,50).replace(/[^a-zA-Z0-9\s\-_]/g,"").replace(/\s+/g,"_");g&&(C=g+`.${L}`)}return C},ve=async L=>{const C=he(L),g=ae(L);q(V=>({...V,[L]:!0}));try{const V=await fetch(C);if(!V.ok)throw new Error(`Failed to download file: ${V.statusText}`);const ce=await V.blob(),ie={mp4:"video/mp4",gif:"image/gif",mp3:"audio/mpeg"},Se=new File([ce],g,{type:ie[L]||"application/octet-stream"});await navigator.share({files:[Se]})}catch(V){console.error("Error sharing:",V);try{await navigator.share({title:`Clip from ${g}`,url:window.location.origin+C})}catch(ce){console.error("Error with fallback sharing:",ce)}}finally{q(V=>({...V,[L]:!1}))}},ue=(L,C,g,V)=>{if(!ee(L))return;const ie=Z(L)+C,Se=we(ie);g(Se),V&&V(ie)},se=(L,C,g)=>[{text:"+1s",onClick:()=>ue(L,1,C,g),color:"#22c55e",group:0},{text:"+0.5s",onClick:()=>ue(L,.5,C,g),color:"#22c55e",group:0},{text:"+0.1s",onClick:()=>ue(L,.1,C,g),color:"#22c55e",group:0},{text:"+0.01s",onClick:()=>ue(L,.01,C,g),color:"#22c55e",group:0},{text:"-1s",onClick:()=>ue(L,-1,C,g),color:"#ef4444",group:1},{text:"-0.5s",onClick:()=>ue(L,-.5,C,g),color:"#ef4444",group:1},{text:"-0.1s",onClick:()=>ue(L,-.1,C,g),color:"#ef4444",group:1},{text:"-0.01s",onClick:()=>ue(L,-.01,C,g),color:"#ef4444",group:1}],fe=()=>{if(!ee(h)||!ee(d))return;const L=Z(h),C=Z(d);if(L<0||C<=L)return;const g=he(P==="video"?"mp4":"gif");g&&p(g)};i.useEffect(()=>{var L;U&&((L=T.current)==null||L.load())},[U]);const ne=()=>{te.current&&clearTimeout(te.current),te.current=setTimeout(fe,500)},ke=()=>{W(!1),T.current&&window.scrollTo({top:0,behavior:"smooth"})},Y=()=>{W(!1),window.scrollTo({top:0,behavior:"smooth"})},le=(L,C,g)=>{if(C(L),ee(L)&&g){const V=Z(L);g(V)}};return i.useEffect(()=>{R(a),y(o),$(m),p(n||"")},[a,o,m,n]),i.useEffect(()=>{f(r)},[r]),i.useEffect(()=>{S(s)},[s]),i.useEffect(()=>{ee(h)&&ee(d)&&fe()},[h,d,P,M,j,k]),i.useEffect(()=>{N(typeof navigator.share=="function")},[]),i.useEffect(()=>(fe(),()=>{te.current&&clearTimeout(te.current)}),[t,r,s]),e.jsxs("div",{className:"container max-w-6xl mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t}),u&&e.jsxs("button",{onClick:u,className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(Tr,{className:"h-4 w-4"}),"Close"]})]}),e.jsx("div",{className:"text-center mb-4",children:e.jsxs("div",{className:"text-lg font-medium text-muted-foreground",children:[h," to ",d]})}),e.jsx(St,{className:"relative overflow-hidden bg-black",children:e.jsxs(Et,{className:"p-0",children:[E&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center min-h-[300px] bg-black/95 backdrop-blur-sm z-10",children:[e.jsx("div",{className:"w-12 h-12 border-3 border-muted border-t-primary rounded-full animate-spin mb-6"}),e.jsx("div",{className:"text-lg font-semibold text-primary-foreground mb-2",children:"Processing..."}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Generating your clip, please wait"})]}),U&&e.jsx(e.Fragment,{children:P==="video"?e.jsxs("video",{ref:T,controls:!0,autoPlay:!0,playsInline:!0,className:"w-full h-auto block",onLoadedData:ke,onError:Y,children:[e.jsx("source",{src:U,type:"video/mp4"}),"Your browser does not support the video tag."]}):e.jsx("img",{src:U,alt:"Clip preview",className:"w-full h-auto block",onLoad:ke,onError:Y})})]})}),e.jsx(St,{children:e.jsxs(Et,{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-start",children:e.jsxs(pe,{onClick:fe,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(Br,{className:"h-4 w-4"}),"Regenerate"]})}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"start_time",className:"text-sm font-medium",children:"Start Time (hh:mm:ss.sss)"}),e.jsx(Nt,{id:"start_time",type:"text",value:h,onChange:L=>le(L.target.value,f,x),pattern:"^(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d{3})$",placeholder:"00:00:00.000",className:"font-mono text-xs tracking-wider",required:!0}),w&&e.jsx(fn,{buttons:se(h,f,x)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"end_time",className:"text-sm font-medium",children:"End Time (hh:mm:ss.sss)"}),e.jsx(Nt,{id:"end_time",type:"text",value:d,onChange:L=>le(L.target.value,S,c),pattern:"^(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d{3})$",placeholder:"00:00:00.000",className:"font-mono text-xs tracking-wider",required:!0}),w&&e.jsx(fn,{buttons:se(d,S,c)})]})]})}),!w&&e.jsx("div",{className:"flex justify-center",children:e.jsxs(pe,{onClick:()=>I(!0),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(Ir,{className:"h-4 w-4"}),"Show Time Controls"]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Preview"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"preview",value:"video",checked:P==="video",onChange:L=>X(L.target.value),className:"text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm",children:"Video"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"preview",value:"gif",checked:P==="gif",onChange:L=>X(L.target.value),className:"text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm",children:"GIF"})]})]})]}),e.jsxs("div",{className:"space-y-2 text-left",children:[e.jsx("label",{htmlFor:"font_size",className:"text-sm font-medium",children:"Font Size"}),e.jsx(Nt,{id:"font_size",type:"number",value:j,onChange:L=>{R(L.target.value),ne()},min:"10",max:"500",placeholder:"Auto",className:"w-20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"text",className:"text-sm font-medium",children:"Text Overlay"}),e.jsx(Dn,{id:"text",value:M,onChange:L=>{y(L.target.value),ne()},placeholder:"Enter text to overlay on video",className:"min-h-[100px] resize-y"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ls,{id:"display_text",checked:k,onCheckedChange:L=>{$(L),fe()}}),e.jsx("label",{htmlFor:"display_text",className:"text-sm font-medium cursor-pointer",children:"Show Text Overlay"})]}),e.jsxs("div",{className:"pt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-1 justify-center flex-wrap",children:[e.jsx(pe,{asChild:!0,variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#22c55e",color:"#22c55e"},children:e.jsxs("a",{href:he("mp4"),download:ae("mp4"),className:"inline-flex items-center gap-2",children:[e.jsx(Tt,{className:"w-3 h-3"}),"Download MP4"]})}),e.jsx(pe,{asChild:!0,variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#22c55e",color:"#22c55e"},children:e.jsxs("a",{href:he("gif"),download:ae("gif"),className:"inline-flex items-center gap-2",children:[e.jsx(Tt,{className:"w-3 h-3"}),"Download GIF"]})}),e.jsx(pe,{asChild:!0,variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#22c55e",color:"#22c55e"},children:e.jsxs("a",{href:he("mp3"),download:ae("mp3"),className:"inline-flex items-center gap-2",children:[e.jsx(Tt,{className:"w-3 h-3"}),"Download MP3"]})})]}),A&&e.jsxs("div",{className:"flex items-center gap-1 justify-center flex-wrap",children:[e.jsxs(pe,{onClick:()=>ve("mp4"),variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#3b82f6",color:"#3b82f6"},disabled:v.mp4,children:[v.mp4?e.jsx("div",{className:"w-3 h-3 mr-1 border border-current border-t-transparent rounded-full animate-spin"}):e.jsx($t,{className:"w-3 h-3 mr-1"}),v.mp4?"Sharing...":"Share MP4"]}),e.jsxs(pe,{onClick:()=>ve("gif"),variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#3b82f6",color:"#3b82f6"},disabled:v.gif,children:[v.gif?e.jsx("div",{className:"w-3 h-3 mr-1 border border-current border-t-transparent rounded-full animate-spin"}):e.jsx($t,{className:"w-3 h-3 mr-1"}),v.gif?"Sharing...":"Share GIF"]}),e.jsxs(pe,{onClick:()=>ve("mp3"),variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#3b82f6",color:"#3b82f6"},disabled:v.mp3,children:[v.mp3?e.jsx("div",{className:"w-3 h-3 mr-1 border border-current border-t-transparent rounded-full animate-spin"}):e.jsx($t,{className:"w-3 h-3 mr-1"}),v.mp3?"Sharing...":"Share MP3"]})]})]})]})})]})};function rt(t,n,{checkForDefaultPrevented:r=!0}={}){return function(a){if(t==null||t(a),r===!1||!a.defaultPrevented)return n==null?void 0:n(a)}}var cs="DismissableLayer",qt="dismissableLayer.update",ds="dismissableLayer.pointerDownOutside",us="dismissableLayer.focusOutside",mn,Fn=i.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Bn=i.forwardRef((t,n)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:m,onDismiss:u,...x}=t,c=i.useContext(Fn),[h,f]=i.useState(null),d=(h==null?void 0:h.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,S]=i.useState({}),j=st(n,p=>f(p)),R=Array.from(c.layers),[M]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=R.indexOf(M),k=h?R.indexOf(h):-1,$=c.layersWithOutsidePointerEventsDisabled.size>0,E=k>=y,W=hs(p=>{const w=p.target,I=[...c.branches].some(A=>A.contains(w));!E||I||(a==null||a(p),m==null||m(p),p.defaultPrevented||u==null||u())},d),U=ps(p=>{const w=p.target;[...c.branches].some(A=>A.contains(w))||(o==null||o(p),m==null||m(p),p.defaultPrevented||u==null||u())},d);return Cr(p=>{k===c.layers.size-1&&(s==null||s(p),!p.defaultPrevented&&u&&(p.preventDefault(),u()))},d),i.useEffect(()=>{if(h)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(mn=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(h)),c.layers.add(h),hn(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(d.body.style.pointerEvents=mn)}},[h,d,r,c]),i.useEffect(()=>()=>{h&&(c.layers.delete(h),c.layersWithOutsidePointerEventsDisabled.delete(h),hn())},[h,c]),i.useEffect(()=>{const p=()=>S({});return document.addEventListener(qt,p),()=>document.removeEventListener(qt,p)},[]),e.jsx(Ke.div,{...x,ref:j,style:{pointerEvents:$?E?"auto":"none":void 0,...t.style},onFocusCapture:rt(t.onFocusCapture,U.onFocusCapture),onBlurCapture:rt(t.onBlurCapture,U.onBlurCapture),onPointerDownCapture:rt(t.onPointerDownCapture,W.onPointerDownCapture)})});Bn.displayName=cs;var fs="DismissableLayerBranch",ms=i.forwardRef((t,n)=>{const r=i.useContext(Fn),s=i.useRef(null),a=st(n,s);return i.useEffect(()=>{const o=s.current;if(o)return r.branches.add(o),()=>{r.branches.delete(o)}},[r.branches]),e.jsx(Ke.div,{...t,ref:a})});ms.displayName=fs;function hs(t,n=globalThis==null?void 0:globalThis.document){const r=Cn(t),s=i.useRef(!1),a=i.useRef(()=>{});return i.useEffect(()=>{const o=u=>{if(u.target&&!s.current){let x=function(){Wn(ds,r,c,{discrete:!0})};const c={originalEvent:u};u.pointerType==="touch"?(n.removeEventListener("click",a.current),a.current=x,n.addEventListener("click",a.current,{once:!0})):x()}else n.removeEventListener("click",a.current);s.current=!1},m=window.setTimeout(()=>{n.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(m),n.removeEventListener("pointerdown",o),n.removeEventListener("click",a.current)}},[n,r]),{onPointerDownCapture:()=>s.current=!0}}function ps(t,n=globalThis==null?void 0:globalThis.document){const r=Cn(t),s=i.useRef(!1);return i.useEffect(()=>{const a=o=>{o.target&&!s.current&&Wn(us,r,{originalEvent:o},{discrete:!1})};return n.addEventListener("focusin",a),()=>n.removeEventListener("focusin",a)},[n,r]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function hn(){const t=new CustomEvent(qt);document.dispatchEvent(t)}function Wn(t,n,r,{discrete:s}){const a=r.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});n&&a.addEventListener(t,n,{once:!0}),s?Sr(a,o):a.dispatchEvent(o)}function xs(t,n){return i.useReducer((r,s)=>n[r][s]??r,t)}var Dt=t=>{const{present:n,children:r}=t,s=gs(n),a=typeof r=="function"?r({present:s.isPresent}):i.Children.only(r),o=st(s.ref,vs(a));return typeof r=="function"||s.isPresent?i.cloneElement(a,{ref:o}):null};Dt.displayName="Presence";function gs(t){const[n,r]=i.useState(),s=i.useRef(null),a=i.useRef(t),o=i.useRef("none"),m=t?"mounted":"unmounted",[u,x]=xs(m,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return i.useEffect(()=>{const c=jt(s.current);o.current=u==="mounted"?c:"none"},[u]),sn(()=>{const c=s.current,h=a.current;if(h!==t){const d=o.current,S=jt(c);t?x("MOUNT"):S==="none"||(c==null?void 0:c.display)==="none"?x("UNMOUNT"):x(h&&d!==S?"ANIMATION_OUT":"UNMOUNT"),a.current=t}},[t,x]),sn(()=>{if(n){let c;const h=n.ownerDocument.defaultView??window,f=S=>{const R=jt(s.current).includes(CSS.escape(S.animationName));if(S.target===n&&R&&(x("ANIMATION_END"),!a.current)){const M=n.style.animationFillMode;n.style.animationFillMode="forwards",c=h.setTimeout(()=>{n.style.animationFillMode==="forwards"&&(n.style.animationFillMode=M)})}},d=S=>{S.target===n&&(o.current=jt(s.current))};return n.addEventListener("animationstart",d),n.addEventListener("animationcancel",f),n.addEventListener("animationend",f),()=>{h.clearTimeout(c),n.removeEventListener("animationstart",d),n.removeEventListener("animationcancel",f),n.removeEventListener("animationend",f)}}else x("ANIMATION_END")},[n,x]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:i.useCallback(c=>{s.current=c?getComputedStyle(c):null,r(c)},[])}}function jt(t){return(t==null?void 0:t.animationName)||"none"}function vs(t){var s,a;let n=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,r=n&&"isReactWarning"in n&&n.isReactWarning;return r?t.ref:(n=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,r=n&&"isReactWarning"in n&&n.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var It=0;function bs(){i.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??pn()),document.body.insertAdjacentElement("beforeend",t[1]??pn()),It++,()=>{It===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),It--}},[])}function pn(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Mt="Dialog",[Hn,wo]=kn(Mt),[ws,He]=Hn(Mt),zn=t=>{const{__scopeDialog:n,children:r,open:s,defaultOpen:a,onOpenChange:o,modal:m=!0}=t,u=i.useRef(null),x=i.useRef(null),[c,h]=Nn({prop:s,defaultProp:a??!1,onChange:o,caller:Mt});return e.jsx(ws,{scope:n,triggerRef:u,contentRef:x,contentId:Ot(),titleId:Ot(),descriptionId:Ot(),open:c,onOpenChange:h,onOpenToggle:i.useCallback(()=>h(f=>!f),[h]),modal:m,children:r})};zn.displayName=Mt;var Un="DialogTrigger",js=i.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,a=He(Un,r),o=st(n,a.triggerRef);return e.jsx(Ke.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Jt(a.open),...s,ref:o,onClick:rt(t.onClick,a.onOpenToggle)})});js.displayName=Un;var Qt="DialogPortal",[ys,Vn]=Hn(Qt,{forceMount:void 0}),qn=t=>{const{__scopeDialog:n,forceMount:r,children:s,container:a}=t,o=He(Qt,n);return e.jsx(ys,{scope:n,forceMount:r,children:i.Children.map(s,m=>e.jsx(Dt,{present:r||o.open,children:e.jsx(Er,{asChild:!0,container:a,children:m})}))})};qn.displayName=Qt;var Rt="DialogOverlay",Gn=i.forwardRef((t,n)=>{const r=Vn(Rt,t.__scopeDialog),{forceMount:s=r.forceMount,...a}=t,o=He(Rt,t.__scopeDialog);return o.modal?e.jsx(Dt,{present:s||o.open,children:e.jsx(Ns,{...a,ref:n})}):null});Gn.displayName=Rt;var ks=Dr("DialogOverlay.RemoveScroll"),Ns=i.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,a=He(Rt,r);return e.jsx(_r,{as:ks,allowPinchZoom:!0,shards:[a.contentRef],children:e.jsx(Ke.div,{"data-state":Jt(a.open),...s,ref:n,style:{pointerEvents:"auto",...s.style}})})}),lt="DialogContent",Xn=i.forwardRef((t,n)=>{const r=Vn(lt,t.__scopeDialog),{forceMount:s=r.forceMount,...a}=t,o=He(lt,t.__scopeDialog);return e.jsx(Dt,{present:s||o.open,children:o.modal?e.jsx(Cs,{...a,ref:n}):e.jsx(Ss,{...a,ref:n})})});Xn.displayName=lt;var Cs=i.forwardRef((t,n)=>{const r=He(lt,t.__scopeDialog),s=i.useRef(null),a=st(n,r.contentRef,s);return i.useEffect(()=>{const o=s.current;if(o)return Rr(o)},[]),e.jsx(Yn,{...t,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:rt(t.onCloseAutoFocus,o=>{var m;o.preventDefault(),(m=r.triggerRef.current)==null||m.focus()}),onPointerDownOutside:rt(t.onPointerDownOutside,o=>{const m=o.detail.originalEvent,u=m.button===0&&m.ctrlKey===!0;(m.button===2||u)&&o.preventDefault()}),onFocusOutside:rt(t.onFocusOutside,o=>o.preventDefault())})}),Ss=i.forwardRef((t,n)=>{const r=He(lt,t.__scopeDialog),s=i.useRef(!1),a=i.useRef(!1);return e.jsx(Yn,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var m,u;(m=t.onCloseAutoFocus)==null||m.call(t,o),o.defaultPrevented||(s.current||(u=r.triggerRef.current)==null||u.focus(),o.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:o=>{var x,c;(x=t.onInteractOutside)==null||x.call(t,o),o.defaultPrevented||(s.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const m=o.target;((c=r.triggerRef.current)==null?void 0:c.contains(m))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),Yn=i.forwardRef((t,n)=>{const{__scopeDialog:r,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:o,...m}=t,u=He(lt,r),x=i.useRef(null),c=st(n,x);return bs(),e.jsxs(e.Fragment,{children:[e.jsx(Mr,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:o,children:e.jsx(Bn,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":Jt(u.open),...m,ref:c,onDismiss:()=>u.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(_s,{titleId:u.titleId}),e.jsx(Ms,{contentRef:x,descriptionId:u.descriptionId})]})]})}),Kt="DialogTitle",Qn=i.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,a=He(Kt,r);return e.jsx(Ke.h2,{id:a.titleId,...s,ref:n})});Qn.displayName=Kt;var Kn="DialogDescription",Es=i.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,a=He(Kn,r);return e.jsx(Ke.p,{id:a.descriptionId,...s,ref:n})});Es.displayName=Kn;var Jn="DialogClose",Rs=i.forwardRef((t,n)=>{const{__scopeDialog:r,...s}=t,a=He(Jn,r);return e.jsx(Ke.button,{type:"button",...s,ref:n,onClick:rt(t.onClick,()=>a.onOpenChange(!1))})});Rs.displayName=Jn;function Jt(t){return t?"open":"closed"}var Zn="DialogTitleWarning",[jo,er]=Lr(Zn,{contentName:lt,titleName:Kt,docsSlug:"dialog"}),_s=({titleId:t})=>{const n=er(Zn),r=`\`${n.contentName}\` requires a \`${n.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${n.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${n.docsSlug}`;return i.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},Ds="DialogDescriptionWarning",Ms=({contentRef:t,descriptionId:n})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${er(Ds).contentName}}.`;return i.useEffect(()=>{var o;const a=(o=t.current)==null?void 0:o.getAttribute("aria-describedby");n&&a&&(document.getElementById(n)||console.warn(s))},[s,t,n]),null},Ls=zn,Ts=qn,Os=Gn,Ps=Xn,$s=Qn;function Is(t){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}const tr=b.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldAnimate:{current:!0},shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),vt=()=>{const t=b.useContext(tr);if(!t)throw new Error("useDrawerContext must be used within a Drawer.Root");return t};Is(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--initial-transform,100%),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--initial-transform,100%),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-animate=false]{animation:none!important}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,var(--initial-transform,100%),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,var(--initial-transform,100%),0)}}@keyframes slideFromTop{from{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}}@keyframes slideFromLeft{from{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}}@keyframes slideFromRight{from{transform:translate3d(var(--initial-transform,100%),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(var(--initial-transform,100%),0,0)}}`);function As(){const t=navigator.userAgent;return typeof window<"u"&&(/Firefox/.test(t)&&/Mobile/.test(t)||/FxiOS/.test(t))}function Fs(){return Zt(/^Mac/)}function Bs(){return Zt(/^iPhone/)}function xn(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function Ws(){return Zt(/^iPad/)||Fs()&&navigator.maxTouchPoints>1}function nr(){return Bs()||Ws()}function Zt(t){return typeof window<"u"&&window.navigator!=null?t.test(window.navigator.platform):void 0}const Hs=24,zs=typeof window<"u"?i.useLayoutEffect:i.useEffect;function gn(...t){return(...n)=>{for(let r of t)typeof r=="function"&&r(...n)}}const At=typeof document<"u"&&window.visualViewport;function vn(t){let n=window.getComputedStyle(t);return/(auto|scroll)/.test(n.overflow+n.overflowX+n.overflowY)}function rr(t){for(vn(t)&&(t=t.parentElement);t&&!vn(t);)t=t.parentElement;return t||document.scrollingElement||document.documentElement}const Us=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let yt=0,Ft;function Vs(t={}){let{isDisabled:n}=t;zs(()=>{if(!n)return yt++,yt===1&&nr()&&(Ft=qs()),()=>{yt--,yt===0&&(Ft==null||Ft())}},[n])}function qs(){let t,n=0,r=f=>{t=rr(f.target),!(t===document.documentElement&&t===document.body)&&(n=f.changedTouches[0].pageY)},s=f=>{if(!t||t===document.documentElement||t===document.body){f.preventDefault();return}let d=f.changedTouches[0].pageY,S=t.scrollTop,j=t.scrollHeight-t.clientHeight;j!==0&&((S<=0&&d>n||S>=j&&d<n)&&f.preventDefault(),n=d)},a=f=>{let d=f.target;Gt(d)&&d!==document.activeElement&&(f.preventDefault(),d.style.transform="translateY(-2000px)",d.focus(),requestAnimationFrame(()=>{d.style.transform=""}))},o=f=>{let d=f.target;Gt(d)&&(d.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{d.style.transform="",At&&(At.height<window.innerHeight?requestAnimationFrame(()=>{bn(d)}):At.addEventListener("resize",()=>bn(d),{once:!0}))}))},m=()=>{window.scrollTo(0,0)},u=window.pageXOffset,x=window.pageYOffset,c=gn(Gs(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let h=gn(xt(document,"touchstart",r,{passive:!1,capture:!0}),xt(document,"touchmove",s,{passive:!1,capture:!0}),xt(document,"touchend",a,{passive:!1,capture:!0}),xt(document,"focus",o,!0),xt(window,"scroll",m));return()=>{c(),h(),window.scrollTo(u,x)}}function Gs(t,n,r){let s=t.style[n];return t.style[n]=r,()=>{t.style[n]=s}}function xt(t,n,r,s){return t.addEventListener(n,r,s),()=>{t.removeEventListener(n,r,s)}}function bn(t){let n=document.scrollingElement||document.documentElement;for(;t&&t!==n;){let r=rr(t);if(r!==document.documentElement&&r!==document.body&&r!==t){let s=r.getBoundingClientRect().top,a=t.getBoundingClientRect().top,o=t.getBoundingClientRect().bottom;const m=r.getBoundingClientRect().bottom+Hs;o>m&&(r.scrollTop+=a-s)}t=r.parentElement}}function Gt(t){return t instanceof HTMLInputElement&&!Us.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}function Xs(t,n){typeof t=="function"?t(n):t!=null&&(t.current=n)}function Ys(...t){return n=>t.forEach(r=>Xs(r,n))}function sr(...t){return i.useCallback(Ys(...t),t)}const or=new WeakMap;function be(t,n,r=!1){if(!t||!(t instanceof HTMLElement))return;let s={};Object.entries(n).forEach(([a,o])=>{if(a.startsWith("--")){t.style.setProperty(a,o);return}s[a]=t.style[a],t.style[a]=o}),!r&&or.set(t,s)}function Qs(t,n){if(!t||!(t instanceof HTMLElement))return;let r=or.get(t);r&&(t.style[n]=r[n])}const xe=t=>{switch(t){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return t}};function kt(t,n){if(!t)return null;const r=window.getComputedStyle(t),s=r.transform||r.webkitTransform||r.mozTransform;let a=s.match(/^matrix3d\((.+)\)$/);return a?parseFloat(a[1].split(", ")[xe(n)?13:12]):(a=s.match(/^matrix\((.+)\)$/),a?parseFloat(a[1].split(", ")[xe(n)?5:4]):null)}function Ks(t){return 8*(Math.log(t+1)-2)}function Bt(t,n){if(!t)return()=>{};const r=t.style.cssText;return Object.assign(t.style,n),()=>{t.style.cssText=r}}function Js(...t){return(...n)=>{for(const r of t)typeof r=="function"&&r(...n)}}const me={DURATION:.5,EASE:[.32,.72,0,1]},ar=.4,Zs=.25,eo=100,ir=8,it=16,Xt=26,Wt="vaul-dragging";function lr(t){const n=b.useRef(t);return b.useEffect(()=>{n.current=t}),b.useMemo(()=>(...r)=>n.current==null?void 0:n.current.call(n,...r),[])}function to({defaultProp:t,onChange:n}){const r=b.useState(t),[s]=r,a=b.useRef(s),o=lr(n);return b.useEffect(()=>{a.current!==s&&(o(s),a.current=s)},[s,a,o]),r}function cr({prop:t,defaultProp:n,onChange:r=()=>{}}){const[s,a]=to({defaultProp:n,onChange:r}),o=t!==void 0,m=o?t:s,u=lr(r),x=b.useCallback(c=>{if(o){const f=typeof c=="function"?c(t):c;f!==t&&u(f)}else a(c)},[o,t,a,u]);return[m,x]}function no({activeSnapPointProp:t,setActiveSnapPointProp:n,snapPoints:r,drawerRef:s,overlayRef:a,fadeFromIndex:o,onSnapPointChange:m,direction:u="bottom",container:x,snapToSequentialPoint:c}){const[h,f]=cr({prop:t,defaultProp:r==null?void 0:r[0],onChange:n}),[d,S]=b.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);b.useEffect(()=>{function p(){S({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[]);const j=b.useMemo(()=>h===(r==null?void 0:r[r.length-1])||null,[r,h]),R=b.useMemo(()=>{var p;return(p=r==null?void 0:r.findIndex(w=>w===h))!=null?p:null},[r,h]),M=r&&r.length>0&&(o||o===0)&&!Number.isNaN(o)&&r[o]===h||!r,y=b.useMemo(()=>{const p=x?{width:x.getBoundingClientRect().width,height:x.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var w;return(w=r==null?void 0:r.map(I=>{const A=typeof I=="string";let N=0;if(A&&(N=parseInt(I,10)),xe(u)){const v=A?N:d?I*p.height:0;return d?u==="bottom"?p.height-v:-p.height+v:v}const D=A?N:d?I*p.width:0;return d?u==="right"?p.width-D:-p.width+D:D}))!=null?w:[]},[r,d,x]),k=b.useMemo(()=>R!==null?y==null?void 0:y[R]:null,[y,R]),$=b.useCallback(p=>{var w;const I=(w=y==null?void 0:y.findIndex(A=>A===p))!=null?w:null;m(I),be(s.current,{transition:`transform ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`,transform:xe(u)?`translate3d(0, ${p}px, 0)`:`translate3d(${p}px, 0, 0)`}),y&&I!==y.length-1&&o!==void 0&&I!==o&&I<o?be(a.current,{transition:`opacity ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`,opacity:"0"}):be(a.current,{transition:`opacity ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`,opacity:"1"}),f(r==null?void 0:r[Math.max(I,0)])},[s.current,r,y,o,a,f]);b.useEffect(()=>{if(h||t){var p;const w=(p=r==null?void 0:r.findIndex(I=>I===t||I===h))!=null?p:-1;y&&w!==-1&&typeof y[w]=="number"&&$(y[w])}},[h,t,r,y,$]);function E({draggedDistance:p,closeDrawer:w,velocity:I,dismissible:A}){if(o===void 0)return;const N=u==="bottom"||u==="right"?(k??0)-p:(k??0)+p,D=R===o-1,v=R===0,q=p>0;if(D&&be(a.current,{transition:`opacity ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`}),!c&&I>2&&!q){A?w():$(y[0]);return}if(!c&&I>2&&q&&y&&r){$(y[r.length-1]);return}const P=y==null?void 0:y.reduce((T,te)=>typeof T!="number"||typeof te!="number"?T:Math.abs(te-N)<Math.abs(T-N)?te:T),X=xe(u)?window.innerHeight:window.innerWidth;if(I>ar&&Math.abs(p)<X*.4){const T=q?1:-1;if(T>0&&j&&r){$(y[r.length-1]);return}if(v&&T<0&&A&&w(),R===null)return;$(y[R+T]);return}$(P)}function W({draggedDistance:p}){if(k===null)return;const w=u==="bottom"||u==="right"?k-p:k+p;(u==="bottom"||u==="right")&&w<y[y.length-1]||(u==="top"||u==="left")&&w>y[y.length-1]||be(s.current,{transform:xe(u)?`translate3d(0, ${w}px, 0)`:`translate3d(${w}px, 0, 0)`})}function U(p,w){if(!r||typeof R!="number"||!y||o===void 0)return null;const I=R===o-1;if(R>=o&&w)return 0;if(I&&!w)return 1;if(!M&&!I)return null;const N=I?R+1:R-1,D=I?y[N]-y[N-1]:y[N+1]-y[N],v=p/Math.abs(D);return I?1-v:v}return{isLastSnapPoint:j,activeSnapPoint:h,shouldFade:M,getPercentageDragged:U,setActiveSnapPoint:f,activeSnapPointIndex:R,onRelease:E,onDrag:W,snapPointsOffset:y}}const ro=()=>()=>{};function so(){const{direction:t,isOpen:n,shouldScaleBackground:r,setBackgroundColorOnScale:s,noBodyStyles:a}=vt(),o=b.useRef(null),m=i.useMemo(()=>document.body.style.backgroundColor,[]);function u(){return(window.innerWidth-Xt)/window.innerWidth}b.useEffect(()=>{if(n&&r){o.current&&clearTimeout(o.current);const x=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!x)return;Js(s&&!a?Bt(document.body,{background:"black"}):ro,Bt(x,{transformOrigin:xe(t)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${me.DURATION}s`,transitionTimingFunction:`cubic-bezier(${me.EASE.join(",")})`}));const c=Bt(x,{borderRadius:`${ir}px`,overflow:"hidden",...xe(t)?{transform:`scale(${u()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${u()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{c(),o.current=window.setTimeout(()=>{m?document.body.style.background=m:document.body.style.removeProperty("background")},me.DURATION*1e3)}}},[n,r,m])}let gt=null;function oo({isOpen:t,modal:n,nested:r,hasBeenOpened:s,preventScrollRestoration:a,noBodyStyles:o}){const[m,u]=b.useState(()=>typeof window<"u"?window.location.href:""),x=b.useRef(0),c=b.useCallback(()=>{if(xn()&&gt===null&&t&&!o){gt={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:f,innerHeight:d}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-x.current}px`,left:`${-f}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const S=d-window.innerHeight;S&&x.current>=d&&(document.body.style.top=`${-(x.current+S)}px`)}),300)}},[t]),h=b.useCallback(()=>{if(xn()&&gt!==null&&!o){const f=-parseInt(document.body.style.top,10),d=-parseInt(document.body.style.left,10);Object.assign(document.body.style,gt),window.requestAnimationFrame(()=>{if(a&&m!==window.location.href){u(window.location.href);return}window.scrollTo(d,f)}),gt=null}},[m]);return b.useEffect(()=>{function f(){x.current=window.scrollY}return f(),window.addEventListener("scroll",f),()=>{window.removeEventListener("scroll",f)}},[]),b.useEffect(()=>{if(n)return()=>{typeof document>"u"||document.querySelector("[data-vaul-drawer]")||h()}},[n,h]),b.useEffect(()=>{r||!s||(t?(!window.matchMedia("(display-mode: standalone)").matches&&c(),n||window.setTimeout(()=>{h()},500)):h())},[t,s,m,n,r,c,h]),{restorePositionSetting:h}}function ao({open:t,onOpenChange:n,children:r,onDrag:s,onRelease:a,snapPoints:o,shouldScaleBackground:m=!1,setBackgroundColorOnScale:u=!0,closeThreshold:x=Zs,scrollLockTimeout:c=eo,dismissible:h=!0,handleOnly:f=!1,fadeFromIndex:d=o&&o.length-1,activeSnapPoint:S,setActiveSnapPoint:j,fixed:R,modal:M=!0,onClose:y,nested:k,noBodyStyles:$=!1,direction:E="bottom",defaultOpen:W=!1,disablePreventScroll:U=!0,snapToSequentialPoint:p=!1,preventScrollRestoration:w=!1,repositionInputs:I=!0,onAnimationEnd:A,container:N,autoFocus:D=!1}){var v,q;const[P=!1,X]=cr({defaultProp:W,prop:t,onChange:F=>{n==null||n(F),!F&&!k&&ft(),setTimeout(()=>{A==null||A(F)},me.DURATION*1e3),F&&!M&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),F||(document.body.style.pointerEvents="auto")}}),[T,te]=b.useState(!1),[Z,we]=b.useState(!1),[ee,he]=b.useState(!1),ae=b.useRef(null),ve=b.useRef(null),ue=b.useRef(null),se=b.useRef(null),fe=b.useRef(null),ne=b.useRef(!1),ke=b.useRef(null),Y=b.useRef(0),le=b.useRef(!1),L=b.useRef(!W),C=b.useRef(0),g=b.useRef(null),V=b.useRef(((v=g.current)==null?void 0:v.getBoundingClientRect().height)||0),ce=b.useRef(((q=g.current)==null?void 0:q.getBoundingClientRect().width)||0),ie=b.useRef(0),Se=b.useCallback(F=>{o&&F===je.length-1&&(ve.current=new Date)},[]),{activeSnapPoint:Te,activeSnapPointIndex:Oe,setActiveSnapPoint:ot,onRelease:Pe,snapPointsOffset:je,onDrag:ze,shouldFade:$e,getPercentageDragged:_e}=no({snapPoints:o,activeSnapPointProp:S,setActiveSnapPointProp:j,drawerRef:g,fadeFromIndex:d,overlayRef:ae,onSnapPointChange:Se,direction:E,container:N,snapToSequentialPoint:p});Vs({isDisabled:!P||Z||!M||ee||!T||!I||!U});const{restorePositionSetting:ft}=oo({isOpen:P,modal:M,nested:k??!1,hasBeenOpened:T,preventScrollRestoration:w,noBodyStyles:$});function Je(){return(window.innerWidth-Xt)/window.innerWidth}function mt(F){var K,Q;!h&&!o||g.current&&!g.current.contains(F.target)||(V.current=((K=g.current)==null?void 0:K.getBoundingClientRect().height)||0,ce.current=((Q=g.current)==null?void 0:Q.getBoundingClientRect().width)||0,we(!0),ue.current=new Date,nr()&&window.addEventListener("touchend",()=>ne.current=!1,{once:!0}),F.target.setPointerCapture(F.pointerId),Y.current=xe(E)?F.pageY:F.pageX)}function De(F,K){var Q;let G=F;const de=(Q=window.getSelection())==null?void 0:Q.toString(),ye=g.current?kt(g.current,E):null,Ce=new Date;if(G.tagName==="SELECT"||G.hasAttribute("data-vaul-no-drag")||G.closest("[data-vaul-no-drag]"))return!1;if(E==="right"||E==="left")return!0;if(ve.current&&Ce.getTime()-ve.current.getTime()<500)return!1;if(ye!==null&&(E==="bottom"?ye>0:ye<0))return!0;if(de&&de.length>0)return!1;if(fe.current&&Ce.getTime()-fe.current.getTime()<c&&ye===0||K)return fe.current=Ce,!1;for(;G;){if(G.scrollHeight>G.clientHeight){if(G.scrollTop!==0)return fe.current=new Date,!1;if(G.getAttribute("role")==="dialog")return!0}G=G.parentNode}return!0}function Ue(F){if(g.current&&Z){const K=E==="bottom"||E==="right"?1:-1,Q=(Y.current-(xe(E)?F.pageY:F.pageX))*K,G=Q>0,de=o&&!h&&!G;if(de&&Oe===0)return;const ye=Math.abs(Q),Ce=document.querySelector("[data-vaul-drawer-wrapper]"),Ie=E==="bottom"||E==="top"?V.current:ce.current;let Ee=ye/Ie;const Xe=_e(ye,G);if(Xe!==null&&(Ee=Xe),de&&Ee>=1||!ne.current&&!De(F.target,G))return;if(g.current.classList.add(Wt),ne.current=!0,be(g.current,{transition:"none"}),be(ae.current,{transition:"none"}),o&&ze({draggedDistance:Q}),G&&!o){const Le=Ks(Q),dt=Math.min(Le*-1,0)*K;be(g.current,{transform:xe(E)?`translate3d(0, ${dt}px, 0)`:`translate3d(${dt}px, 0, 0)`});return}const Ye=1-Ee;if(($e||d&&Oe===d-1)&&(s==null||s(F,Ee),be(ae.current,{opacity:`${Ye}`,transition:"none"},!0)),Ce&&ae.current&&m){const Le=Math.min(Je()+Ee*(1-Je()),1),dt=8-Ee*8,wt=Math.max(0,14-Ee*14);be(Ce,{borderRadius:`${dt}px`,transform:xe(E)?`scale(${Le}) translate3d(0, ${wt}px, 0)`:`scale(${Le}) translate3d(${wt}px, 0, 0)`,transition:"none"},!0)}if(!o){const Le=ye*K;be(g.current,{transform:xe(E)?`translate3d(0, ${Le}px, 0)`:`translate3d(${Le}px, 0, 0)`})}}}b.useEffect(()=>{window.requestAnimationFrame(()=>{L.current=!0})},[]),b.useEffect(()=>{var F;function K(){if(!g.current||!I)return;const Q=document.activeElement;if(Gt(Q)||le.current){var G;const de=((G=window.visualViewport)==null?void 0:G.height)||0,ye=window.innerHeight;let Ce=ye-de;const Ie=g.current.getBoundingClientRect().height||0,Ee=Ie>ye*.8;ie.current||(ie.current=Ie);const Xe=g.current.getBoundingClientRect().top;if(Math.abs(C.current-Ce)>60&&(le.current=!le.current),o&&o.length>0&&je&&Oe){const Ye=je[Oe]||0;Ce+=Ye}if(C.current=Ce,Ie>de||le.current){const Ye=g.current.getBoundingClientRect().height;let Le=Ye;Ye>de&&(Le=de-(Ee?Xe:Xt)),R?g.current.style.height=`${Ye-Math.max(Ce,0)}px`:g.current.style.height=`${Math.max(Le,de-Xe)}px`}else As()||(g.current.style.height=`${ie.current}px`);o&&o.length>0&&!le.current?g.current.style.bottom="0px":g.current.style.bottom=`${Math.max(Ce,0)}px`}}return(F=window.visualViewport)==null||F.addEventListener("resize",K),()=>{var Q;return(Q=window.visualViewport)==null?void 0:Q.removeEventListener("resize",K)}},[Oe,o,je]);function Me(F){qe(),y==null||y(),F||X(!1),setTimeout(()=>{o&&ot(o[0])},me.DURATION*1e3)}function Ve(){if(!g.current)return;const F=document.querySelector("[data-vaul-drawer-wrapper]"),K=kt(g.current,E);be(g.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`}),be(ae.current,{transition:`opacity ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`,opacity:"1"}),m&&K&&K>0&&P&&be(F,{borderRadius:`${ir}px`,overflow:"hidden",...xe(E)?{transform:`scale(${Je()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${Je()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${me.DURATION}s`,transitionTimingFunction:`cubic-bezier(${me.EASE.join(",")})`},!0)}function qe(){!Z||!g.current||(g.current.classList.remove(Wt),ne.current=!1,we(!1),se.current=new Date)}function Ge(F){if(!Z||!g.current)return;g.current.classList.remove(Wt),ne.current=!1,we(!1),se.current=new Date;const K=kt(g.current,E);if(!F||!De(F.target,!1)||!K||Number.isNaN(K)||ue.current===null)return;const Q=se.current.getTime()-ue.current.getTime(),G=Y.current-(xe(E)?F.pageY:F.pageX),de=Math.abs(G)/Q;if(de>.05&&(he(!0),setTimeout(()=>{he(!1)},200)),o){Pe({draggedDistance:G*(E==="bottom"||E==="right"?1:-1),closeDrawer:Me,velocity:de,dismissible:h}),a==null||a(F,!0);return}if(E==="bottom"||E==="right"?G>0:G<0){Ve(),a==null||a(F,!0);return}if(de>ar){Me(),a==null||a(F,!1);return}var ye;const Ce=Math.min((ye=g.current.getBoundingClientRect().height)!=null?ye:0,window.innerHeight);var Ie;const Ee=Math.min((Ie=g.current.getBoundingClientRect().width)!=null?Ie:0,window.innerWidth),Xe=E==="left"||E==="right";if(Math.abs(K)>=(Xe?Ee:Ce)*x){Me(),a==null||a(F,!1);return}a==null||a(F,!0),Ve()}b.useEffect(()=>(P&&(be(document.documentElement,{scrollBehavior:"auto"}),ve.current=new Date),()=>{Qs(document.documentElement,"scrollBehavior")}),[P]);function z(F){const K=F?(window.innerWidth-it)/window.innerWidth:1,Q=F?-it:0;ke.current&&window.clearTimeout(ke.current),be(g.current,{transition:`transform ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`,transform:xe(E)?`scale(${K}) translate3d(0, ${Q}px, 0)`:`scale(${K}) translate3d(${Q}px, 0, 0)`}),!F&&g.current&&(ke.current=setTimeout(()=>{const G=kt(g.current,E);be(g.current,{transition:"none",transform:xe(E)?`translate3d(0, ${G}px, 0)`:`translate3d(${G}px, 0, 0)`})},500))}function re(F,K){if(K<0)return;const Q=(window.innerWidth-it)/window.innerWidth,G=Q+K*(1-Q),de=-it+K*it;be(g.current,{transform:xe(E)?`scale(${G}) translate3d(0, ${de}px, 0)`:`scale(${G}) translate3d(${de}px, 0, 0)`,transition:"none"})}function Ne(F,K){const Q=xe(E)?window.innerHeight:window.innerWidth,G=K?(Q-it)/Q:1,de=K?-it:0;K&&be(g.current,{transition:`transform ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`,transform:xe(E)?`scale(${G}) translate3d(0, ${de}px, 0)`:`scale(${G}) translate3d(${de}px, 0, 0)`})}return b.useEffect(()=>{M||window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"})},[M]),b.createElement(Ls,{defaultOpen:W,onOpenChange:F=>{!h&&!F||(F?te(!0):Me(!0),X(F))},open:P},b.createElement(tr.Provider,{value:{activeSnapPoint:Te,snapPoints:o,setActiveSnapPoint:ot,drawerRef:g,overlayRef:ae,onOpenChange:n,onPress:mt,onRelease:Ge,onDrag:Ue,dismissible:h,shouldAnimate:L,handleOnly:f,isOpen:P,isDragging:Z,shouldFade:$e,closeDrawer:Me,onNestedDrag:re,onNestedOpenChange:z,onNestedRelease:Ne,keyboardIsOpen:le,modal:M,snapPointsOffset:je,activeSnapPointIndex:Oe,direction:E,shouldScaleBackground:m,setBackgroundColorOnScale:u,noBodyStyles:$,container:N,autoFocus:D}},r))}const dr=b.forwardRef(function({...t},n){const{overlayRef:r,snapPoints:s,onRelease:a,shouldFade:o,isOpen:m,modal:u,shouldAnimate:x}=vt(),c=sr(n,r),h=s&&s.length>0;if(!u)return null;const f=b.useCallback(d=>a(d),[a]);return b.createElement(Os,{onMouseUp:f,ref:c,"data-vaul-overlay":"","data-vaul-snap-points":m&&h?"true":"false","data-vaul-snap-points-overlay":m&&o?"true":"false","data-vaul-animate":x!=null&&x.current?"true":"false",...t})});dr.displayName="Drawer.Overlay";const ur=b.forwardRef(function({onPointerDownOutside:t,style:n,onOpenAutoFocus:r,...s},a){const{drawerRef:o,onPress:m,onRelease:u,onDrag:x,keyboardIsOpen:c,snapPointsOffset:h,activeSnapPointIndex:f,modal:d,isOpen:S,direction:j,snapPoints:R,container:M,handleOnly:y,shouldAnimate:k,autoFocus:$}=vt(),[E,W]=b.useState(!1),U=sr(a,o),p=b.useRef(null),w=b.useRef(null),I=b.useRef(!1),A=R&&R.length>0;so();const N=(v,q,P=0)=>{if(I.current)return!0;const X=Math.abs(v.y),T=Math.abs(v.x),te=T>X,Z=["bottom","right"].includes(q)?1:-1;if(q==="left"||q==="right"){if(!(v.x*Z<0)&&T>=0&&T<=P)return te}else if(!(v.y*Z<0)&&X>=0&&X<=P)return!te;return I.current=!0,!0};b.useEffect(()=>{A&&window.requestAnimationFrame(()=>{W(!0)})},[]);function D(v){p.current=null,I.current=!1,u(v)}return b.createElement(Ps,{"data-vaul-drawer-direction":j,"data-vaul-drawer":"","data-vaul-delayed-snap-points":E?"true":"false","data-vaul-snap-points":S&&A?"true":"false","data-vaul-custom-container":M?"true":"false","data-vaul-animate":k!=null&&k.current?"true":"false",...s,ref:U,style:h&&h.length>0?{"--snap-point-height":`${h[f??0]}px`,...n}:n,onPointerDown:v=>{y||(s.onPointerDown==null||s.onPointerDown.call(s,v),p.current={x:v.pageX,y:v.pageY},m(v))},onOpenAutoFocus:v=>{r==null||r(v),$||v.preventDefault()},onPointerDownOutside:v=>{if(t==null||t(v),!d||v.defaultPrevented){v.preventDefault();return}c.current&&(c.current=!1)},onFocusOutside:v=>{if(!d){v.preventDefault();return}},onPointerMove:v=>{if(w.current=v,y||(s.onPointerMove==null||s.onPointerMove.call(s,v),!p.current))return;const q=v.pageY-p.current.y,P=v.pageX-p.current.x,X=v.pointerType==="touch"?10:2;N({x:P,y:q},j,X)?x(v):(Math.abs(P)>X||Math.abs(q)>X)&&(p.current=null)},onPointerUp:v=>{s.onPointerUp==null||s.onPointerUp.call(s,v),p.current=null,I.current=!1,u(v)},onPointerOut:v=>{s.onPointerOut==null||s.onPointerOut.call(s,v),D(w.current)},onContextMenu:v=>{s.onContextMenu==null||s.onContextMenu.call(s,v),w.current&&D(w.current)}})});ur.displayName="Drawer.Content";const io=250,lo=120,co=b.forwardRef(function({preventCycle:t=!1,children:n,...r},s){const{closeDrawer:a,isDragging:o,snapPoints:m,activeSnapPoint:u,setActiveSnapPoint:x,dismissible:c,handleOnly:h,isOpen:f,onPress:d,onDrag:S}=vt(),j=b.useRef(null),R=b.useRef(!1);function M(){if(R.current){$();return}window.setTimeout(()=>{y()},lo)}function y(){if(o||t||R.current){$();return}if($(),!m||m.length===0){c||a();return}if(u===m[m.length-1]&&c){a();return}const W=m.findIndex(p=>p===u);if(W===-1)return;const U=m[W+1];x(U)}function k(){j.current=window.setTimeout(()=>{R.current=!0},io)}function $(){j.current&&window.clearTimeout(j.current),R.current=!1}return b.createElement("div",{onClick:M,onPointerCancel:$,onPointerDown:E=>{h&&d(E),k()},onPointerMove:E=>{h&&S(E)},ref:s,"data-vaul-drawer-visible":f?"true":"false","data-vaul-handle":"","aria-hidden":"true",...r},b.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},n))});co.displayName="Drawer.Handle";function uo(t){const n=vt(),{container:r=n.container,...s}=t;return b.createElement(Ts,{container:r,...s})}const bt={Root:ao,Content:ur,Overlay:dr,Portal:uo,Title:$s};function Ht({...t}){return e.jsx(bt.Root,{"data-slot":"drawer",...t})}function fo({...t}){return e.jsx(bt.Portal,{"data-slot":"drawer-portal",...t})}function mo({className:t,...n}){return e.jsx(bt.Overlay,{"data-slot":"drawer-overlay",className:Re("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...n})}function zt({className:t,children:n,...r}){return e.jsxs(fo,{"data-slot":"drawer-portal",children:[e.jsx(mo,{}),e.jsxs(bt.Content,{"data-slot":"drawer-content",className:Re("group/drawer-content bg-background fixed z-50 flex h-auto flex-col","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",t),...r,children:[e.jsx("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),n]})]})}function wn({className:t,...n}){return e.jsx("div",{"data-slot":"drawer-header",className:Re("flex flex-col gap-0.5 p-4 group-data-[vaul-drawer-direction=bottom]/drawer-content:text-center group-data-[vaul-drawer-direction=top]/drawer-content:text-center md:gap-1.5 md:text-left",t),...n})}function jn({className:t,...n}){return e.jsx(bt.Title,{"data-slot":"drawer-title",className:Re("text-foreground font-semibold",t),...n})}function ho(){const t=Sn(),{selectedWatchDirs:n,selectedSources:r,setFiles:s,refreshFiles:a,showAllFiles:o,setShowAllFiles:m}=yn(),[u,x]=i.useState(new Set),[c,h]=i.useState(""),[f,d]=i.useState(""),[S,j]=i.useState({}),[R,M]=i.useState(!1),[y]=i.useState([]),[k]=i.useState(null),[$]=i.useState("TODO delete"),[E,W]=i.useState({}),[U,p]=i.useState(!0),[w,I]=i.useState(0),[A,N]=i.useState(null),[D,v]=i.useState(0),[q,P]=i.useState(!1),[X,T]=i.useState(!1),[te,Z]=i.useState(!1),[we,ee]=i.useState(!1),[he,ae]=i.useState(!1),[ve,ue]=i.useState(!1),[se,fe]=i.useState(null),[ne,ke]=i.useState(null),[Y,le]=i.useState(null),[L,C]=i.useState(""),g=i.useRef({}),V=i.useRef({}),ce=i.useRef({}),ie=i.useRef(null),Se=!0;i.useEffect(()=>{const z=ie.current;if(!z||!Se)return;const re=()=>{const Ne=z.scrollTop;p(Ne<=10),I(Ne)};return z.addEventListener("scroll",re),re(),()=>{z.removeEventListener("scroll",re)}},[Se]);const Te=()=>{const z=ie.current;z&&z.scrollTo({top:0,behavior:"smooth"})},Oe=async()=>{if(!c.trim()){j({}),d("");return}M(!0);try{const z=new URLSearchParams;z.append("query",c),n.length>0&&z.append("filter",n.join(",")),r.length>0&&z.append("sources",r.join(","));const re=await fetch(Ae(`/api/search?${z.toString()}`));if(re.ok){const Ne=await re.json();if(Ne.success){j(Ne.data.map(Q=>({[Q.file_path]:Q.matches.map(G=>G.line_number)})).reduce((Q,G)=>({...Q,...G}),{}));const K=Ne.data.map(Q=>{const G=Q.matches[0];return G&&G.video_info?G.video_info:null}).filter(Q=>Q!==null).filter((Q,G,de)=>G===de.findIndex(ye=>ye.full_path===Q.full_path));s(K)}d(c)}}catch(z){console.error("Error searching:",z)}finally{M(!1)}},ot=()=>{m(z=>!z)},Pe=()=>{h(""),d(""),j({}),x(new Set),o&&a()},je=z=>{const re=Math.floor(z/3600),Ne=Math.floor(z%3600/60),F=z%60,K=Math.floor(F),Q=Math.round((F-K)*1e3);return`${re.toString().padStart(2,"0")}:${Ne.toString().padStart(2,"0")}:${K.toString().padStart(2,"0")}.${Q.toString().padStart(3,"0")}`},ze=z=>{fe(z)},$e=z=>{ke(z)},_e=i.useCallback((z,re)=>{t?z?(ee(!0),ae(!1),ue(!1)):ee(!1):(N(z),T(!1),Z(!1))},[t]),ft=()=>{t?(ae(!0),ee(!1),ue(!1)):(T(!0),Z(!1),N(null))},Je=()=>{t?(ue(!0),ee(!1),ae(!1)):(Z(!0),T(!1),N(null))},mt=()=>{if(T(!1),se!==null&&ne!==null&&Y){const z=`/clip_player/${encodeURIComponent(Y)}?start_time=${se}&end_time=${ne}&display_text=false`,re=e.jsx("div",{className:"w-full flex-1 overflow-y-auto scrollbar-hide",children:e.jsx(pt,{filename:Y,start_time_formatted:je(se),end_time_formatted:je(ne),font_size:"",text:L,display_text:!1,onStartTimeChange:ze,onEndTimeChange:$e,onBack:()=>{t?ee(!1):(N(null),Ve())}},Y)});_e(re,z)}},De=()=>{if(Z(!1),se!==null&&ne!==null&&Y){const z=`/clip_player/${encodeURIComponent(Y)}?start_time=${se}&end_time=${ne}&display_text=false`,re=e.jsx("div",{className:"w-full flex-1 overflow-y-auto scrollbar-hide",children:e.jsx(pt,{filename:Y,start_time_formatted:je(se),end_time_formatted:je(ne),font_size:"",text:L,display_text:!1,onStartTimeChange:ze,onEndTimeChange:$e,onBack:()=>{t?ee(!1):(N(null),Ve())}},Y)});_e(re,z)}},Ue=(z,re)=>{Y&&Y!==re?(fe(z),ke(null),le(re)):(fe(z),le(re))},Me=(z,re)=>{Y&&Y!==re?(fe(null),ke(z),le(re)):(ke(z),le(re))},Ve=()=>{fe(null),ke(null),le(null),C(""),N(null),ee(!1),ae(!1),ue(!1),T(!1),Z(!1)},qe=(z,re,Ne,F)=>{fe(z),ke(re),le(F),C(Ne)},Ge=()=>{if(se!==null&&ne!==null&&Y){const z=`/clip_player/${encodeURIComponent(Y)}?start_time=${se}&end_time=${ne}&display_text=false`,re=e.jsx("div",{className:"w-full flex-1 overflow-y-auto scrollbar-hide",children:e.jsx(pt,{filename:Y,start_time_formatted:je(se),end_time_formatted:je(ne),font_size:"",text:L,display_text:!1,onStartTimeChange:ze,onEndTimeChange:$e,onBack:()=>{t?(_e(null),p(!0),setTimeout(()=>{ie.current&&(ie.current.scrollTop=w)},0)):N(null)}},Y)});_e(re,z)}};return i.useEffect(()=>{if(se!==null&&ne!==null&&Y){const z=`/clip_player/${encodeURIComponent(Y)}?start_time=${se}&end_time=${ne}&display_text=false`,re=e.jsx("div",{className:"w-full flex-1 overflow-y-auto scrollbar-hide",children:e.jsx(pt,{filename:Y,start_time_formatted:je(se),end_time_formatted:je(ne),font_size:"",text:L,display_text:!1,onStartTimeChange:ze,onEndTimeChange:$e,onBack:()=>{t?ee(!1):(N(null),Ve())}},Y)});_e(re,z)}else(se!==null||ne!==null)&&(t?ee(!1):N(null))},[se,ne,Y,_e,t]),i.useEffect(()=>{typeof window<"u"&&(window.handleSetRightPaneComponent=_e)},[_e]),e.jsxs(e.Fragment,{children:[e.jsx(Yr,{show:!0,searchTerm:c,setSearchTerm:h,activeSearchTerm:f,setActiveSearchTerm:d,setSearchLineNumbers:j,setExpandedFiles:x,isSearching:R,queue:y,currentProcessingFile:k,isAtTop:U,clipStart:se,clipEnd:ne,selectedWatchDirs:n,setSelectedWatchDirs:()=>{},availableWatchDirs:[],selectedSources:r,setSelectedSources:()=>{},availableSources:[],showAllFiles:o,onToggleShowAllFiles:ot,onSearch:Oe,onClearSearch:Pe,onScrollToTop:Te,onConfigClick:ft,onQueueClick:Je,mobileClipPlayerComponent:null,onPlayClip:Ge}),e.jsxs("div",{className:"flex h-screen",children:[e.jsx(ts,{watchDirectory:$,isSmallScreen:t,activeSearchTerm:f,searchLineNumbers:S,setSearchLineNumbers:j,expandedFiles:u,setExpandedFiles:x,transcriptData:E,setTranscriptData:W,currentProcessingFile:k,leftPaneWidth:D,setLeftPaneWidth:v,isLeftPaneWidthMeasured:q,setIsLeftPaneWidthMeasured:P,clipStart:se,clipEnd:ne,clipTranscript:Y,fileRowRefs:g,transcriptRowRefs:V,mobileTranscriptRowRefs:ce,leftPaneRef:ie,onSetRightPaneUrl:_e,onSetClipStart:Ue,onSetClipEnd:Me,onClearClip:Ve,onClipBlock:qe,showAllFiles:o}),!t&&e.jsx("div",{className:"w-1/2 border-l border-border flex flex-col scrollbar-hide pt-16",children:X?e.jsx(an,{onClose:mt}):te?e.jsx(on,{onClose:De}):A||e.jsx(ns,{})})]}),t&&e.jsxs(e.Fragment,{children:[e.jsx(Ht,{open:we,onOpenChange:ee,children:e.jsx(zt,{children:e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:se!==null&&ne!==null&&Y&&e.jsx(pt,{filename:Y,start_time_formatted:je(se),end_time_formatted:je(ne),font_size:"",text:L,display_text:!1,onStartTimeChange:ze,onEndTimeChange:$e,onBack:()=>ee(!1)},Y)})})}),e.jsx(Ht,{open:he,onOpenChange:ae,children:e.jsxs(zt,{children:[e.jsx(wn,{children:e.jsx(jn,{children:"Configuration"})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(an,{onClose:()=>ae(!1)})})]})}),e.jsx(Ht,{open:ve,onOpenChange:ue,children:e.jsxs(zt,{children:[e.jsx(wn,{children:e.jsx(jn,{children:"Processing Queue"})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(on,{onClose:()=>ue(!1)})})]})})]})]})}function yo(){return e.jsx(ho,{})}export{yo as default};
