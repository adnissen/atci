import{j as e,S as Sn,C as Rn,a as En,T as Ln,R as _n,b as Mn,P as $n,O as Tn}from"./radix-CDPlHJ-s.js";import{r as d,b as f}from"./router-Cji3JhtE.js";import{a as Dn}from"./utils-BMpDO24p.js";import{c as Oe,a as Fe,u as Jt,T as On,b as Pn,d as kt,e as nt,f as Bn,g as Ke}from"./index.js";import{D as He,a as ze,b as We,c as wt,d as Ze,e as et,f as we,Q as Ft}from"./QueuePage-BtxpzuDR.js";import{b as Nt,X as In,c as An,d as Ht,e as Fn,f as Hn,R as zn,g as Wn,D as Ct,h as St}from"./icons-D0PEVxHe.js";import zt from"./ConfigPage-DWe62UL6.js";import"./react-vendor-DJG_os-6.js";const Un=Dn("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),pe=d.forwardRef(({className:t,variant:n,size:r,asChild:a=!1,...o},i)=>{const b=a?Sn:"button";return e.jsx(b,{className:Oe(Un({variant:n,size:r,className:t})),ref:i,...o})});pe.displayName="Button";function Vn(t){const[n,r]=d.useState(()=>window.matchMedia(t).matches);return d.useEffect(()=>{const a=window.matchMedia(t),o=i=>{r(i.matches)};return a.addEventListener("change",o),r(a.matches),()=>{a.removeEventListener("change",o)}},[t]),n}function Kt(){return!Vn("(min-width: 640px)")}function qn({searchTerm:t,setSearchTerm:n,activeSearchTerm:r,setActiveSearchTerm:a,setSearchLineNumbers:o,setExpandedFiles:i,isSearching:b,isOpen:w,onClose:k,onSearch:L,onClearSearch:g,selectedWatchDirs:u,setSelectedWatchDirs:h,availableWatchDirs:D,selectedSources:$,setSelectedSources:T,availableSources:B}){const R=()=>{n(""),a(""),o({}),i(new Set),g()};return w?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-start justify-center pt-20",children:e.jsx("div",{className:"bg-background border border-border rounded-lg shadow-lg w-full max-w-md mx-4",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Search"}),e.jsx("button",{onClick:k,className:"p-1 text-muted-foreground hover:text-foreground transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search",value:t,onChange:E=>{const I=E.target.value;n(I),I.trim()===""&&(a(""),o({}),i(new Set))},onKeyDown:E=>{E.key==="Enter"&&(L(),k())},className:"w-full px-3 py-2 pr-10 text-sm border border-input bg-background text-foreground rounded focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent",autoFocus:!0}),(t||r)&&e.jsx("button",{onClick:R,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",title:"Clear search",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(D.length>1||B.length>1)&&e.jsxs("div",{className:"mb-4 space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground",children:"Search Filters"}),D.length>1&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Watch Directories"}),e.jsxs(He,{modal:!1,children:[e.jsx(ze,{asChild:!0,children:e.jsxs("button",{className:"w-full inline-flex items-center justify-between whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[u.length===D.length||u.length===0?"All Directories":`${u.length} Director${u.length===1?"y":"ies"}`,e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsxs(We,{align:"start",className:"w-80",children:[e.jsx(wt,{children:"Watch Directories"}),e.jsx(Ze,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 p-2",children:[e.jsx(et,{checked:u.length===D.length,onCheckedChange:E=>{h(E?[...D]:[])},children:"Select All"}),e.jsx(Ze,{}),D.map(E=>e.jsx(et,{checked:u.includes(E),onCheckedChange:I=>{h(I?[...u,E]:u.filter(y=>y!==E))},children:e.jsx("span",{className:"truncate",title:E,children:E.split("/").pop()||E})},E))]})]})]})]}),B.length>1&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Transcript Sources"}),e.jsxs(He,{modal:!1,children:[e.jsx(ze,{asChild:!0,children:e.jsxs("button",{className:"w-full inline-flex items-center justify-between whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[$.length===B.length?"All Sources":$.length===0?"No Sources":`${$.length} Source${$.length===1?"":"s"}`,e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsxs(We,{align:"start",className:"w-80",children:[e.jsx(wt,{children:"Sources"}),e.jsx(Ze,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 p-2",children:[e.jsx(et,{checked:$.length===B.length,onCheckedChange:E=>{T(E?[...B]:[])},children:"Select All"}),e.jsx(Ze,{}),B.map(E=>e.jsx(et,{checked:$.includes(E),onCheckedChange:I=>{T(I?[...$,E]:$.filter(y=>y!==E))},children:E},E))]})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{L(),k()},disabled:b,className:"flex-1 px-4 py-2 text-sm bg-primary text-primary-foreground rounded hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-ring disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:`w-4 h-4 ${b?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7",strokeWidth:2}),e.jsx("line",{x1:"16.5",y1:"16.5",x2:"21",y2:"21",strokeWidth:2,strokeLinecap:"round"})]}),"Search"]}),e.jsx("button",{onClick:R,className:"px-4 py-2 text-sm border border-red-300 bg-red-50 text-red-700 rounded hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-500",children:"Clear"}),e.jsx("button",{onClick:k,className:"px-4 py-2 text-sm border border-input bg-background text-foreground rounded hover:bg-accent focus:outline-none focus:ring-2 focus:ring-ring",children:"Cancel"})]})]})})}):null}function Yn({show:t,searchTerm:n,setSearchTerm:r,activeSearchTerm:a,setActiveSearchTerm:o,setSearchLineNumbers:i,setExpandedFiles:b,isSearching:w,queue:k,isAtTop:L,clipStart:g,clipEnd:u,mobileClipPlayerComponent:h,selectedWatchDirs:D,setSelectedWatchDirs:$,availableWatchDirs:T,selectedSources:B,setSelectedSources:R,availableSources:E,showAllFiles:I,onToggleShowAllFiles:y,onSearch:U,onClearSearch:q,onScrollToTop:m,onConfigClick:x,onQueueClick:F,onPlayClip:W}){const[j,_]=d.useState(!1),c=Kt(),H=()=>{r(""),o(""),i({}),b(new Set),q()};return e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:`fixed top-0 left-0 right-0 bg-background/95 border-b border-border px-2 sm:px-4 z-10 backdrop-blur-sm ${c?"py-1":"py-2"}`,children:e.jsx("div",{className:"w-full",children:c?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center gap-1",children:[e.jsx("div",{className:"flex items-center flex-shrink-0",children:e.jsx("span",{className:"text-primary font-bold text-lg",children:"atci"})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(pe,{onClick:x,variant:"ghost",size:"sm",className:"px-2 py-1 rounded hover:bg-accent group text-xs gap-1",title:"Edit configuration",children:[e.jsx("svg",{className:"w-4 h-4 group-hover:animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"})}),e.jsx("span",{children:"Config"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs(pe,{onClick:F,variant:"ghost",size:"sm",className:"px-2 py-1 rounded hover:bg-accent text-xs gap-1 group",title:"View processing queue",children:[e.jsx("div",{className:"relative w-4 h-4 overflow-hidden",children:e.jsxs("div",{className:"group-hover:animate-[moveUp_1s_linear_infinite] transition-transform",children:[e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"2px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"6px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"10px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"14px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"18px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"22px"}})]})}),e.jsx("span",{children:"Queue"})]}),k.length>0&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1",children:k.length})]}),e.jsxs(pe,{onClick:W,disabled:g==null||u===null||u===void 0||!W||h!==null,variant:"ghost",size:"sm",className:"px-2 py-1 rounded hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed text-xs gap-1",title:h!==null?"Clip player is already open":g!=null&&u!==null&&u!==void 0?"Play Clip":"No clip selected",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})}),e.jsx("span",{children:"Clip"})]})]})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"looking for something?",value:n,onChange:S=>{const Y=S.target.value;r(Y),Y.trim()===""&&(o(""),i({}),b(new Set))},onKeyDown:S=>S.key==="Enter"&&U(),className:"w-full px-3 py-1.5 bg-muted text-foreground text-sm rounded-full border border-border focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),(n||a)&&e.jsx("button",{onClick:H,className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-0.5 text-muted-foreground hover:text-foreground transition-colors rounded-full hover:bg-accent",title:"Clear search",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx(pe,{onClick:()=>{I&&y(),U()},disabled:w,variant:I&&!a?"secondary":"default",className:`px-3 py-1.5 rounded-full text-sm font-medium disabled:opacity-50 ${I&&!a?"":"bg-primary hover:bg-primary/90 text-primary-foreground"}`,children:w?e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7",strokeWidth:2}),e.jsx("line",{x1:"16.5",y1:"16.5",x2:"21",y2:"21",strokeWidth:2,strokeLinecap:"round"})]}):"Search"}),e.jsx(pe,{onClick:()=>{H(),I||y(),m()},variant:I&&!a?"default":"secondary",className:"px-3 py-1.5 rounded-full text-sm font-medium",children:"All"})]})]}):e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"flex items-center flex-shrink-0",children:e.jsx("span",{className:"text-primary font-bold text-lg",children:"atci"})}),e.jsx("div",{className:"flex-1 max-w-md mx-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"looking for something?",value:n,onChange:S=>{const Y=S.target.value;r(Y),Y.trim()===""&&(o(""),i({}),b(new Set))},onKeyDown:S=>S.key==="Enter"&&U(),className:"w-full px-4 py-2 bg-muted text-foreground rounded-full border border-border focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),(n||a)&&e.jsx("button",{onClick:H,className:"absolute right-3 top-1/2 transform -translate-y-1/2 p-1 text-muted-foreground hover:text-foreground transition-colors rounded-full hover:bg-accent",title:"Clear search",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex gap-1 items-center flex-shrink-0",children:[e.jsx(pe,{onClick:()=>{I&&y(),U()},disabled:w,variant:I&&!a?"secondary":"default",className:`px-4 py-2 rounded-full text-sm font-medium disabled:opacity-50 ${I&&!a?"":"bg-primary hover:bg-primary/90 text-primary-foreground"}`,children:w?e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7",strokeWidth:2}),e.jsx("line",{x1:"16.5",y1:"16.5",x2:"21",y2:"21",strokeWidth:2,strokeLinecap:"round"})]}):"Search"}),e.jsx(pe,{onClick:()=>{H(),I||y(),m()},variant:I&&!a?"default":"secondary",className:"px-4 py-2 rounded-full text-sm font-medium",children:"All"}),e.jsxs("div",{className:"relative",children:[e.jsx(pe,{onClick:F,variant:"ghost",size:"sm",className:"p-2 rounded-full hover:bg-accent group",title:"View processing queue",children:e.jsx("div",{className:"relative w-5 h-5 overflow-hidden",children:e.jsxs("div",{className:"group-hover:animate-[moveUp_1s_linear_infinite] transition-transform",children:[e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"3px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"8px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"13px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"18px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"23px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"28px"}})]})})}),k.length>0&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1",children:k.length})]}),e.jsx(pe,{variant:"ghost",size:"sm",onClick:()=>{L||m()},disabled:L,title:L?"Already at top":"Scroll to top",className:"p-2 rounded-full hover:bg-accent disabled:opacity-50 group overflow-hidden",children:e.jsxs("div",{className:"relative w-5 h-5",children:[e.jsx("svg",{className:"w-5 h-5 group-hover:opacity-0 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})}),e.jsxs("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 group-hover:animate-[moveUpArrow_1s_linear_infinite] transition-opacity",children:[e.jsx("svg",{className:"w-5 h-5 absolute",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})}),e.jsx("svg",{className:"w-5 h-5 absolute",style:{top:"24px"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 10l7-7m0 0l7 7m-7-7v18"})})]})]})}),e.jsx(pe,{onClick:x,variant:"ghost",size:"sm",className:"p-2 rounded-full hover:bg-accent group",title:"Edit configuration",children:e.jsx("svg",{className:"w-5 h-5 group-hover:animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"})})})]})]})})}),e.jsx(qn,{searchTerm:n,setSearchTerm:r,activeSearchTerm:a,setActiveSearchTerm:o,setSearchLineNumbers:i,setExpandedFiles:b,isSearching:w,isOpen:j,onClose:()=>_(!1),onSearch:U,onClearSearch:q,selectedWatchDirs:D,setSelectedWatchDirs:$,availableWatchDirs:T,selectedSources:B,setSelectedSources:R,availableSources:E})]})}const Tt=({isOpen:t,filename:n,transcriptInitialValue:r,onTranscriptSave:a,onCancel:o,isTranscriptSubmitting:i,transcriptTargetLineNumber:b})=>{const[w,k]=f.useState(r),L=f.useRef(null);f.useEffect(()=>{t&&k(r)},[t,r]),f.useEffect(()=>{t&&b&&L.current&&setTimeout(()=>{const u=L.current;if(!u)return;const h=u.value.split(`
`);if(b<=h.length){let D=0;for(let B=0;B<b-1;B++)D+=h[B].length+1;u.setSelectionRange(D,D),u.focus();const $=u.scrollHeight/h.length,T=(b-1)*$;u.scrollTop=T-u.clientHeight/2}},100)},[t,b]);const g=()=>{a(w)};return t?e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-card border border-border rounded-lg max-w-5xl w-full mx-4 max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-border",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground",children:["Edit Transcript - ",n]}),e.jsx("button",{onClick:o,className:"p-1 text-muted-foreground hover:text-foreground hover:bg-accent rounded transition-colors",title:"Close",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"text-md font-medium text-foreground",children:"Transcript (.txt)"}),e.jsx("button",{onClick:g,disabled:i,className:"px-3 py-1.5 text-xs font-normal text-primary-foreground bg-primary border border-transparent rounded hover:bg-primary/90 disabled:opacity-50 transition-colors",children:i?"Saving...":"Save Transcript"})]}),e.jsx("textarea",{ref:L,value:w,onChange:u=>k(u.target.value),className:"w-full h-64 p-3 border border-input bg-background text-foreground rounded-md font-mono text-sm leading-6 focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent",placeholder:"Enter transcript content...",readOnly:i})]})})]})}):null},Wt=({open:t,onOpenChange:n,selectedTime:r,clipStart:a,clipEnd:o,clipTranscript:i,currentTranscript:b,onSetClipStart:w,onSetClipEnd:k,onClearClip:L,onClipBlock:g,blockStartTime:u,blockEndTime:h,children:D})=>{const $=i!==null&&i!==b,T=!$&&o!==null&&r>=o,B=!$&&a!==null&&r<=a;return e.jsxs(He,{modal:!1,open:t,onOpenChange:n,children:[e.jsx(ze,{asChild:!0,children:D}),e.jsxs(We,{align:"start",side:"right",sideOffset:8,children:[e.jsxs(we,{onClick:()=>w(r),disabled:T,className:`flex items-center gap-2 ${T?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(Nt,{size:16,className:"text-green-600"}),"Set Clip Start"]}),e.jsxs(we,{onClick:()=>k(r),disabled:B,className:`flex items-center gap-2 ${B?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(Nt,{size:16,className:"text-red-600"}),"Set Clip End"]}),g&&u!==void 0&&h!==void 0&&e.jsxs(we,{onClick:()=>g(u,h),className:"flex items-center gap-2",children:[e.jsx(Nt,{size:16,className:"text-purple-600"}),"Clip Block"]}),(a!==null||o!==null)&&e.jsxs(we,{onClick:L,className:"flex items-center gap-2",children:[e.jsx(In,{size:16,className:"text-gray-600"}),"Clear Clip"]})]})]})},Xn=f.memo(({startTime:t,endTime:n,visible:r,text:a,name:o,fullPath:i,isSearchResult:b=!1,lineNumbers:w,onEditSuccess:k,fullTranscript:L="",isSmallScreen:g=!1,onSetRightPaneUrl:u,clipStart:h,clipEnd:D,clipTranscript:$,onSetClipStart:T,onSetClipEnd:B,onClearClip:R,onClipBlock:E})=>{const[I,y]=f.useState(!1),[U,q]=f.useState(!1),[m,x]=f.useState(!1),[F,W]=f.useState(null),[j,_]=f.useState(null),[c,H]=f.useState(!1),[S,Y]=f.useState(null),M=p=>{const l=p.split(":"),V=parseInt(l[0],10),X=parseInt(l[1],10),de=l[2].split("."),ie=parseInt(de[0],10),Be=parseInt(de[1]||"0",10);return V*3600+X*60+ie+Be/1e3},re=f.useMemo(()=>{if(!t||!n||h===null||h===void 0||$!==o)return!1;const p=M(t),l=M(n);return h>=p&&h<=l},[t,n,h,$,o]),Z=f.useMemo(()=>{if(!t||!n||D===null||D===void 0||$!==o)return!1;const p=M(t),l=M(n);return D>=p&&D<=l},[t,n,D,$,o]),xe=f.useMemo(()=>{if(!t||!n||h===null||h===void 0||D===null||D===void 0||$!==i)return!1;const p=M(t),l=M(n);return p>=h&&l<=D},[t,n,h,D,$,o]),ae=re||Z||xe,ge=(p,l)=>{Y({time:p,type:l}),H(!0)};if(f.useEffect(()=>{},[a]),f.useEffect(()=>{},[t,n]),f.useEffect(()=>{const p=l=>{const V=l.target;if(V.classList.contains("timestamp-link")){l.preventDefault();const X=V.getAttribute("data-url");X&&u&&u(X)}};return document.addEventListener("click",p),()=>{document.removeEventListener("click",p)}},[u]),!r||a==="WEBVTT")return null;const ce=f.useMemo(()=>{const p=/(\d{2}:\d{2}:\d{2}\.\d{3})/g;return a.replace(p,l=>{const V=M(l);return`<span class="text-sky-700 hover:text-sky-600 underline cursor-pointer timestamp-link" data-timestamp="${l}" data-url="/player/${encodeURIComponent(o)}?time=${V}">${l}</span>`})},[a,o]),Ne=()=>{y(!0)},ue=async p=>{var l;if(p.trim()===L.trim()){y(!1);return}q(!0);try{const V=(l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"),X=await fetch(Fe("/api/transcripts/replace"),{method:"POST",headers:{"X-CSRF-Token":V||"","Content-Type":"application/json"},body:JSON.stringify({video_path:o,new_content:p})});if(X.ok)k&&k(),y(!1);else{const de=await X.json();alert(`Error: ${de.error||"Failed to update transcript"}`)}}catch(V){console.error("Error updating transcript:",V),alert("Error: Failed to update transcript. Please try again.")}finally{q(!1)}},Pe=()=>{y(!1)},le=()=>{x(!0)},Me=async p=>{var l;if(p.trim()===L.trim()){x(!1);return}q(!0);try{const V=(l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"),X=await fetch(Fe("/api/transcripts/replace"),{method:"POST",headers:{"X-CSRF-Token":V||"","Content-Type":"application/json"},body:JSON.stringify({video_path:i,new_content:p})});if(X.ok)k&&k(),x(!1);else{const de=await X.json();alert(`Error: ${de.error||"Failed to update timestamp"}`)}}catch(V){console.error("Error updating timestamp:",V),alert("Error: Failed to update timestamp. Please try again.")}finally{q(!1)}},Se=()=>{x(!1)};if(t&&n&&t===n)return e.jsx(e.Fragment,{});const Ce=w[0],se=w[w.length-1],N=()=>{const p=[];return b&&ae?p.push("bg-gradient-to-r","from-primary/10","to-amber-500/10","border-l-4","border-primary","pl-2"):b?p.push("bg-primary/10","border-l-4","border-primary","pl-2"):ae&&p.push("bg-amber-500/10","border-l-4","border-amber-500","pl-2"),p.join(" ")};return e.jsxs("div",{className:N(),children:[ae&&e.jsx("div",{className:"flex items-center gap-1 text-xs text-amber-600 dark:text-amber-400 mb-1",children:e.jsx("span",{className:"bg-amber-500/20 px-1 py-0.5 rounded text-amber-700 dark:text-amber-300 font-medium",children:"Clip"})}),t&&n&&e.jsx("div",{className:"group",children:e.jsxs("span",{className:"relative",children:[e.jsx("div",{className:"flex items-center gap-1 min-w-0",children:e.jsxs("div",{className:"text-muted-foreground text-sm font-mono flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:`text-xs mr-2 flex-shrink-0 text-right w-8 cursor-pointer transition-colors duration-200 ${F===Ce||j==="timestamp"?"text-blue-600 hover:text-blue-700":"text-muted-foreground hover:text-blue-500"}`,onClick:()=>_(j==="timestamp"?null:"timestamp"),onMouseEnter:()=>W(Ce),onMouseLeave:()=>W(null),children:Ce}),e.jsxs("span",{className:"min-w-0",children:[e.jsx(Wt,{open:c&&(S==null?void 0:S.type)==="start",onOpenChange:p=>{H(p),p||Y(null)},selectedTime:(S==null?void 0:S.time)||(t?M(t):0),clipStart:h??null,clipEnd:D??null,clipTranscript:$??null,currentTranscript:o,onSetClipStart:T||(()=>{}),onSetClipEnd:B||(()=>{}),onClearClip:R||(()=>{}),onClipBlock:E?(p,l)=>E(p,l,a,i):void 0,blockStartTime:t?M(t):void 0,blockEndTime:n?M(n):void 0,children:e.jsx("span",{onClick:()=>t&&ge(M(t),"start"),className:"text-sky-700 hover:text-sky-600 underline cursor-pointer",onMouseEnter:()=>W(Ce),onMouseLeave:()=>W(null),children:t})})," --> ",e.jsx(Wt,{open:c&&(S==null?void 0:S.type)==="end",onOpenChange:p=>{H(p),p||Y(null)},selectedTime:(S==null?void 0:S.time)||(n?M(n):0),clipStart:h??null,clipEnd:D??null,clipTranscript:$??null,currentTranscript:o,onSetClipStart:T||(()=>{}),onSetClipEnd:B||(()=>{}),onClearClip:R||(()=>{}),onClipBlock:E?(p,l)=>E(p,l,a,i):void 0,blockStartTime:t?M(t):void 0,blockEndTime:n?M(n):void 0,children:e.jsx("span",{onClick:()=>n&&ge(M(n),"end"),className:"text-sky-700 hover:text-sky-600 underline cursor-pointer",onMouseEnter:()=>W(Ce),onMouseLeave:()=>W(null),children:n})})]})]})}),e.jsx("div",{className:"flex items-center gap-1 min-w-0",children:e.jsxs("div",{className:"text-muted-foreground text-sm font-mono flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("span",{className:`text-xs mr-2 flex-shrink-0 text-right w-8 cursor-pointer transition-colors duration-200 ${F===se||j==="content"?"text-blue-600 hover:text-blue-700":"text-muted-foreground hover:text-blue-500"}`,onClick:()=>_(j==="content"?null:"content"),onMouseEnter:()=>W(se),onMouseLeave:()=>W(null),children:se}),e.jsx("div",{className:"text-foreground font-mono text-sm leading-relaxed whitespace-pre-wrap break-words flex-1 min-w-0",dangerouslySetInnerHTML:{__html:ce},onMouseEnter:()=>W(se),onMouseLeave:()=>W(null)})]})}),j&&e.jsx("div",{className:"absolute left-0 top-0 z-10 dropdown-menu-container",children:e.jsxs(He,{modal:!1,open:j==="timestamp"||j==="content",onOpenChange:p=>!p&&_(null),children:[e.jsx(ze,{asChild:!0,children:e.jsx("div",{className:"invisible"})}),e.jsxs(We,{align:"start",side:"right",sideOffset:8,children:[e.jsx(we,{asChild:!0,children:e.jsxs("a",{href:`/api/frame?filename=${encodeURIComponent(i)}&time=${M(t)+(M(n)-M(t))/2}&text=${encodeURIComponent(a)}`,target:"_blank",className:"flex items-center gap-2 w-full",children:[e.jsx(An,{size:16,className:"text-[#6d28d9]"}),"View Frame"]})}),e.jsxs(we,{onClick:()=>le(),className:"flex items-center gap-2",children:[e.jsx(Ht,{size:16,className:"text-[#3b82f6]"}),"Edit Line"]})]})]})})]})}),a!=null&&!t&&!n&&e.jsx("div",{className:"group",children:e.jsxs("span",{className:"relative",children:[e.jsx("div",{className:"flex items-center gap-1 min-w-0",children:e.jsxs("div",{className:"text-muted-foreground text-sm font-mono flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("span",{className:`text-xs mr-2 flex-shrink-0 text-right w-8 cursor-pointer transition-colors duration-200 ${F===se||j==="content"?"text-blue-600 hover:text-blue-700":"text-muted-foreground hover:text-blue-500"}`,onClick:()=>_(j==="content"?null:"content"),onMouseEnter:()=>W(se),onMouseLeave:()=>W(null),children:se}),e.jsx("div",{className:"text-foreground font-mono text-sm leading-relaxed whitespace-pre-wrap break-words flex-1 min-w-0",dangerouslySetInnerHTML:{__html:ce},onMouseEnter:()=>W(se),onMouseLeave:()=>W(null)})]})}),j==="content"&&e.jsx("div",{className:"absolute left-0 top-0 z-10 dropdown-menu-container",children:e.jsxs(He,{modal:!1,open:!0,onOpenChange:p=>!p&&_(null),children:[e.jsx(ze,{asChild:!0,children:e.jsx("div",{className:"invisible"})}),e.jsx(We,{align:"start",side:"right",sideOffset:8,children:e.jsxs(we,{onClick:Ne,className:"flex items-center gap-2",children:[e.jsx(Ht,{size:16,className:"text-[#3b82f6]"}),"Edit Line"]})})]})})]})}),e.jsx(Tt,{isOpen:I,filename:i,transcriptInitialValue:L,onTranscriptSave:ue,onCancel:Pe,isTranscriptSubmitting:U,transcriptTargetLineNumber:se}),e.jsx(Tt,{isOpen:m,filename:i,transcriptInitialValue:L,onTranscriptSave:Me,onCancel:Se,isTranscriptSubmitting:U,transcriptTargetLineNumber:Ce})]})}),Zt=({visible:t=!1,name:n,fullPath:r,className:a="",searchTerm:o="",text:i="",loading:b=!1,error:w=null,visibleLines:k=[],expandContext:L,onEditSuccess:g,isSmallScreen:u=!1,onSetRightPaneUrl:h,clipStart:D,clipEnd:$,clipTranscript:T,onSetClipStart:B,onSetClipEnd:R,onClearClip:E,onClipBlock:I})=>{const y=f.useRef(null),U=j=>{const _=/\d{2}:\d{2}:\d{2}\.\d{3}/g,c=j.match(_);return c&&c.length>=2&&j.includes("-->")?{hasRange:!0,time1:c[0],time2:c[1]}:{hasRange:!1}},q=(j,_)=>{const c=j.split(`
`).flatMap(M=>M.split("\r")),H=[],S=o.toLowerCase(),Y=_.length===1&&_[0]===-1||_.length===0;for(let M=0;M<c.length;M++){const re=c[M],Z=U(re);if(Z.hasRange&&Z.time1&&Z.time2){const xe=M<c.length-1?c[M+1]:"",ae=xe.toLowerCase(),ge=o?ae.includes(S):!1,ce=[M+1,M+2],Ne=Y||ce.some(ue=>_.includes(ue));H.push({startTime:Z.time1,endTime:Z.time2,text:xe,visible:Ne,isSearchResult:ge,originalIndex:H.length,lineNumbers:ce}),M++}else{const xe=re.toLowerCase(),ae=o?xe.includes(S):!1,ge=[M+1],ce=Y||ge.some(Ne=>_.includes(Ne));H.push({text:re,visible:ce,isSearchResult:ae,originalIndex:H.length,lineNumbers:ge})}}return H},m=f.useMemo(()=>q(i,k),[i,k,o]),x=f.useMemo(()=>{const j=k.length===1&&k[0]===-1;if(k.length===0||j)return m.map(H=>({type:"block",data:H}));const _=[];let c=0;for(let H=0;H<m.length;H++){const S=m[H];if(S.visible){c>0&&(_.push({type:"message",data:{count:c,line:S.lineNumbers[S.lineNumbers.length-1],direction:"up"}}),c=0),_.push({type:"block",data:S});let Y=0;for(let M=H+1;M<m.length;M++){const re=m[M];if(re.visible)break;Y+=re.lineNumbers.length}Y>0&&_.push({type:"message",data:{count:Y,line:S.lineNumbers[S.lineNumbers.length-1],direction:"down"}})}else c+=S.lineNumbers.length}return _},[m,k]),F=f.useMemo(()=>x.map((j,_)=>({...j,virtualIndex:_,originalIndex:_})),[x]),W=(j,_)=>{L(r,_,j)};return t?e.jsx("div",{className:`w-full ${u?"px-4 py-4 bg-transparent":"p-3 sm:p-6 bg-card border border-border"} ${a}`,children:e.jsxs("div",{className:"space-y-4",children:[b&&e.jsx("div",{className:"text-muted-foreground",children:"Loading transcript..."}),w&&e.jsxs("div",{className:"text-destructive",children:["Error: ",w]}),!b&&!w&&e.jsxs("div",{className:"text-muted-foreground text-left relative",children:[o&&m.filter(j=>j.isSearchResult).length===0&&e.jsxs("div",{className:"text-muted-foreground italic",children:['No matches found for "',o,'" in this transcript.']}),m.length>0&&e.jsx("div",{ref:y,className:"space-y-0.5 max-h-[600px] overflow-y-auto",style:{WebkitOverflowScrolling:"touch",scrollBehavior:"smooth"},children:F.map(j=>e.jsx("div",{children:j.type==="block"?e.jsx(Xn,{fullPath:r,startTime:j.data.startTime,endTime:j.data.endTime,visible:j.data.visible,text:j.data.text,name:n,isSearchResult:j.data.isSearchResult,lineNumbers:j.data.lineNumbers,onEditSuccess:g,fullTranscript:i,isSmallScreen:u,onSetRightPaneUrl:h,clipStart:D,clipEnd:$,clipTranscript:T,onSetClipStart:B,onSetClipEnd:R,onClearClip:E,onClipBlock:I}):e.jsx("div",{className:"text-muted-foreground italic",children:e.jsxs("span",{className:"cursor-pointer hover:text-primary hover:underline",onClick:()=>W(j.data.line,j.data.direction),children:["[",j.data.count," lines ",j.data.direction==="up"?"above":"below","]"]})})},j.type==="block"?`${j.data.originalIndex}-${j.virtualIndex}`:`message-${j.virtualIndex}`))})]})]})}):null},jt=d.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Oe("rounded-xl border bg-card text-card-foreground shadow",t),...n}));jt.displayName="Card";const en=d.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Oe("flex flex-col space-y-1.5 p-6",t),...n}));en.displayName="CardHeader";const Gn=d.forwardRef(({className:t,...n},r)=>e.jsx("h3",{ref:r,className:Oe("font-semibold leading-none tracking-tight",t),...n}));Gn.displayName="CardTitle";const Qn=d.forwardRef(({className:t,...n},r)=>e.jsx("p",{ref:r,className:Oe("text-sm text-muted-foreground",t),...n}));Qn.displayName="CardDescription";const yt=d.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Oe("p-6 pt-0",t),...n}));yt.displayName="CardContent";const tn=d.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Oe("flex items-center p-6 pt-0",t),...n}));tn.displayName="CardFooter";function Dt({isOpen:t,videoPath:n,source:r,onClose:a,onRegenerate:o}){var U,q;const[,i]=d.useState([]),[,b]=d.useState([]),[w,k]=d.useState([]),[L,g]=d.useState(""),[u,h]=d.useState(!1),[D,$]=d.useState(null),[T,B]=d.useState(!1),R=m=>{if(!r)return!1;if(m.type==="subtitle"){const x=r.match(/subtitles.*\((\d+)\)/);return!!(x&&parseInt(x[1])===m.subtitle_stream_index)}else if(m.type==="whisper")return r===m.model;return!1};d.useEffect(()=>{t&&n&&E()},[t,n]);const E=async()=>{h(!0),$(null);try{const[m,x]=await Promise.all([fetch(Fe(`/api/video/subtitle-streams?path=${encodeURIComponent(n)}`)),fetch(Fe("/api/models/list"))]);let F=[],W=[];if(m.ok){const c=await m.json();c.success&&(F=c.data)}if(x.ok){const c=await x.json();c.success&&(W=c.data.filter(H=>H.downloaded))}i(F),b(W);const j=[];F.forEach(c=>{const H=c.language||"Unknown",S={id:`subtitle_${c.index}`,type:"subtitle",label:`Subtitles: ${H} (${c.index})`,subtitle_stream_index:c.index};R(S)&&(S.label+=" (last used)"),j.push(S)}),W.forEach(c=>{const H={id:`whisper_${c.name}`,type:"whisper",label:`${c.name}`,model:c.name};R(H)&&(H.label+=" (last used)"),j.push(H)}),k(j);const _=j.find(c=>R(c));g(_?_.id:"")}catch(m){console.error("Error fetching regeneration data:",m),$("Failed to load regeneration options")}finally{h(!1)}},I=async()=>{if(!L)return;const m=w.find(x=>x.id===L);if(m){B(!0);try{await o(m.type==="whisper"?m.model:void 0,m.type==="subtitle"?m.subtitle_stream_index:void 0),a()}catch(x){console.error("Regeneration failed:",x),$("Failed to regenerate transcript")}finally{B(!1)}}},y=()=>{T||a()};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background border border-border rounded-lg p-6 w-96 max-w-90vw max-h-80vh overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Regenerate Transcript"}),e.jsx("button",{onClick:y,disabled:T,className:"text-muted-foreground hover:text-foreground disabled:opacity-50",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose a processing method for: ",((U=n.split("/").pop())==null?void 0:U.split("\\").pop())||n]}),u&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Loading options..."]})}),D&&e.jsx("div",{className:"text-sm text-destructive mb-4 p-3 bg-destructive/10 border border-destructive/20 rounded",children:D}),!u&&!D&&w.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground mb-4 p-3 bg-muted border border-border rounded",children:"No processing options available. Make sure you have subtitle streams or downloaded Whisper models."}),!u&&!D&&w.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Processing Method:"}),e.jsxs(He,{children:[e.jsx(ze,{asChild:!0,children:e.jsxs(pe,{variant:"outline",className:"w-full justify-between",disabled:T,children:[L&&((q=w.find(m=>m.id===L))==null?void 0:q.label)||"Select a processing method...",e.jsx("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsx(We,{className:"w-full min-w-[400px]",children:w.map(m=>e.jsxs(we,{onClick:()=>g(m.id),className:"flex flex-col items-start p-3",children:[e.jsx("div",{className:"font-medium",children:m.label}),e.jsx("div",{className:"text-xs text-muted-foreground",children:m.type==="subtitle"?"Extract from embedded subtitles":"AI transcription"})]},m.id))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:y,disabled:T,className:"px-4 py-2 text-sm border border-input bg-background text-foreground rounded hover:bg-accent focus:outline-none focus:ring-1 focus:ring-ring disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{onClick:I,disabled:T||!L,className:"px-4 py-2 text-sm bg-primary text-primary-foreground rounded hover:bg-primary/90 focus:outline-none focus:ring-1 focus:ring-ring disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:T?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Regenerating..."]}):"Regenerate"})]})]})]})}):null}function Jn({file:t,onExpand:n,isExpanded:r,isRegenerating:a,isReplacing:o,isProcessing:i,onRegenerate:b,onReplace:w,onRename:k,onRegenerateMeta:L,formatDate:g,getSourceChipColor:u,isSmallScreen:h=!1,mobileTranscriptRowRefs:D}){var y;const[$,T]=d.useState(!1),B=((y=t.name.split("/").pop())==null?void 0:y.split("\\").pop())||t.name,R=U=>{U.stopPropagation(),T(!0)},E=async(U,q)=>{await b({stopPropagation:()=>{}},U,q)};if(h){const U=e.jsxs("div",{className:"w-full bg-background py-4 px-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1 mr-2 min-w-0 text-left",id:"ref",ref:q=>{D.current[t.base_name]=q},children:[e.jsx("h3",{className:"font-medium text-base break-all overflow-hidden text-left",title:t.name,children:B}),t.source&&e.jsx("div",{className:"text-left",children:e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium mt-2 ${u(t.source)}`,children:t.source})})]}),e.jsxs(He,{modal:!1,children:[e.jsx(ze,{asChild:!0,children:e.jsx("button",{onClick:q=>q.stopPropagation(),className:"p-2 text-muted-foreground hover:text-primary hover:bg-accent rounded-md transition-colors",title:"Actions",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})}),e.jsxs(We,{align:"end",children:[e.jsxs(we,{onClick:q=>k(q),disabled:i||a||o,children:[e.jsx("span",{children:"Rename"}),e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]}),t.transcript&&e.jsxs(we,{onClick:q=>w(q),disabled:o,className:"text-blue-600 hover:text-blue-700",children:[e.jsx("span",{children:"Edit transcript"}),!o&&e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})]}),t.transcript&&e.jsxs(we,{onClick:R,disabled:a,className:"text-green-600 hover:text-green-700",children:[e.jsx("span",{children:"Regenerate transcript"}),a?e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]}),i&&e.jsxs(we,{disabled:!0,children:[e.jsx("span",{children:"Processing transcript..."}),e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]})]})]})]}),e.jsx("div",{className:"space-y-3 mb-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"min-w-0 text-left",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Date:"}),e.jsx("div",{className:"font-medium break-words text-xs",children:g(t.created_at)})]}),e.jsxs("div",{className:"min-w-0 text-left",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Last Generated:"}),e.jsx("div",{className:"font-medium break-words text-xs",children:g(t.last_generated||"")})]}),e.jsxs("div",{className:"min-w-0 text-left",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Lines:"}),e.jsx("div",{className:"font-medium text-xs",children:t.line_count||0})]}),e.jsxs("div",{className:"min-w-0 text-left",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Length:"}),e.jsx("div",{className:"font-medium flex items-center gap-1 text-xs",children:t.length?t.length:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"-"}),e.jsx("button",{onClick:q=>L(q),disabled:a,className:"p-1 text-muted-foreground hover:text-primary hover:bg-accent rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate video length",children:a?e.jsx("svg",{className:"w-3 h-3 animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})})]})]})}),t.transcript&&e.jsx("button",{onClick:n,className:"w-full px-4 py-2 text-sm font-medium text-primary-foreground bg-primary hover:bg-primary/90 rounded-md transition-colors flex items-center justify-center gap-2",children:r?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Hide Transcript"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Show Transcript"]})})]});return e.jsxs(e.Fragment,{children:[U,e.jsx(Dt,{isOpen:$,videoPath:t.full_path||t.name,source:t.source,onClose:()=>T(!1),onRegenerate:E})]})}const I=e.jsxs(jt,{className:"w-full",children:[e.jsx(en,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 mr-2 min-w-0",children:[e.jsx("h3",{className:"font-medium text-base break-all overflow-hidden",title:t.name,children:B}),t.source&&e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium mt-2 ${u(t.source)}`,children:t.source})]}),e.jsxs(He,{modal:!1,children:[e.jsx(ze,{asChild:!0,children:e.jsx("button",{onClick:U=>U.stopPropagation(),className:"p-2 text-muted-foreground hover:text-primary hover:bg-accent rounded-md transition-colors",title:"Actions",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})}),e.jsxs(We,{align:"end",children:[e.jsxs(we,{onClick:U=>k(U),disabled:i||a||o,children:[e.jsx("span",{children:"Rename"}),e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]}),t.transcript&&e.jsxs(we,{onClick:U=>w(U),disabled:o,className:"text-blue-600 hover:text-blue-700",children:[e.jsx("span",{children:"Edit transcript"}),!o&&e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})]}),t.transcript&&e.jsxs(we,{onClick:R,disabled:a,className:"text-green-600 hover:text-green-700",children:[e.jsx("span",{children:"Regenerate transcript"}),a?e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]}),i&&e.jsxs(we,{disabled:!0,children:[e.jsx("span",{children:"Processing transcript..."}),e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]})]})]})]})}),e.jsx(yt,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-muted-foreground",children:"Date:"}),e.jsx("div",{className:"font-medium break-words",children:g(t.created_at)})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Generated:"}),e.jsx("div",{className:"font-medium break-words",children:g(t.last_generated||"")})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-muted-foreground",children:"Lines:"}),e.jsx("div",{className:"font-medium",children:t.line_count||0})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-muted-foreground",children:"Length:"}),e.jsx("div",{className:"font-medium flex items-center justify-center gap-1",children:t.length?t.length:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"-"}),e.jsx("button",{onClick:U=>L(U),disabled:a,className:"p-1 text-muted-foreground hover:text-primary hover:bg-accent rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate video length",children:a?e.jsx("svg",{className:"w-3 h-3 animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})})]})]})}),t.transcript&&e.jsx(tn,{className:"pt-3",children:e.jsx("button",{onClick:n,className:"w-full px-4 py-2 text-sm font-medium text-primary-foreground bg-primary hover:bg-primary/90 rounded-md transition-colors flex items-center justify-center gap-2",children:r?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Hide Transcript"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Show Transcript"]})})})]});return e.jsxs(e.Fragment,{children:[I,e.jsx(Dt,{isOpen:$,videoPath:t.full_path||t.name,source:t.source,onClose:()=>T(!1),onRegenerate:E})]})}function Kn({sortedFiles:t,activeSearchTerm:n,searchResults:r,showAllFiles:a,transcriptData:o,expandedFiles:i,searchLineNumbers:b,onExpandFile:w,onRegenerate:k,onReplace:L,onRename:g,onFetchTranscript:u,onSetRightPaneUrl:h,formatDate:D,getSourceChipColor:$,expandContext:T,clipStart:B,clipEnd:R,clipTranscript:E,onSetClipStart:I,onSetClipEnd:y,onClearClip:U,onClipBlock:q,mobileTranscriptRowRefs:m}){return e.jsx("div",{className:"divide-y divide-border",children:t.map(x=>{if(!(n?r.includes(x.full_path):a))return null;const W=o[x.full_path]||{text:"",loading:!1,error:null},j=i.has(x.full_path);return e.jsxs("div",{className:"w-full",children:[e.jsx("div",{id:"ref",children:e.jsx(Jn,{file:x,onExpand:()=>w(x.full_path),isExpanded:j,isRegenerating:!x.transcript,isReplacing:!x.transcript,isProcessing:!1,onRegenerate:_=>k(x.full_path,x.source,_),onReplace:_=>L(x.full_path,_),onRename:_=>g(x.full_path,_),onRegenerateMeta:_=>k(x.full_path,x.source,_),formatDate:D,getSourceChipColor:$,isSmallScreen:!0,mobileTranscriptRowRefs:m})}),j&&e.jsx(Zt,{visible:!0,name:x.base_name,fullPath:x.full_path,className:"w-full",searchTerm:n,text:W.text,loading:W.loading,error:W.error,visibleLines:b[x.full_path]||[],expandContext:T,onEditSuccess:()=>{u(x.full_path)},isSmallScreen:!0,onSetRightPaneUrl:h,clipStart:B,clipEnd:R,clipTranscript:E,onSetClipStart:_=>I(_,x.full_path),onSetClipEnd:_=>y(_,x.full_path),onClearClip:U,onClipBlock:q})]},x.base_name)})})}function Zn({watchDirectory:t,isSmallScreen:n,activeSearchTerm:r,searchLineNumbers:a,setSearchLineNumbers:o,expandedFiles:i,setExpandedFiles:b,transcriptData:w,setTranscriptData:k,currentProcessingFile:L,showAllFiles:g,leftPaneWidth:u,setLeftPaneWidth:h,isLeftPaneWidthMeasured:D,setIsLeftPaneWidthMeasured:$,clipStart:T,clipEnd:B,clipTranscript:R,fileRowRefs:E,transcriptRowRefs:I,mobileTranscriptRowRefs:y,leftPaneRef:U,onSetRightPaneUrl:q,onSetClipStart:m,onSetClipEnd:x,onClearClip:F,onClipBlock:W}){var It;const{files:j,refreshFiles:_,selectedWatchDirs:c,setSelectedWatchDirs:H,availableWatchDirs:S,selectedSources:Y,setSelectedSources:M,availableSources:re,page:Z,setPage:xe,pageSize:ae,setPageSize:ge,sortColumn:ce,setSortColumn:Ne,sortDirection:ue,setSortDirection:Pe,totalPages:le,totalRecords:Me}=Jt(),[Se,Ce]=d.useState(!1),[se,N]=d.useState(!1),[p,l]=d.useState(""),[V,X]=d.useState(""),[de,ie]=d.useState(!1),[Be,te]=d.useState(!1),[Le,Ae]=d.useState(""),[_e,Je]=d.useState(""),[Ue,st]=d.useState(!1),[Ve,$e]=d.useState(""),[it,tt]=d.useState(!1),[at,Ye]=d.useState(""),[Te,Xe]=d.useState(void 0),Ge=s=>{var v;return L?((v=L.video_path.split("/").pop())==null?void 0:v.replace(/\.(mp4|MP4)$/,""))===s:!1},ve=Object.keys(a).filter(s=>a[s]&&a[s].length>0),Ie=n||D&&u<753;d.useEffect(()=>{if(!U.current)return;const s=new ResizeObserver(C=>{for(const v of C)h(v.contentRect.width),$(!0)});return s.observe(U.current),()=>{s.disconnect()}},[h,$]),d.useEffect(()=>{je()},[i]);const Qe=[...j].sort((s,C)=>{let v,P;switch(ce){case"created_at":v=s.created_at||"",P=C.created_at||"";break;case"last_generated":v=s.last_generated||"",P=C.last_generated||"";break;case"name":v=s.name||"",P=C.name||"";break;case"line_count":v=s.line_count||0,P=C.line_count||0;break;case"length":v=s.length||"0:00",P=C.length||"0:00";break;case"source":v=s.source||"",P=C.source||"";break;default:return 0}if(ce==="created_at"||ce==="last_generated"){const O=new Date(v.replace(" ","T")).getTime(),K=new Date(P.replace(" ","T")).getTime();return ue==="asc"?O-K:K-O}return typeof v=="string"&&typeof P=="string"?ue==="asc"?v.localeCompare(P):P.localeCompare(v):ue==="asc"?v-P:P-v}),z=(s,C,v)=>{const P=a[s];if(!P)return;const O=[...P];if(C==="up")for(let K=1;K<=16;K++){const G=v-K;G>0&&!O.includes(G)&&O.push(G)}else for(let K=1;K<=16;K++){const G=v+K;O.includes(G)||O.push(G)}o(K=>({...K,[s]:O}))},ee=s=>{ce===s?Pe(C=>C==="asc"?"desc":"asc"):(Ne(s),Pe("asc"))},ne=s=>ce!==s?e.jsx("svg",{className:"w-4 h-4 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):ue==="asc"?e.jsx("svg",{className:"w-4 h-4 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):e.jsx("svg",{className:"w-4 h-4 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),J=s=>{if(!s)return"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300";const C={tiny:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",base:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",small:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",medium:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",large:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",subtitles:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-200",manual:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200"};for(const[v,P]of Object.entries(C))if(s.includes(v))return P;return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"},oe=(s,C=!0)=>{if(!s||s==="N/A")return"N/A";try{const v=new Date(s.replace(" ","T"));if(isNaN(v.getTime()))return"N/A";const P=(v.getMonth()+1).toString().padStart(2,"0"),O=v.getDate().toString().padStart(2,"0"),K=v.getFullYear();if(!C)return`${P}-${O}-${K}`;let G=v.getHours();const qe=v.getMinutes().toString().padStart(2,"0"),ct=G>=12?"pm":"am";return G=G%12,G=G||12,`${P}-${O}-${K} ${G}:${qe}${ct}`}catch{return"N/A"}},fe=async s=>{k(C=>({...C,[s]:{text:"",loading:!0,error:null}}));try{const C=await fetch(Fe(`/api/transcripts?video_path=${encodeURIComponent(s)}`));if(!C.ok)throw new Error(`Failed to fetch transcript: ${C.status} ${C.statusText}`);const v=await C.json();if(v.success){const P=v.data;k(O=>({...O,[s]:{text:P,loading:!1,error:null}}))}else throw new Error(`Failed to fetch transcript: ${v.error}`)}catch(C){k(v=>({...v,[s]:{text:"",loading:!1,error:C instanceof Error?C.message:"An unknown error occurred"}}))}},je=async()=>{const C=Array.from(i).filter(v=>{const P=w[v];return!P||!P.loading&&!P.text&&!P.error});await Promise.all(C.map(v=>fe(v)))},A=(s,C,v)=>{v.stopPropagation(),Ye(s),Xe(C),tt(!0)},Q=async(s,C)=>{await he(at,{stopPropagation:()=>{}},s,C)},he=async(s,C,v,P)=>{var K;C.stopPropagation();const O=(K=document.querySelector('meta[name="csrf-token"]'))==null?void 0:K.getAttribute("content");try{const G={video_path:s};v&&(G.model=v),P!==void 0&&(G.subtitle_stream_index=P);const qe=await fetch(Fe("/api/transcripts/regenerate"),{method:"POST",headers:{"X-CSRF-Token":O||"","Content-Type":"application/json"},body:JSON.stringify(G)});if(qe.ok)await _();else{const ct=await qe.json().catch(()=>({error:"Unknown error"}));console.error("Failed to regenerate transcript:",ct.error),alert(`Failed to regenerate transcript: ${ct.error}`)}}catch(G){console.error("Regeneration error:",G),alert("Error regenerating transcript. Please try again.")}},Re=async(s,C)=>{C.stopPropagation();try{const v=await fetch(Fe(`/api/transcripts?video_path=${encodeURIComponent(s)}`));if(v.ok){const P=await v.json();if(P.success){const O=P.data;l(s),X(O),N(!0)}else throw new Error(P.error)}else throw new Error("Failed to fetch transcript")}catch(v){console.error("Error fetching transcript for replacement:",v),alert("Error loading transcript. Please try again.")}finally{}},Ee=async s=>{var C;ie(!0);try{const v=(C=document.querySelector('meta[name="csrf-token"]'))==null?void 0:C.getAttribute("content"),P=await fetch(Fe("/api/transcripts/replace"),{method:"POST",headers:{"X-CSRF-Token":v||"","Content-Type":"application/json"},body:JSON.stringify({video_path:p,new_content:s})});if(P.ok)N(!1),l(""),X(""),i.has(p)&&await fe(p),await _();else{const O=await P.json().catch(()=>({error:"Unknown error"}));console.error("Failed to replace transcript:",O.error),alert(`Failed to replace transcript: ${O.error}`)}}catch(v){console.error("Replace transcript error:",v),alert("Error replacing transcript. Please try again.")}finally{ie(!1)}},ye=()=>{N(!1),l(""),X("")},De=async(s,C)=>{var P;C.stopPropagation();const v=((P=s.split("/").pop())==null?void 0:P.split("\\").pop())||s;Ae(s),Je(v),$e(""),te(!0),setTimeout(()=>{const O=document.getElementById("new-filename");O&&O.select()},100)},pt=async()=>{var C,v;if(!_e.trim()){$e("Filename cannot be empty");return}const s=((C=Le.split("/").pop())==null?void 0:C.split("\\").pop())||Le;if(_e===s){$e("New filename must be different from current filename");return}if(/[\/\\]/.test(_e)){$e("Filename cannot contain path separators");return}st(!0),$e("");try{const P=(v=document.querySelector('meta[name="csrf-token"]'))==null?void 0:v.getAttribute("content"),O=Le.split("/");O[O.length-1]=_e.trim();const K=O.join("/"),G=await fetch(Fe("/api/transcripts/rename"),{method:"POST",headers:{"X-CSRF-Token":P||"","Content-Type":"application/json"},body:JSON.stringify({video_path:Le,new_path:K})});if(!G.ok){const qe=await G.json();throw new Error(qe.error||`Failed to rename file: ${G.status} ${G.statusText}`)}te(!1),Ae(""),Je(""),await _()}catch(P){console.error("Error renaming file:",P),$e(P instanceof Error?P.message:"An error occurred while renaming the file")}finally{st(!1)}},xt=()=>{te(!1),Ae(""),Je(""),$e("")},pn=s=>{H(C=>C.includes(s)?C.filter(P=>P!==s):[...C,s])},xn=()=>{H(S)},gn=()=>{H([])},vn=s=>{M(C=>C.includes(s)?C.filter(P=>P!==s):[...C,s])},bn=()=>{M(re)},wn=()=>{M([])},lt=s=>{xe(s)},jn=s=>{ge(s),xe(0)},yn=({className:s=""})=>{if(!g||le<=1)return null;const C=Z*ae+1,v=Math.min((Z+1)*ae,Me);return e.jsxs("div",{className:`flex flex-col sm:flex-row items-center gap-2 sm:gap-4 p-4 border-t border-border bg-background ${s}`,children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{className:"hidden sm:inline",children:"Show"}),e.jsxs("select",{value:ae,onChange:P=>jn(Number(P.target.value)),className:"border border-border rounded px-2 py-1 bg-background text-xs sm:text-sm",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]}),e.jsx("span",{className:"hidden sm:inline",children:"per page"})]}),e.jsx("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-muted-foreground",children:e.jsxs("span",{children:[C,"-",v," of ",Me]})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("button",{onClick:()=>lt(0),disabled:Z===0,className:"px-2 sm:px-3 py-1 text-xs sm:text-sm border border-border rounded hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"hidden sm:inline",children:"First"}),e.jsx("span",{className:"sm:hidden",children:"«"})]}),e.jsxs("button",{onClick:()=>lt(Z-1),disabled:Z===0,className:"px-2 sm:px-3 py-1 text-xs sm:text-sm border border-border rounded hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"hidden sm:inline",children:"Previous"}),e.jsx("span",{className:"sm:hidden",children:"‹"})]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(Ie?3:5,le)},(P,O)=>{let K;const G=Ie?3:5;return le<=G||Z<Math.floor(G/2)?K=O:Z>=le-Math.floor(G/2)?K=le-G+O:K=Z-Math.floor(G/2)+O,e.jsx("button",{onClick:()=>lt(K),className:`px-2 sm:px-3 py-1 text-xs sm:text-sm border border-border rounded hover:bg-accent min-w-0 ${K===Z?"bg-primary text-primary-foreground":""}`,children:K+1},K)})}),e.jsxs("button",{onClick:()=>lt(Z+1),disabled:Z>=le-1,className:"px-2 sm:px-3 py-1 text-xs sm:text-sm border border-border rounded hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"hidden sm:inline",children:"Next"}),e.jsx("span",{className:"sm:hidden",children:"›"})]}),e.jsxs("button",{onClick:()=>lt(le-1),disabled:Z>=le-1,className:"px-2 sm:px-3 py-1 text-xs sm:text-sm border border-border rounded hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"hidden sm:inline",children:"Last"}),e.jsx("span",{className:"sm:hidden",children:"»"})]})]})]})},kn=s=>{b(C=>{const v=new Set(C);return v.has(s)?v.delete(s):v.add(s),v})},Nn=async()=>{var K;const s=Qe.filter(G=>r&&!ve.includes(G.full_path)?!1:G.transcript);if(s.length===0){alert("No files with transcripts to regenerate");return}const C=Y[0],v=s.length,P=`Regenerate ${v} file${v===1?"":"s"} using "${C}" source?`;if(!confirm(P))return;Ce(!0);const O=(K=document.querySelector('meta[name="csrf-token"]'))==null?void 0:K.getAttribute("content");try{let G=0,qe=0;(await Promise.allSettled(s.map(async ot=>{const At=await fetch(Fe("/api/transcripts/regenerate"),{method:"POST",headers:{"X-CSRF-Token":O||"","Content-Type":"application/json"},body:JSON.stringify({video_path:ot.full_path})});if(!At.ok){const Cn=await At.json().catch(()=>({error:"Unknown error"}));throw new Error(`${ot.full_path}: ${Cn.error}`)}return ot.full_path}))).forEach(ot=>{ot.status==="fulfilled"?G++:(qe++,console.error("Bulk regeneration error:",ot.reason))}),qe>0?alert(`Bulk regeneration completed with ${G} successes and ${qe} errors. Check console for details.`):alert(`Successfully queued ${G} files for regeneration`)}catch(G){console.error("Bulk regeneration error:",G),alert("Error during bulk regeneration. Please try again.")}finally{Ce(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:U,className:`${`w-full overflow-y-auto scrollbar-hide px-2 sm:px-4 ${t?n?"pt-24 pb-4":"pt-16 pb-4":"py-10"}`}`,children:[(S.length>1||re.length>1)&&e.jsxs("div",{className:`mb-6 flex items-center gap-4 ${Ie?"px-4":""}`,children:[S.length>1&&e.jsxs(He,{modal:!1,children:[e.jsx(ze,{asChild:!0,children:e.jsxs("button",{className:"inline-flex items-center justify-center whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[c.length===S.length||c.length===0?"All Directories":`${c.length} Director${c.length===1?"y":"ies"}`,e.jsx("svg",{className:"ml-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsxs(We,{align:"start",className:"w-80",children:[e.jsx(wt,{children:"Watch Directories"}),e.jsx(Ze,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 p-2",children:[e.jsx(et,{checked:c.length===S.length,onCheckedChange:s=>{s?xn():gn()},className:"font-medium",children:"Select All"}),e.jsx(Ze,{}),S.map(s=>e.jsx(et,{checked:c.includes(s),onCheckedChange:()=>pn(s),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"font-medium text-sm",children:s.split("/").pop()||s}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s})]})},s))]})]})]}),re.length>1&&e.jsxs(He,{modal:!1,children:[e.jsx(ze,{asChild:!0,children:e.jsxs("button",{className:"inline-flex items-center justify-center whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[Y.length===re.length||Y.length===0?"All Transcript Sources":`${Y.length} Source${Y.length===1?"":"s"}`,e.jsx("svg",{className:"ml-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsxs(We,{align:"start",className:"w-80",children:[e.jsx(wt,{children:"Sources"}),e.jsx(Ze,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 p-2",children:[e.jsx(et,{checked:Y.length===re.length,onCheckedChange:s=>{s?bn():wn()},className:"font-medium",children:"Select All"}),e.jsx(Ze,{}),re.map(s=>e.jsx(et,{checked:Y.includes(s),onCheckedChange:()=>vn(s),children:e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${J(s)}`,children:s})})},s))]})]})]})]}),Y.length===1&&e.jsxs("div",{className:`mb-6 flex items-center justify-between ${Ie?"px-4":""}`,children:[e.jsx("button",{onClick:Nn,disabled:Se,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:Se?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2 animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Regenerating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Regenerate All (",Y[0],")"]})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:(()=>{const s=Qe.filter(C=>r&&!ve.includes(C.full_path)?!1:C.transcript);return`${s.length} file${s.length===1?"":"s"} with transcripts`})()})]}),e.jsxs("div",{children:[ve.length>0&&e.jsx("div",{className:`mb-6 p-4 bg-accent/10 border border-accent/20 rounded-md ${Ie?"mx-4":""}`,children:e.jsxs("h3",{className:"text-sm font-medium text-accent-foreground mb-2",children:["Found in ",ve.length," file(s)"]})}),r&&ve.length===0&&e.jsx("div",{className:`mb-6 p-4 bg-muted border border-border rounded-md ${Ie?"mx-4":""}`,children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:['No files found containing "',r,'"']})}),!r&&!g&&e.jsx("div",{className:`mb-6 p-4 bg-muted border border-border rounded-md ${Ie?"mx-4":""}`,children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Search to get started!"})}),!n&&!D?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading..."})}):Ie?e.jsx(Kn,{sortedFiles:Qe,activeSearchTerm:r,searchResults:ve,showAllFiles:g,transcriptData:w,expandedFiles:i,searchLineNumbers:a,onExpandFile:s=>{const C=Qe.find(v=>v.full_path===s);C!=null&&C.transcript&&kn(s)},onRegenerate:A,onReplace:Re,onRename:De,onFetchTranscript:fe,onSetRightPaneUrl:q,formatDate:s=>oe(s,u>=1129),getSourceChipColor:J,expandContext:z,clipStart:T,clipEnd:B,clipTranscript:R,onSetClipStart:m,onSetClipEnd:x,onClearClip:F,onClipBlock:W,mobileTranscriptRowRefs:y}):e.jsxs(On,{className:"table-fixed w-full",children:[e.jsx(Pn,{children:e.jsxs(kt,{children:[e.jsxs(nt,{className:"text-center w-[34%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>ee("name"),children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Filename",ne("name")]}),r&&ve.length>0&&e.jsx("span",{className:"text-xs text-primary ml-2",children:"(Search Results)"})]}),e.jsx(nt,{className:"text-center w-[14%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>ee("created_at"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Date",ne("created_at")]})}),e.jsx(nt,{className:"text-center w-[14%] pl-6 cursor-pointer hover:bg-accent transition-colors",onClick:()=>ee("last_generated"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Generated",ne("last_generated")]})}),e.jsx(nt,{className:"text-center w-[10%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>ee("line_count"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Lines",ne("line_count")]})}),e.jsx(nt,{className:"text-center w-[10%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>ee("length"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Length",ne("length")]})}),e.jsx(nt,{className:"text-center w-[8%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>ee("source"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Source",ne("source")]})}),e.jsx(nt,{className:"text-center w-[10%]",children:"Actions"})]})}),e.jsx(Bn,{children:Qe.map(s=>{var P;if(!(r?ve.includes(s.full_path):g))return e.jsx(e.Fragment,{});const v=w[s.full_path]||{text:"",loading:!1,error:null};return e.jsxs(e.Fragment,{children:[e.jsxs(kt,{ref:O=>{E.current[s.full_path]=O},"data-filename":s.full_path,className:"",onClick:()=>{s.transcript&&b(O=>{const K=new Set(O);return K.has(s.full_path)?K.delete(s.full_path):K.add(s.full_path),K})},children:[e.jsx(Ke,{className:"font-medium w-[34%] max-w-0",children:e.jsx("div",{className:"leading-tight overflow-hidden whitespace-nowrap text-ellipsis",style:{direction:"rtl",textAlign:"left",unicodeBidi:"plaintext",fontSize:(()=>{var G;const K=(((G=s.name.split("/").pop())==null?void 0:G.split("\\").pop())||s.name).length;return K<=15?"14px":K<=20?"13px":"12px"})()},title:s.name,children:((P=s.name.split("/").pop())==null?void 0:P.split("\\").pop())||s.name})}),e.jsx(Ke,{className:"w-[14%] pr-10 text-foreground",children:oe(s.created_at,u>=1129)}),e.jsx(Ke,{className:"w-[14%] text-center text-foreground",children:oe(s.last_generated||"",u>=1129)}),e.jsx(Ke,{className:"w-[10%] text-foreground",children:s.line_count||0}),e.jsx(Ke,{className:"w-[10%] text-foreground",children:s.length?s.length:e.jsx("button",{onClick:O=>he(s.full_path,O),disabled:!s.transcript,className:"p-1 text-muted-foreground hover:text-primary hover:bg-accent rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate video length",children:s.transcript?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-4 h-4 animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),e.jsx(Ke,{className:"w-[8%] text-center",children:s.source?u>=1129?e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{className:`inline-flex items-center rounded-full font-medium ${J(s.source)} ${s.source.length>10?"px-1.5 py-0.5 text-xs scale-75":"px-2.5 py-0.5 text-xs"}`,children:s.source})}):e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`w-3 h-3 rounded-full ${J(s.source).split(" ").find(O=>O.startsWith("bg-"))||"bg-gray-200"} ${J(s.source).split(" ").find(O=>O.startsWith("dark:bg-"))||""}`,title:s.source})}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(Ke,{className:"w-[10%] text-center p-2",children:e.jsxs(He,{modal:!1,children:[e.jsx(ze,{asChild:!0,children:e.jsx("button",{onClick:O=>O.stopPropagation(),className:"p-2 text-muted-foreground hover:text-primary hover:bg-accent rounded-md transition-colors",title:"Actions",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})}),e.jsxs(We,{align:"end",children:[e.jsxs(we,{onClick:O=>De(s.full_path,O),disabled:!s.transcript,children:[e.jsx("span",{children:"Rename"}),e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]}),s.transcript&&e.jsxs(we,{onClick:O=>Re(s.full_path,O),disabled:!s.transcript,className:"text-blue-600 hover:text-blue-700",children:[e.jsx("span",{children:"Edit transcript"}),!s.transcript&&e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})]}),s.transcript&&e.jsxs(we,{onClick:O=>A(s.full_path,s.source,O),disabled:!s.transcript,className:"text-green-600 hover:text-green-700",children:[e.jsx("span",{children:"Regenerate transcript"}),s.transcript?e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]}),Ge(s.full_path)&&e.jsxs(we,{disabled:!0,children:[e.jsx("span",{children:"Processing transcript..."}),e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]})]})]})})]},s.full_path),e.jsx(kt,{ref:O=>{I.current[s.full_path]=O},"data-filename":s.full_path,children:e.jsx(Ke,{colSpan:7,className:"p-0",children:e.jsx(Zt,{visible:i.has(s.full_path),name:s.base_name,fullPath:s.full_path,className:"w-full",searchTerm:r,text:v.text,loading:v.loading,error:v.error,visibleLines:a[s.full_path]||[],expandContext:z,onEditSuccess:()=>{fe(s.full_path)},onSetRightPaneUrl:q,clipStart:T,clipEnd:B,clipTranscript:R,onSetClipStart:O=>m(O,s.full_path),onSetClipEnd:O=>x(O,s.full_path),onClearClip:F,onClipBlock:W})})})]})})})]})]}),e.jsx(yn,{})]}),e.jsx(Tt,{isOpen:se,filename:p,transcriptInitialValue:V,onTranscriptSave:Ee,onCancel:ye,isTranscriptSubmitting:de}),Be&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background border border-border rounded-lg p-6 w-96 max-w-90vw",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Rename File"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:['Renaming "',((It=Le.split("/").pop())==null?void 0:It.split("\\").pop())||Le,'" (this will rename the video, transcript, and meta files)']}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"new-filename",className:"block text-sm font-medium mb-2",children:"New filename (without extension):"}),e.jsx("input",{id:"new-filename",type:"text",value:_e,onChange:s=>Je(s.target.value),onKeyDown:s=>{s.key==="Enter"&&!Ue&&_e.trim()?pt():s.key==="Escape"&&xt()},className:"w-full px-3 py-2 border border-input bg-background text-foreground rounded focus:outline-none focus:ring-1 focus:ring-ring focus:border-transparent",placeholder:"Enter new filename",disabled:Ue,autoFocus:!0})]}),Ve&&e.jsx("div",{className:"text-sm text-destructive",children:Ve}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:xt,className:"px-4 py-2 text-sm border border-input bg-background text-foreground rounded hover:bg-accent focus:outline-none focus:ring-1 focus:ring-ring",disabled:Ue,children:"Cancel"}),e.jsx("button",{onClick:pt,className:"px-4 py-2 text-sm bg-primary text-primary-foreground rounded hover:bg-primary/90 focus:outline-none focus:ring-1 focus:ring-ring disabled:opacity-50 disabled:cursor-not-allowed",disabled:Ue||!_e.trim(),children:Ue?"Renaming...":"Rename"})]})]})]})}),e.jsx(Dt,{isOpen:it,videoPath:at,source:Te,onClose:()=>tt(!1),onRegenerate:Q})]})}function er(){return e.jsx("div",{className:"w-full h-full flex items-center justify-center p-8 bg-background",children:e.jsxs("div",{className:"text-center text-foreground",children:[e.jsx("div",{className:"mb-6",children:e.jsx("svg",{className:"w-16 h-16 mx-auto text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),e.jsx("h3",{className:"text-xl font-medium mb-3 text-foreground",children:"Clip Editor"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Click on any timestamp in a transcript to open the clip editor and create video clips from specific moments."})]})})}const bt=d.forwardRef(({className:t,type:n,...r},a)=>e.jsx("input",{type:n,className:Oe("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...r}));bt.displayName="Input";const nn=d.forwardRef(({className:t,...n},r)=>e.jsx("textarea",{className:Oe("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n}));nn.displayName="Textarea";function tr({className:t,...n}){return e.jsx(Rn,{"data-slot":"checkbox",className:Oe("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:e.jsx(En,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(Fn,{className:"size-3.5"})})})}const Ut=({buttons:t})=>{const n=t.reduce((a,o,i)=>{const b=o.group??0;return a[b]||(a[b]=[]),a[b].push({...o,originalIndex:i}),a},{}),r=Object.keys(n).map(Number).sort((a,o)=>a-o);return e.jsx("div",{className:"mt-2 space-y-3",children:r.map(a=>e.jsx("div",{className:"flex items-center gap-2 justify-center flex-wrap",children:n[a].map(o=>e.jsx(pe,{variant:"outline",size:"sm",onClick:o.onClick,className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:o.color?{borderColor:o.color,color:o.color}:void 0,children:o.text},o.originalIndex))},a))})},dt=({filename:t,clip_url:n,start_time_formatted:r="00:00:00.000",end_time_formatted:a="00:00:10.000",font_size:o="",text:i="",display_text:b=!1,onBack:w,onStartTimeChange:k,onEndTimeChange:L})=>{const[g,u]=d.useState(r),[h,D]=d.useState(a),[$,T]=d.useState(o),[B,R]=d.useState(i),[E,I]=d.useState(b),[y,U]=d.useState(!1),[q,m]=d.useState(n||""),[x,F]=d.useState(!1),[W,j]=d.useState(!1),[_]=d.useState(t),[c,H]=d.useState({}),[S,Y]=d.useState("video"),M=d.useRef(null),re=d.useRef(null),Z=N=>{const p=N.split(":"),l=parseInt(p[0],10),V=parseInt(p[1],10),X=parseFloat(p[2]);return l*3600+V*60+X},xe=N=>{N=Math.max(0,N);const p=Math.floor(N/3600),l=Math.floor(N%3600/60),V=N%60;return`${p.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}:${V.toFixed(3).padStart(6,"0")}`},ae=N=>/^(\d{2}):(\d{2}):(\d{2})\.(\d{3})$/.test(N),ge=(N="mp4")=>{if(!g||!h||!ae(g)||!ae(h))return"";const p=Z(g),l=Z(h);if(p<0||l<=p)return"";const V=new URLSearchParams({filename:t,start_time:p.toString(),end_time:l.toString(),format:N,cachebuster:Date.now().toString()});return B&&B.trim()!==""&&V.set("text",B),$&&$.trim()!==""&&V.set("font_size",$),E&&V.set("display_text","true"),"/api/clip?"+V.toString()},ce=N=>{let p=`${_}_clip_start_${g}_end_${h}.${N}`;if(B&&B.trim()!==""){const l=B.trim().substring(0,50).replace(/[^a-zA-Z0-9\s\-_]/g,"").replace(/\s+/g,"_");l&&(p=l+`.${N}`)}return p},Ne=async N=>{const p=ge(N),l=ce(N);H(V=>({...V,[N]:!0}));try{const V=await fetch(p);if(!V.ok)throw new Error(`Failed to download file: ${V.statusText}`);const X=await V.blob(),de={mp4:"video/mp4",gif:"image/gif",mp3:"audio/mpeg"},ie=new File([X],l,{type:de[N]||"application/octet-stream"});await navigator.share({files:[ie]})}catch(V){console.error("Error sharing:",V);try{await navigator.share({title:`Clip from ${l}`,url:window.location.origin+p})}catch(X){console.error("Error with fallback sharing:",X)}}finally{H(V=>({...V,[N]:!1}))}},ue=(N,p,l,V)=>{if(!ae(N))return;const de=Z(N)+p,ie=xe(de);l(ie),V&&V(de)},Pe=(N,p,l)=>[{text:"+1s",onClick:()=>ue(N,1,p,l),color:"#22c55e",group:0},{text:"+0.5s",onClick:()=>ue(N,.5,p,l),color:"#22c55e",group:0},{text:"+0.1s",onClick:()=>ue(N,.1,p,l),color:"#22c55e",group:0},{text:"+0.01s",onClick:()=>ue(N,.01,p,l),color:"#22c55e",group:0},{text:"-1s",onClick:()=>ue(N,-1,p,l),color:"#ef4444",group:1},{text:"-0.5s",onClick:()=>ue(N,-.5,p,l),color:"#ef4444",group:1},{text:"-0.1s",onClick:()=>ue(N,-.1,p,l),color:"#ef4444",group:1},{text:"-0.01s",onClick:()=>ue(N,-.01,p,l),color:"#ef4444",group:1}],le=()=>{if(!ae(g)||!ae(h))return;const N=Z(g),p=Z(h);if(N<0||p<=N)return;const l=ge(S==="video"?"mp4":"gif");l&&m(l)};d.useEffect(()=>{var N;q&&((N=M.current)==null||N.load())},[q]);const Me=()=>{re.current&&clearTimeout(re.current),re.current=setTimeout(le,500)},Se=()=>{U(!1),M.current&&window.scrollTo({top:0,behavior:"smooth"})},Ce=()=>{U(!1),window.scrollTo({top:0,behavior:"smooth"})},se=(N,p,l)=>{if(p(N),ae(N)&&l){const V=Z(N);l(V)}};return d.useEffect(()=>{T(o),R(i),I(b),m(n||"")},[o,i,b,n]),d.useEffect(()=>{u(r)},[r]),d.useEffect(()=>{D(a)},[a]),d.useEffect(()=>{ae(g)&&ae(h)&&le()},[g,h,S,B,$,E]),d.useEffect(()=>{j(typeof navigator.share=="function")},[]),d.useEffect(()=>(le(),()=>{re.current&&clearTimeout(re.current)}),[t,r,a]),e.jsxs("div",{className:"container max-w-6xl mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t}),w&&e.jsxs("button",{onClick:w,className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(Hn,{className:"h-4 w-4"}),"Close"]})]}),e.jsx("div",{className:"text-center mb-4",children:e.jsxs("div",{className:"text-lg font-medium text-muted-foreground",children:[g," to ",h]})}),e.jsx(jt,{className:"relative overflow-hidden bg-black",children:e.jsxs(yt,{className:"p-0",children:[y&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center min-h-[300px] bg-black/95 backdrop-blur-sm z-10",children:[e.jsx("div",{className:"w-12 h-12 border-3 border-muted border-t-primary rounded-full animate-spin mb-6"}),e.jsx("div",{className:"text-lg font-semibold text-primary-foreground mb-2",children:"Processing..."}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Generating your clip, please wait"})]}),q&&e.jsx(e.Fragment,{children:S==="video"?e.jsxs("video",{ref:M,controls:!0,autoPlay:!0,playsInline:!0,className:"w-full h-auto block",onLoadedData:Se,onError:Ce,children:[e.jsx("source",{src:q,type:"video/mp4"}),"Your browser does not support the video tag."]}):e.jsx("img",{src:q,alt:"Clip preview",className:"w-full h-auto block",onLoad:Se,onError:Ce})})]})}),e.jsx(jt,{children:e.jsxs(yt,{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-start",children:e.jsxs(pe,{onClick:le,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(zn,{className:"h-4 w-4"}),"Regenerate"]})}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"start_time",className:"text-sm font-medium",children:"Start Time (hh:mm:ss.sss)"}),e.jsx(bt,{id:"start_time",type:"text",value:g,onChange:N=>se(N.target.value,u,k),pattern:"^(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d{3})$",placeholder:"00:00:00.000",className:"font-mono text-xs tracking-wider",required:!0}),x&&e.jsx(Ut,{buttons:Pe(g,u,k)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"end_time",className:"text-sm font-medium",children:"End Time (hh:mm:ss.sss)"}),e.jsx(bt,{id:"end_time",type:"text",value:h,onChange:N=>se(N.target.value,D,L),pattern:"^(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d{3})$",placeholder:"00:00:00.000",className:"font-mono text-xs tracking-wider",required:!0}),x&&e.jsx(Ut,{buttons:Pe(h,D,L)})]})]})}),!x&&e.jsx("div",{className:"flex justify-center",children:e.jsxs(pe,{onClick:()=>F(!0),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(Wn,{className:"h-4 w-4"}),"Show Time Controls"]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Preview"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"preview",value:"video",checked:S==="video",onChange:N=>Y(N.target.value),className:"text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm",children:"Video"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"preview",value:"gif",checked:S==="gif",onChange:N=>Y(N.target.value),className:"text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm",children:"GIF"})]})]})]}),e.jsxs("div",{className:"space-y-2 text-left",children:[e.jsx("label",{htmlFor:"font_size",className:"text-sm font-medium",children:"Font Size"}),e.jsx(bt,{id:"font_size",type:"number",value:$,onChange:N=>{T(N.target.value),Me()},min:"10",max:"500",placeholder:"Auto",className:"w-20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"text",className:"text-sm font-medium",children:"Text Overlay"}),e.jsx(nn,{id:"text",value:B,onChange:N=>{R(N.target.value),Me()},placeholder:"Enter text to overlay on video",className:"min-h-[100px] resize-y"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(tr,{id:"display_text",checked:E,onCheckedChange:N=>{I(N),le()}}),e.jsx("label",{htmlFor:"display_text",className:"text-sm font-medium cursor-pointer",children:"Show Text Overlay"})]}),e.jsxs("div",{className:"pt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-1 justify-center flex-wrap",children:[e.jsx(pe,{asChild:!0,variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#22c55e",color:"#22c55e"},children:e.jsxs("a",{href:ge("mp4"),download:ce("mp4"),className:"inline-flex items-center gap-2",children:[e.jsx(Ct,{className:"w-3 h-3"}),"Download MP4"]})}),e.jsx(pe,{asChild:!0,variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#22c55e",color:"#22c55e"},children:e.jsxs("a",{href:ge("gif"),download:ce("gif"),className:"inline-flex items-center gap-2",children:[e.jsx(Ct,{className:"w-3 h-3"}),"Download GIF"]})}),e.jsx(pe,{asChild:!0,variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#22c55e",color:"#22c55e"},children:e.jsxs("a",{href:ge("mp3"),download:ce("mp3"),className:"inline-flex items-center gap-2",children:[e.jsx(Ct,{className:"w-3 h-3"}),"Download MP3"]})})]}),W&&e.jsxs("div",{className:"flex items-center gap-1 justify-center flex-wrap",children:[e.jsxs(pe,{onClick:()=>Ne("mp4"),variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#3b82f6",color:"#3b82f6"},disabled:c.mp4,children:[c.mp4?e.jsx("div",{className:"w-3 h-3 mr-1 border border-current border-t-transparent rounded-full animate-spin"}):e.jsx(St,{className:"w-3 h-3 mr-1"}),c.mp4?"Sharing...":"Share MP4"]}),e.jsxs(pe,{onClick:()=>Ne("gif"),variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#3b82f6",color:"#3b82f6"},disabled:c.gif,children:[c.gif?e.jsx("div",{className:"w-3 h-3 mr-1 border border-current border-t-transparent rounded-full animate-spin"}):e.jsx(St,{className:"w-3 h-3 mr-1"}),c.gif?"Sharing...":"Share GIF"]}),e.jsxs(pe,{onClick:()=>Ne("mp3"),variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#3b82f6",color:"#3b82f6"},disabled:c.mp3,children:[c.mp3?e.jsx("div",{className:"w-3 h-3 mr-1 border border-current border-t-transparent rounded-full animate-spin"}):e.jsx(St,{className:"w-3 h-3 mr-1"}),c.mp3?"Sharing...":"Share MP3"]})]})]})]})})]})};function nr(t){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}const rn=f.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldAnimate:{current:!0},shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),ft=()=>{const t=f.useContext(rn);if(!t)throw new Error("useDrawerContext must be used within a Drawer.Root");return t};nr(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--initial-transform,100%),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--initial-transform,100%),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-animate=false]{animation:none!important}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,var(--initial-transform,100%),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,var(--initial-transform,100%),0)}}@keyframes slideFromTop{from{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}}@keyframes slideFromLeft{from{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}}@keyframes slideFromRight{from{transform:translate3d(var(--initial-transform,100%),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(var(--initial-transform,100%),0,0)}}`);function rr(){const t=navigator.userAgent;return typeof window<"u"&&(/Firefox/.test(t)&&/Mobile/.test(t)||/FxiOS/.test(t))}function sr(){return Bt(/^Mac/)}function ar(){return Bt(/^iPhone/)}function Vt(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function or(){return Bt(/^iPad/)||sr()&&navigator.maxTouchPoints>1}function sn(){return ar()||or()}function Bt(t){return typeof window<"u"&&window.navigator!=null?t.test(window.navigator.platform):void 0}const ir=24,lr=typeof window<"u"?d.useLayoutEffect:d.useEffect;function qt(...t){return(...n)=>{for(let r of t)typeof r=="function"&&r(...n)}}const Rt=typeof document<"u"&&window.visualViewport;function Yt(t){let n=window.getComputedStyle(t);return/(auto|scroll)/.test(n.overflow+n.overflowX+n.overflowY)}function an(t){for(Yt(t)&&(t=t.parentElement);t&&!Yt(t);)t=t.parentElement;return t||document.scrollingElement||document.documentElement}const cr=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let gt=0,Et;function dr(t={}){let{isDisabled:n}=t;lr(()=>{if(!n)return gt++,gt===1&&sn()&&(Et=ur()),()=>{gt--,gt===0&&(Et==null||Et())}},[n])}function ur(){let t,n=0,r=u=>{t=an(u.target),!(t===document.documentElement&&t===document.body)&&(n=u.changedTouches[0].pageY)},a=u=>{if(!t||t===document.documentElement||t===document.body){u.preventDefault();return}let h=u.changedTouches[0].pageY,D=t.scrollTop,$=t.scrollHeight-t.clientHeight;$!==0&&((D<=0&&h>n||D>=$&&h<n)&&u.preventDefault(),n=h)},o=u=>{let h=u.target;Ot(h)&&h!==document.activeElement&&(u.preventDefault(),h.style.transform="translateY(-2000px)",h.focus(),requestAnimationFrame(()=>{h.style.transform=""}))},i=u=>{let h=u.target;Ot(h)&&(h.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{h.style.transform="",Rt&&(Rt.height<window.innerHeight?requestAnimationFrame(()=>{Xt(h)}):Rt.addEventListener("resize",()=>Xt(h),{once:!0}))}))},b=()=>{window.scrollTo(0,0)},w=window.pageXOffset,k=window.pageYOffset,L=qt(mr(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let g=qt(ut(document,"touchstart",r,{passive:!1,capture:!0}),ut(document,"touchmove",a,{passive:!1,capture:!0}),ut(document,"touchend",o,{passive:!1,capture:!0}),ut(document,"focus",i,!0),ut(window,"scroll",b));return()=>{L(),g(),window.scrollTo(w,k)}}function mr(t,n,r){let a=t.style[n];return t.style[n]=r,()=>{t.style[n]=a}}function ut(t,n,r,a){return t.addEventListener(n,r,a),()=>{t.removeEventListener(n,r,a)}}function Xt(t){let n=document.scrollingElement||document.documentElement;for(;t&&t!==n;){let r=an(t);if(r!==document.documentElement&&r!==document.body&&r!==t){let a=r.getBoundingClientRect().top,o=t.getBoundingClientRect().top,i=t.getBoundingClientRect().bottom;const b=r.getBoundingClientRect().bottom+ir;i>b&&(r.scrollTop+=o-a)}t=r.parentElement}}function Ot(t){return t instanceof HTMLInputElement&&!cr.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}function fr(t,n){typeof t=="function"?t(n):t!=null&&(t.current=n)}function hr(...t){return n=>t.forEach(r=>fr(r,n))}function on(...t){return d.useCallback(hr(...t),t)}const ln=new WeakMap;function ke(t,n,r=!1){if(!t||!(t instanceof HTMLElement))return;let a={};Object.entries(n).forEach(([o,i])=>{if(o.startsWith("--")){t.style.setProperty(o,i);return}a[o]=t.style[o],t.style[o]=i}),!r&&ln.set(t,a)}function pr(t,n){if(!t||!(t instanceof HTMLElement))return;let r=ln.get(t);r&&(t.style[n]=r[n])}const be=t=>{switch(t){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return t}};function vt(t,n){if(!t)return null;const r=window.getComputedStyle(t),a=r.transform||r.webkitTransform||r.mozTransform;let o=a.match(/^matrix3d\((.+)\)$/);return o?parseFloat(o[1].split(", ")[be(n)?13:12]):(o=a.match(/^matrix\((.+)\)$/),o?parseFloat(o[1].split(", ")[be(n)?5:4]):null)}function xr(t){return 8*(Math.log(t+1)-2)}function Lt(t,n){if(!t)return()=>{};const r=t.style.cssText;return Object.assign(t.style,n),()=>{t.style.cssText=r}}function gr(...t){return(...n)=>{for(const r of t)typeof r=="function"&&r(...n)}}const me={DURATION:.5,EASE:[.32,.72,0,1]},cn=.4,vr=.25,br=100,dn=8,rt=16,Pt=26,_t="vaul-dragging";function un(t){const n=f.useRef(t);return f.useEffect(()=>{n.current=t}),f.useMemo(()=>(...r)=>n.current==null?void 0:n.current.call(n,...r),[])}function wr({defaultProp:t,onChange:n}){const r=f.useState(t),[a]=r,o=f.useRef(a),i=un(n);return f.useEffect(()=>{o.current!==a&&(i(a),o.current=a)},[a,o,i]),r}function mn({prop:t,defaultProp:n,onChange:r=()=>{}}){const[a,o]=wr({defaultProp:n,onChange:r}),i=t!==void 0,b=i?t:a,w=un(r),k=f.useCallback(L=>{if(i){const u=typeof L=="function"?L(t):L;u!==t&&w(u)}else o(L)},[i,t,o,w]);return[b,k]}function jr({activeSnapPointProp:t,setActiveSnapPointProp:n,snapPoints:r,drawerRef:a,overlayRef:o,fadeFromIndex:i,onSnapPointChange:b,direction:w="bottom",container:k,snapToSequentialPoint:L}){const[g,u]=mn({prop:t,defaultProp:r==null?void 0:r[0],onChange:n}),[h,D]=f.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);f.useEffect(()=>{function m(){D({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)},[]);const $=f.useMemo(()=>g===(r==null?void 0:r[r.length-1])||null,[r,g]),T=f.useMemo(()=>{var m;return(m=r==null?void 0:r.findIndex(x=>x===g))!=null?m:null},[r,g]),B=r&&r.length>0&&(i||i===0)&&!Number.isNaN(i)&&r[i]===g||!r,R=f.useMemo(()=>{const m=k?{width:k.getBoundingClientRect().width,height:k.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var x;return(x=r==null?void 0:r.map(F=>{const W=typeof F=="string";let j=0;if(W&&(j=parseInt(F,10)),be(w)){const c=W?j:h?F*m.height:0;return h?w==="bottom"?m.height-c:-m.height+c:c}const _=W?j:h?F*m.width:0;return h?w==="right"?m.width-_:-m.width+_:_}))!=null?x:[]},[r,h,k]),E=f.useMemo(()=>T!==null?R==null?void 0:R[T]:null,[R,T]),I=f.useCallback(m=>{var x;const F=(x=R==null?void 0:R.findIndex(W=>W===m))!=null?x:null;b(F),ke(a.current,{transition:`transform ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`,transform:be(w)?`translate3d(0, ${m}px, 0)`:`translate3d(${m}px, 0, 0)`}),R&&F!==R.length-1&&i!==void 0&&F!==i&&F<i?ke(o.current,{transition:`opacity ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`,opacity:"0"}):ke(o.current,{transition:`opacity ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`,opacity:"1"}),u(r==null?void 0:r[Math.max(F,0)])},[a.current,r,R,i,o,u]);f.useEffect(()=>{if(g||t){var m;const x=(m=r==null?void 0:r.findIndex(F=>F===t||F===g))!=null?m:-1;R&&x!==-1&&typeof R[x]=="number"&&I(R[x])}},[g,t,r,R,I]);function y({draggedDistance:m,closeDrawer:x,velocity:F,dismissible:W}){if(i===void 0)return;const j=w==="bottom"||w==="right"?(E??0)-m:(E??0)+m,_=T===i-1,c=T===0,H=m>0;if(_&&ke(o.current,{transition:`opacity ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`}),!L&&F>2&&!H){W?x():I(R[0]);return}if(!L&&F>2&&H&&R&&r){I(R[r.length-1]);return}const S=R==null?void 0:R.reduce((M,re)=>typeof M!="number"||typeof re!="number"?M:Math.abs(re-j)<Math.abs(M-j)?re:M),Y=be(w)?window.innerHeight:window.innerWidth;if(F>cn&&Math.abs(m)<Y*.4){const M=H?1:-1;if(M>0&&$&&r){I(R[r.length-1]);return}if(c&&M<0&&W&&x(),T===null)return;I(R[T+M]);return}I(S)}function U({draggedDistance:m}){if(E===null)return;const x=w==="bottom"||w==="right"?E-m:E+m;(w==="bottom"||w==="right")&&x<R[R.length-1]||(w==="top"||w==="left")&&x>R[R.length-1]||ke(a.current,{transform:be(w)?`translate3d(0, ${x}px, 0)`:`translate3d(${x}px, 0, 0)`})}function q(m,x){if(!r||typeof T!="number"||!R||i===void 0)return null;const F=T===i-1;if(T>=i&&x)return 0;if(F&&!x)return 1;if(!B&&!F)return null;const j=F?T+1:T-1,_=F?R[j]-R[j-1]:R[j+1]-R[j],c=m/Math.abs(_);return F?1-c:c}return{isLastSnapPoint:$,activeSnapPoint:g,shouldFade:B,getPercentageDragged:q,setActiveSnapPoint:u,activeSnapPointIndex:T,onRelease:y,onDrag:U,snapPointsOffset:R}}const yr=()=>()=>{};function kr(){const{direction:t,isOpen:n,shouldScaleBackground:r,setBackgroundColorOnScale:a,noBodyStyles:o}=ft(),i=f.useRef(null),b=d.useMemo(()=>document.body.style.backgroundColor,[]);function w(){return(window.innerWidth-Pt)/window.innerWidth}f.useEffect(()=>{if(n&&r){i.current&&clearTimeout(i.current);const k=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!k)return;gr(a&&!o?Lt(document.body,{background:"black"}):yr,Lt(k,{transformOrigin:be(t)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${me.DURATION}s`,transitionTimingFunction:`cubic-bezier(${me.EASE.join(",")})`}));const L=Lt(k,{borderRadius:`${dn}px`,overflow:"hidden",...be(t)?{transform:`scale(${w()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${w()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{L(),i.current=window.setTimeout(()=>{b?document.body.style.background=b:document.body.style.removeProperty("background")},me.DURATION*1e3)}}},[n,r,b])}let mt=null;function Nr({isOpen:t,modal:n,nested:r,hasBeenOpened:a,preventScrollRestoration:o,noBodyStyles:i}){const[b,w]=f.useState(()=>typeof window<"u"?window.location.href:""),k=f.useRef(0),L=f.useCallback(()=>{if(Vt()&&mt===null&&t&&!i){mt={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:u,innerHeight:h}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-k.current}px`,left:`${-u}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const D=h-window.innerHeight;D&&k.current>=h&&(document.body.style.top=`${-(k.current+D)}px`)}),300)}},[t]),g=f.useCallback(()=>{if(Vt()&&mt!==null&&!i){const u=-parseInt(document.body.style.top,10),h=-parseInt(document.body.style.left,10);Object.assign(document.body.style,mt),window.requestAnimationFrame(()=>{if(o&&b!==window.location.href){w(window.location.href);return}window.scrollTo(h,u)}),mt=null}},[b]);return f.useEffect(()=>{function u(){k.current=window.scrollY}return u(),window.addEventListener("scroll",u),()=>{window.removeEventListener("scroll",u)}},[]),f.useEffect(()=>{if(n)return()=>{typeof document>"u"||document.querySelector("[data-vaul-drawer]")||g()}},[n,g]),f.useEffect(()=>{r||!a||(t?(!window.matchMedia("(display-mode: standalone)").matches&&L(),n||window.setTimeout(()=>{g()},500)):g())},[t,a,b,n,r,L,g]),{restorePositionSetting:g}}function Cr({open:t,onOpenChange:n,children:r,onDrag:a,onRelease:o,snapPoints:i,shouldScaleBackground:b=!1,setBackgroundColorOnScale:w=!0,closeThreshold:k=vr,scrollLockTimeout:L=br,dismissible:g=!0,handleOnly:u=!1,fadeFromIndex:h=i&&i.length-1,activeSnapPoint:D,setActiveSnapPoint:$,fixed:T,modal:B=!0,onClose:R,nested:E,noBodyStyles:I=!1,direction:y="bottom",defaultOpen:U=!1,disablePreventScroll:q=!0,snapToSequentialPoint:m=!1,preventScrollRestoration:x=!1,repositionInputs:F=!0,onAnimationEnd:W,container:j,autoFocus:_=!1}){var c,H;const[S=!1,Y]=mn({defaultProp:U,prop:t,onChange:z=>{n==null||n(z),!z&&!E&&Ve(),setTimeout(()=>{W==null||W(z)},me.DURATION*1e3),z&&!B&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),z||(document.body.style.pointerEvents="auto")}}),[M,re]=f.useState(!1),[Z,xe]=f.useState(!1),[ae,ge]=f.useState(!1),ce=f.useRef(null),Ne=f.useRef(null),ue=f.useRef(null),Pe=f.useRef(null),le=f.useRef(null),Me=f.useRef(!1),Se=f.useRef(null),Ce=f.useRef(0),se=f.useRef(!1),N=f.useRef(!U),p=f.useRef(0),l=f.useRef(null),V=f.useRef(((c=l.current)==null?void 0:c.getBoundingClientRect().height)||0),X=f.useRef(((H=l.current)==null?void 0:H.getBoundingClientRect().width)||0),de=f.useRef(0),ie=f.useCallback(z=>{i&&z===_e.length-1&&(Ne.current=new Date)},[]),{activeSnapPoint:Be,activeSnapPointIndex:te,setActiveSnapPoint:Le,onRelease:Ae,snapPointsOffset:_e,onDrag:Je,shouldFade:Ue,getPercentageDragged:st}=jr({snapPoints:i,activeSnapPointProp:D,setActiveSnapPointProp:$,drawerRef:l,fadeFromIndex:h,overlayRef:ce,onSnapPointChange:ie,direction:y,container:j,snapToSequentialPoint:m});dr({isDisabled:!S||Z||!B||ae||!M||!F||!q});const{restorePositionSetting:Ve}=Nr({isOpen:S,modal:B,nested:E??!1,hasBeenOpened:M,preventScrollRestoration:x,noBodyStyles:I});function $e(){return(window.innerWidth-Pt)/window.innerWidth}function it(z){var ee,ne;!g&&!i||l.current&&!l.current.contains(z.target)||(V.current=((ee=l.current)==null?void 0:ee.getBoundingClientRect().height)||0,X.current=((ne=l.current)==null?void 0:ne.getBoundingClientRect().width)||0,xe(!0),ue.current=new Date,sn()&&window.addEventListener("touchend",()=>Me.current=!1,{once:!0}),z.target.setPointerCapture(z.pointerId),Ce.current=be(y)?z.pageY:z.pageX)}function tt(z,ee){var ne;let J=z;const oe=(ne=window.getSelection())==null?void 0:ne.toString(),fe=l.current?vt(l.current,y):null,je=new Date;if(J.tagName==="SELECT"||J.hasAttribute("data-vaul-no-drag")||J.closest("[data-vaul-no-drag]"))return!1;if(y==="right"||y==="left")return!0;if(Ne.current&&je.getTime()-Ne.current.getTime()<500)return!1;if(fe!==null&&(y==="bottom"?fe>0:fe<0))return!0;if(oe&&oe.length>0)return!1;if(le.current&&je.getTime()-le.current.getTime()<L&&fe===0||ee)return le.current=je,!1;for(;J;){if(J.scrollHeight>J.clientHeight){if(J.scrollTop!==0)return le.current=new Date,!1;if(J.getAttribute("role")==="dialog")return!0}J=J.parentNode}return!0}function at(z){if(l.current&&Z){const ee=y==="bottom"||y==="right"?1:-1,ne=(Ce.current-(be(y)?z.pageY:z.pageX))*ee,J=ne>0,oe=i&&!g&&!J;if(oe&&te===0)return;const fe=Math.abs(ne),je=document.querySelector("[data-vaul-drawer-wrapper]"),A=y==="bottom"||y==="top"?V.current:X.current;let Q=fe/A;const he=st(fe,J);if(he!==null&&(Q=he),oe&&Q>=1||!Me.current&&!tt(z.target,J))return;if(l.current.classList.add(_t),Me.current=!0,ke(l.current,{transition:"none"}),ke(ce.current,{transition:"none"}),i&&Je({draggedDistance:ne}),J&&!i){const Ee=xr(ne),ye=Math.min(Ee*-1,0)*ee;ke(l.current,{transform:be(y)?`translate3d(0, ${ye}px, 0)`:`translate3d(${ye}px, 0, 0)`});return}const Re=1-Q;if((Ue||h&&te===h-1)&&(a==null||a(z,Q),ke(ce.current,{opacity:`${Re}`,transition:"none"},!0)),je&&ce.current&&b){const Ee=Math.min($e()+Q*(1-$e()),1),ye=8-Q*8,De=Math.max(0,14-Q*14);ke(je,{borderRadius:`${ye}px`,transform:be(y)?`scale(${Ee}) translate3d(0, ${De}px, 0)`:`scale(${Ee}) translate3d(${De}px, 0, 0)`,transition:"none"},!0)}if(!i){const Ee=fe*ee;ke(l.current,{transform:be(y)?`translate3d(0, ${Ee}px, 0)`:`translate3d(${Ee}px, 0, 0)`})}}}f.useEffect(()=>{window.requestAnimationFrame(()=>{N.current=!0})},[]),f.useEffect(()=>{var z;function ee(){if(!l.current||!F)return;const ne=document.activeElement;if(Ot(ne)||se.current){var J;const oe=((J=window.visualViewport)==null?void 0:J.height)||0,fe=window.innerHeight;let je=fe-oe;const A=l.current.getBoundingClientRect().height||0,Q=A>fe*.8;de.current||(de.current=A);const he=l.current.getBoundingClientRect().top;if(Math.abs(p.current-je)>60&&(se.current=!se.current),i&&i.length>0&&_e&&te){const Re=_e[te]||0;je+=Re}if(p.current=je,A>oe||se.current){const Re=l.current.getBoundingClientRect().height;let Ee=Re;Re>oe&&(Ee=oe-(Q?he:Pt)),T?l.current.style.height=`${Re-Math.max(je,0)}px`:l.current.style.height=`${Math.max(Ee,oe-he)}px`}else rr()||(l.current.style.height=`${de.current}px`);i&&i.length>0&&!se.current?l.current.style.bottom="0px":l.current.style.bottom=`${Math.max(je,0)}px`}}return(z=window.visualViewport)==null||z.addEventListener("resize",ee),()=>{var ne;return(ne=window.visualViewport)==null?void 0:ne.removeEventListener("resize",ee)}},[te,i,_e]);function Ye(z){Xe(),R==null||R(),z||Y(!1),setTimeout(()=>{i&&Le(i[0])},me.DURATION*1e3)}function Te(){if(!l.current)return;const z=document.querySelector("[data-vaul-drawer-wrapper]"),ee=vt(l.current,y);ke(l.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`}),ke(ce.current,{transition:`opacity ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`,opacity:"1"}),b&&ee&&ee>0&&S&&ke(z,{borderRadius:`${dn}px`,overflow:"hidden",...be(y)?{transform:`scale(${$e()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${$e()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${me.DURATION}s`,transitionTimingFunction:`cubic-bezier(${me.EASE.join(",")})`},!0)}function Xe(){!Z||!l.current||(l.current.classList.remove(_t),Me.current=!1,xe(!1),Pe.current=new Date)}function Ge(z){if(!Z||!l.current)return;l.current.classList.remove(_t),Me.current=!1,xe(!1),Pe.current=new Date;const ee=vt(l.current,y);if(!z||!tt(z.target,!1)||!ee||Number.isNaN(ee)||ue.current===null)return;const ne=Pe.current.getTime()-ue.current.getTime(),J=Ce.current-(be(y)?z.pageY:z.pageX),oe=Math.abs(J)/ne;if(oe>.05&&(ge(!0),setTimeout(()=>{ge(!1)},200)),i){Ae({draggedDistance:J*(y==="bottom"||y==="right"?1:-1),closeDrawer:Ye,velocity:oe,dismissible:g}),o==null||o(z,!0);return}if(y==="bottom"||y==="right"?J>0:J<0){Te(),o==null||o(z,!0);return}if(oe>cn){Ye(),o==null||o(z,!1);return}var fe;const je=Math.min((fe=l.current.getBoundingClientRect().height)!=null?fe:0,window.innerHeight);var A;const Q=Math.min((A=l.current.getBoundingClientRect().width)!=null?A:0,window.innerWidth),he=y==="left"||y==="right";if(Math.abs(ee)>=(he?Q:je)*k){Ye(),o==null||o(z,!1);return}o==null||o(z,!0),Te()}f.useEffect(()=>(S&&(ke(document.documentElement,{scrollBehavior:"auto"}),Ne.current=new Date),()=>{pr(document.documentElement,"scrollBehavior")}),[S]);function ve(z){const ee=z?(window.innerWidth-rt)/window.innerWidth:1,ne=z?-rt:0;Se.current&&window.clearTimeout(Se.current),ke(l.current,{transition:`transform ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`,transform:be(y)?`scale(${ee}) translate3d(0, ${ne}px, 0)`:`scale(${ee}) translate3d(${ne}px, 0, 0)`}),!z&&l.current&&(Se.current=setTimeout(()=>{const J=vt(l.current,y);ke(l.current,{transition:"none",transform:be(y)?`translate3d(0, ${J}px, 0)`:`translate3d(${J}px, 0, 0)`})},500))}function Ie(z,ee){if(ee<0)return;const ne=(window.innerWidth-rt)/window.innerWidth,J=ne+ee*(1-ne),oe=-rt+ee*rt;ke(l.current,{transform:be(y)?`scale(${J}) translate3d(0, ${oe}px, 0)`:`scale(${J}) translate3d(${oe}px, 0, 0)`,transition:"none"})}function Qe(z,ee){const ne=be(y)?window.innerHeight:window.innerWidth,J=ee?(ne-rt)/ne:1,oe=ee?-rt:0;ee&&ke(l.current,{transition:`transform ${me.DURATION}s cubic-bezier(${me.EASE.join(",")})`,transform:be(y)?`scale(${J}) translate3d(0, ${oe}px, 0)`:`scale(${J}) translate3d(${oe}px, 0, 0)`})}return f.useEffect(()=>{B||window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"})},[B]),f.createElement(_n,{defaultOpen:U,onOpenChange:z=>{!g&&!z||(z?re(!0):Ye(!0),Y(z))},open:S},f.createElement(rn.Provider,{value:{activeSnapPoint:Be,snapPoints:i,setActiveSnapPoint:Le,drawerRef:l,overlayRef:ce,onOpenChange:n,onPress:it,onRelease:Ge,onDrag:at,dismissible:g,shouldAnimate:N,handleOnly:u,isOpen:S,isDragging:Z,shouldFade:Ue,closeDrawer:Ye,onNestedDrag:Ie,onNestedOpenChange:ve,onNestedRelease:Qe,keyboardIsOpen:se,modal:B,snapPointsOffset:_e,activeSnapPointIndex:te,direction:y,shouldScaleBackground:b,setBackgroundColorOnScale:w,noBodyStyles:I,container:j,autoFocus:_}},r))}const fn=f.forwardRef(function({...t},n){const{overlayRef:r,snapPoints:a,onRelease:o,shouldFade:i,isOpen:b,modal:w,shouldAnimate:k}=ft(),L=on(n,r),g=a&&a.length>0;if(!w)return null;const u=f.useCallback(h=>o(h),[o]);return f.createElement(Tn,{onMouseUp:u,ref:L,"data-vaul-overlay":"","data-vaul-snap-points":b&&g?"true":"false","data-vaul-snap-points-overlay":b&&i?"true":"false","data-vaul-animate":k!=null&&k.current?"true":"false",...t})});fn.displayName="Drawer.Overlay";const hn=f.forwardRef(function({onPointerDownOutside:t,style:n,onOpenAutoFocus:r,...a},o){const{drawerRef:i,onPress:b,onRelease:w,onDrag:k,keyboardIsOpen:L,snapPointsOffset:g,activeSnapPointIndex:u,modal:h,isOpen:D,direction:$,snapPoints:T,container:B,handleOnly:R,shouldAnimate:E,autoFocus:I}=ft(),[y,U]=f.useState(!1),q=on(o,i),m=f.useRef(null),x=f.useRef(null),F=f.useRef(!1),W=T&&T.length>0;kr();const j=(c,H,S=0)=>{if(F.current)return!0;const Y=Math.abs(c.y),M=Math.abs(c.x),re=M>Y,Z=["bottom","right"].includes(H)?1:-1;if(H==="left"||H==="right"){if(!(c.x*Z<0)&&M>=0&&M<=S)return re}else if(!(c.y*Z<0)&&Y>=0&&Y<=S)return!re;return F.current=!0,!0};f.useEffect(()=>{W&&window.requestAnimationFrame(()=>{U(!0)})},[]);function _(c){m.current=null,F.current=!1,w(c)}return f.createElement(Mn,{"data-vaul-drawer-direction":$,"data-vaul-drawer":"","data-vaul-delayed-snap-points":y?"true":"false","data-vaul-snap-points":D&&W?"true":"false","data-vaul-custom-container":B?"true":"false","data-vaul-animate":E!=null&&E.current?"true":"false",...a,ref:q,style:g&&g.length>0?{"--snap-point-height":`${g[u??0]}px`,...n}:n,onPointerDown:c=>{R||(a.onPointerDown==null||a.onPointerDown.call(a,c),m.current={x:c.pageX,y:c.pageY},b(c))},onOpenAutoFocus:c=>{r==null||r(c),I||c.preventDefault()},onPointerDownOutside:c=>{if(t==null||t(c),!h||c.defaultPrevented){c.preventDefault();return}L.current&&(L.current=!1)},onFocusOutside:c=>{if(!h){c.preventDefault();return}},onPointerMove:c=>{if(x.current=c,R||(a.onPointerMove==null||a.onPointerMove.call(a,c),!m.current))return;const H=c.pageY-m.current.y,S=c.pageX-m.current.x,Y=c.pointerType==="touch"?10:2;j({x:S,y:H},$,Y)?k(c):(Math.abs(S)>Y||Math.abs(H)>Y)&&(m.current=null)},onPointerUp:c=>{a.onPointerUp==null||a.onPointerUp.call(a,c),m.current=null,F.current=!1,w(c)},onPointerOut:c=>{a.onPointerOut==null||a.onPointerOut.call(a,c),_(x.current)},onContextMenu:c=>{a.onContextMenu==null||a.onContextMenu.call(a,c),x.current&&_(x.current)}})});hn.displayName="Drawer.Content";const Sr=250,Rr=120,Er=f.forwardRef(function({preventCycle:t=!1,children:n,...r},a){const{closeDrawer:o,isDragging:i,snapPoints:b,activeSnapPoint:w,setActiveSnapPoint:k,dismissible:L,handleOnly:g,isOpen:u,onPress:h,onDrag:D}=ft(),$=f.useRef(null),T=f.useRef(!1);function B(){if(T.current){I();return}window.setTimeout(()=>{R()},Rr)}function R(){if(i||t||T.current){I();return}if(I(),!b||b.length===0){L||o();return}if(w===b[b.length-1]&&L){o();return}const U=b.findIndex(m=>m===w);if(U===-1)return;const q=b[U+1];k(q)}function E(){$.current=window.setTimeout(()=>{T.current=!0},Sr)}function I(){$.current&&window.clearTimeout($.current),T.current=!1}return f.createElement("div",{onClick:B,onPointerCancel:I,onPointerDown:y=>{g&&h(y),E()},onPointerMove:y=>{g&&D(y)},ref:a,"data-vaul-drawer-visible":u?"true":"false","data-vaul-handle":"","aria-hidden":"true",...r},f.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},n))});Er.displayName="Drawer.Handle";function Lr(t){const n=ft(),{container:r=n.container,...a}=t;return f.createElement($n,{container:r,...a})}const ht={Root:Cr,Content:hn,Overlay:fn,Portal:Lr,Title:Ln};function Mt({...t}){return e.jsx(ht.Root,{"data-slot":"drawer",...t})}function _r({...t}){return e.jsx(ht.Portal,{"data-slot":"drawer-portal",...t})}function Mr({className:t,...n}){return e.jsx(ht.Overlay,{"data-slot":"drawer-overlay",className:Oe("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...n})}function $t({className:t,children:n,...r}){return e.jsxs(_r,{"data-slot":"drawer-portal",children:[e.jsx(Mr,{}),e.jsxs(ht.Content,{"data-slot":"drawer-content",className:Oe("group/drawer-content bg-background fixed z-50 flex h-auto flex-col","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",t),...r,children:[e.jsx("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),n]})]})}function Gt({className:t,...n}){return e.jsx("div",{"data-slot":"drawer-header",className:Oe("flex flex-col gap-0.5 p-4 group-data-[vaul-drawer-direction=bottom]/drawer-content:text-center group-data-[vaul-drawer-direction=top]/drawer-content:text-center md:gap-1.5 md:text-left",t),...n})}function Qt({className:t,...n}){return e.jsx(ht.Title,{"data-slot":"drawer-title",className:Oe("text-foreground font-semibold",t),...n})}function $r(){const t=Kt(),{selectedWatchDirs:n,selectedSources:r,setFiles:a,refreshFiles:o,showAllFiles:i,setShowAllFiles:b,page:w,setPage:k,pageSize:L,setPageSize:g,sortColumn:u,setSortColumn:h,sortDirection:D,setSortDirection:$,totalPages:T,totalRecords:B}=Jt(),[R,E]=d.useState(new Set),[I,y]=d.useState(""),[U,q]=d.useState(""),[m,x]=d.useState({}),[F,W]=d.useState(!1),[j]=d.useState([]),[_]=d.useState(null),[c]=d.useState("TODO delete"),[H,S]=d.useState({}),[Y,M]=d.useState(!0),[re,Z]=d.useState(0),[xe,ae]=d.useState(null),[ge,ce]=d.useState(0),[Ne,ue]=d.useState(!1),[Pe,le]=d.useState(!1),[Me,Se]=d.useState(!1),[Ce,se]=d.useState(!1),[N,p]=d.useState(!1),[l,V]=d.useState(!1),[X,de]=d.useState(null),[ie,Be]=d.useState(null),[te,Le]=d.useState(null),[Ae,_e]=d.useState(""),Je=d.useRef({}),Ue=d.useRef({}),st=d.useRef({}),Ve=d.useRef(null),$e=!0;d.useEffect(()=>{const A=Ve.current;if(!A||!$e)return;const Q=()=>{const he=A.scrollTop;M(he<=10),Z(he)};return A.addEventListener("scroll",Q),Q(),()=>{A.removeEventListener("scroll",Q)}},[$e]);const it=()=>{const A=Ve.current;A&&A.scrollTo({top:0,behavior:"smooth"})},tt=async()=>{if(!I.trim()){x({}),q("");return}W(!0);try{const A=new URLSearchParams;A.append("query",I),n.length>0&&A.append("filter",n.join(",")),r.length>0&&A.append("sources",r.join(","));const Q=await fetch(Fe(`/api/search?${A.toString()}`));if(Q.ok){const he=await Q.json();if(he.success){x(he.data.map(ye=>({[ye.file_path]:ye.matches.map(De=>De.line_number)})).reduce((ye,De)=>({...ye,...De}),{}));const Ee=he.data.map(ye=>{const De=ye.matches[0];return De&&De.video_info?De.video_info:null}).filter(ye=>ye!==null).filter((ye,De,pt)=>De===pt.findIndex(xt=>xt.full_path===ye.full_path));a(Ee)}q(I)}}catch(A){console.error("Error searching:",A)}finally{W(!1)}},at=()=>{b(A=>!A)},Ye=()=>{y(""),q(""),x({}),E(new Set),i&&o()},Te=A=>{const Q=Math.floor(A/3600),he=Math.floor(A%3600/60),Re=A%60,Ee=Math.floor(Re),ye=Math.round((Re-Ee)*1e3);return`${Q.toString().padStart(2,"0")}:${he.toString().padStart(2,"0")}:${Ee.toString().padStart(2,"0")}.${ye.toString().padStart(3,"0")}`},Xe=A=>{de(A)},Ge=A=>{Be(A)},ve=d.useCallback((A,Q)=>{t?A?(se(!0),p(!1),V(!1)):se(!1):(ae(A),le(!1),Se(!1))},[t]),Ie=()=>{t?(p(!0),se(!1),V(!1)):(le(!0),Se(!1),ae(null))},Qe=()=>{t?(V(!0),se(!1),p(!1)):(Se(!0),le(!1),ae(null))},z=()=>{if(le(!1),X!==null&&ie!==null&&te){const A=`/clip_player/${encodeURIComponent(te)}?start_time=${X}&end_time=${ie}&display_text=false`,Q=e.jsx("div",{className:"w-full flex-1 overflow-y-auto scrollbar-hide",children:e.jsx(dt,{filename:te,start_time_formatted:Te(X),end_time_formatted:Te(ie),font_size:"",text:Ae,display_text:!1,onStartTimeChange:Xe,onEndTimeChange:Ge,onBack:()=>{t?se(!1):(ae(null),oe())}},te)});ve(Q,A)}},ee=()=>{if(Se(!1),X!==null&&ie!==null&&te){const A=`/clip_player/${encodeURIComponent(te)}?start_time=${X}&end_time=${ie}&display_text=false`,Q=e.jsx("div",{className:"w-full flex-1 overflow-y-auto scrollbar-hide",children:e.jsx(dt,{filename:te,start_time_formatted:Te(X),end_time_formatted:Te(ie),font_size:"",text:Ae,display_text:!1,onStartTimeChange:Xe,onEndTimeChange:Ge,onBack:()=>{t?se(!1):(ae(null),oe())}},te)});ve(Q,A)}},ne=(A,Q)=>{te&&te!==Q?(de(A),Be(null),Le(Q)):(de(A),Le(Q))},J=(A,Q)=>{te&&te!==Q?(de(null),Be(A),Le(Q)):(Be(A),Le(Q))},oe=()=>{de(null),Be(null),Le(null),_e(""),ae(null),se(!1),p(!1),V(!1),le(!1),Se(!1)},fe=(A,Q,he,Re)=>{de(A),Be(Q),Le(Re),_e(he)},je=()=>{if(X!==null&&ie!==null&&te){const A=`/clip_player/${encodeURIComponent(te)}?start_time=${X}&end_time=${ie}&display_text=false`,Q=e.jsx("div",{className:"w-full flex-1 overflow-y-auto scrollbar-hide",children:e.jsx(dt,{filename:te,start_time_formatted:Te(X),end_time_formatted:Te(ie),font_size:"",text:Ae,display_text:!1,onStartTimeChange:Xe,onEndTimeChange:Ge,onBack:()=>{t?(ve(null),M(!0),setTimeout(()=>{Ve.current&&(Ve.current.scrollTop=re)},0)):ae(null)}},te)});ve(Q,A)}};return d.useEffect(()=>{if(X!==null&&ie!==null&&te){const A=`/clip_player/${encodeURIComponent(te)}?start_time=${X}&end_time=${ie}&display_text=false`,Q=e.jsx("div",{className:"w-full flex-1 overflow-y-auto scrollbar-hide",children:e.jsx(dt,{filename:te,start_time_formatted:Te(X),end_time_formatted:Te(ie),font_size:"",text:Ae,display_text:!1,onStartTimeChange:Xe,onEndTimeChange:Ge,onBack:()=>{t?se(!1):(ae(null),oe())}},te)});ve(Q,A)}else(X!==null||ie!==null)&&(t?se(!1):ae(null))},[X,ie,te,ve,t]),d.useEffect(()=>{typeof window<"u"&&(window.handleSetRightPaneComponent=ve)},[ve]),e.jsxs(e.Fragment,{children:[e.jsx(Yn,{show:!0,searchTerm:I,setSearchTerm:y,activeSearchTerm:U,setActiveSearchTerm:q,setSearchLineNumbers:x,setExpandedFiles:E,isSearching:F,queue:j,currentProcessingFile:_,isAtTop:Y,clipStart:X,clipEnd:ie,selectedWatchDirs:n,setSelectedWatchDirs:()=>{},availableWatchDirs:[],selectedSources:r,setSelectedSources:()=>{},availableSources:[],showAllFiles:i,onToggleShowAllFiles:at,onSearch:tt,onClearSearch:Ye,onScrollToTop:it,onConfigClick:Ie,onQueueClick:Qe,mobileClipPlayerComponent:null,onPlayClip:je}),e.jsxs("div",{className:"flex h-screen",children:[e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:e.jsx(Zn,{watchDirectory:c,isSmallScreen:t,activeSearchTerm:U,searchLineNumbers:m,setSearchLineNumbers:x,expandedFiles:R,setExpandedFiles:E,transcriptData:H,setTranscriptData:S,currentProcessingFile:_,leftPaneWidth:ge,setLeftPaneWidth:ce,isLeftPaneWidthMeasured:Ne,setIsLeftPaneWidthMeasured:ue,clipStart:X,clipEnd:ie,clipTranscript:te,fileRowRefs:Je,transcriptRowRefs:Ue,mobileTranscriptRowRefs:st,leftPaneRef:Ve,onSetRightPaneUrl:ve,onSetClipStart:ne,onSetClipEnd:J,onClearClip:oe,onClipBlock:fe,showAllFiles:i})}),!t&&e.jsx("div",{className:"w-1/3 border-l border-border flex flex-col scrollbar-hide pt-16",children:Pe?e.jsx(zt,{onClose:z}):Me?e.jsx(Ft,{onClose:ee}):xe||e.jsx(er,{})})]}),t&&e.jsxs(e.Fragment,{children:[e.jsx(Mt,{open:Ce,onOpenChange:se,children:e.jsx($t,{children:e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:X!==null&&ie!==null&&te&&e.jsx(dt,{filename:te,start_time_formatted:Te(X),end_time_formatted:Te(ie),font_size:"",text:Ae,display_text:!1,onStartTimeChange:Xe,onEndTimeChange:Ge,onBack:()=>se(!1)},te)})})}),e.jsx(Mt,{open:N,onOpenChange:p,children:e.jsxs($t,{children:[e.jsx(Gt,{children:e.jsx(Qt,{children:"Configuration"})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(zt,{onClose:()=>p(!1)})})]})}),e.jsx(Mt,{open:l,onOpenChange:V,children:e.jsxs($t,{children:[e.jsx(Gt,{children:e.jsx(Qt,{children:"Processing Queue"})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(Ft,{onClose:()=>V(!1)})})]})})]})]})}function Hr(){return e.jsx($r,{})}export{Hr as default};
