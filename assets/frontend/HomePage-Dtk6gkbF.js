import{j as e,S as Cn,C as Sn,a as Rn,T as En,R as Ln,b as _n,P as Mn,O as Tn}from"./radix-CDPlHJ-s.js";import{r as d,b as u}from"./router-Cji3JhtE.js";import{a as $n}from"./utils-BMpDO24p.js";import{c as Te,a as Ve,u as Qt,T as Dn,b as On,d as jt,e as nt,f as Pn,g as Ge}from"./index.js";import{D as Fe,a as He,b as ze,c as vt,d as Qe,e as Je,f as we,Q as It}from"./QueuePage-BtxpzuDR.js";import{b as yt,X as An,c as Bn,d as Ft,e as In,f as Fn,R as Hn,g as zn,D as kt,h as Nt}from"./icons-D0PEVxHe.js";import Ht from"./ConfigPage-DWe62UL6.js";import"./react-vendor-DJG_os-6.js";const Wn=$n("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),be=d.forwardRef(({className:t,variant:n,size:r,asChild:a=!1,...i},l)=>{const b=a?Cn:"button";return e.jsx(b,{className:Te(Wn({variant:n,size:r,className:t})),ref:l,...i})});be.displayName="Button";function Un(t){const[n,r]=d.useState(()=>window.matchMedia(t).matches);return d.useEffect(()=>{const a=window.matchMedia(t),i=l=>{r(l.matches)};return a.addEventListener("change",i),r(a.matches),()=>{a.removeEventListener("change",i)}},[t]),n}function Jt(){return!Un("(min-width: 640px)")}function Vn({searchTerm:t,setSearchTerm:n,activeSearchTerm:r,setActiveSearchTerm:a,setSearchLineNumbers:i,setExpandedFiles:l,isSearching:b,isOpen:w,onClose:k,onSearch:L,onClearSearch:v,selectedWatchDirs:h,setSelectedWatchDirs:m,availableWatchDirs:D,selectedSources:M,setSelectedSources:T,availableSources:F}){const E=()=>{n(""),a(""),i({}),l(new Set),v()};return w?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-start justify-center pt-20",children:e.jsx("div",{className:"bg-background border border-border rounded-lg shadow-lg w-full max-w-md mx-4",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Search"}),e.jsx("button",{onClick:k,className:"p-1 text-muted-foreground hover:text-foreground transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search",value:t,onChange:S=>{const P=S.target.value;n(P),P.trim()===""&&(a(""),i({}),l(new Set))},onKeyDown:S=>{S.key==="Enter"&&(L(),k())},className:"w-full px-3 py-2 pr-10 text-sm border border-input bg-background text-foreground rounded focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent",autoFocus:!0}),(t||r)&&e.jsx("button",{onClick:E,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",title:"Clear search",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(D.length>1||F.length>1)&&e.jsxs("div",{className:"mb-4 space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground",children:"Search Filters"}),D.length>1&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Watch Directories"}),e.jsxs(Fe,{modal:!1,children:[e.jsx(He,{asChild:!0,children:e.jsxs("button",{className:"w-full inline-flex items-center justify-between whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[h.length===D.length||h.length===0?"All Directories":`${h.length} Director${h.length===1?"y":"ies"}`,e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsxs(ze,{align:"start",className:"w-80",children:[e.jsx(vt,{children:"Watch Directories"}),e.jsx(Qe,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 p-2",children:[e.jsx(Je,{checked:h.length===D.length,onCheckedChange:S=>{m(S?[...D]:[])},children:"Select All"}),e.jsx(Qe,{}),D.map(S=>e.jsx(Je,{checked:h.includes(S),onCheckedChange:P=>{m(P?[...h,S]:h.filter(j=>j!==S))},children:e.jsx("span",{className:"truncate",title:S,children:S.split("/").pop()||S})},S))]})]})]})]}),F.length>1&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-muted-foreground mb-1 block",children:"Transcript Sources"}),e.jsxs(Fe,{modal:!1,children:[e.jsx(He,{asChild:!0,children:e.jsxs("button",{className:"w-full inline-flex items-center justify-between whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[M.length===F.length?"All Sources":M.length===0?"No Sources":`${M.length} Source${M.length===1?"":"s"}`,e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsxs(ze,{align:"start",className:"w-80",children:[e.jsx(vt,{children:"Sources"}),e.jsx(Qe,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 p-2",children:[e.jsx(Je,{checked:M.length===F.length,onCheckedChange:S=>{T(S?[...F]:[])},children:"Select All"}),e.jsx(Qe,{}),F.map(S=>e.jsx(Je,{checked:M.includes(S),onCheckedChange:P=>{T(P?[...M,S]:M.filter(j=>j!==S))},children:S},S))]})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{L(),k()},disabled:b,className:"flex-1 px-4 py-2 text-sm bg-primary text-primary-foreground rounded hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-ring disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:`w-4 h-4 ${b?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7",strokeWidth:2}),e.jsx("line",{x1:"16.5",y1:"16.5",x2:"21",y2:"21",strokeWidth:2,strokeLinecap:"round"})]}),"Search"]}),e.jsx("button",{onClick:E,className:"px-4 py-2 text-sm border border-red-300 bg-red-50 text-red-700 rounded hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-500",children:"Clear"}),e.jsx("button",{onClick:k,className:"px-4 py-2 text-sm border border-input bg-background text-foreground rounded hover:bg-accent focus:outline-none focus:ring-2 focus:ring-ring",children:"Cancel"})]})]})})}):null}function qn({show:t,searchTerm:n,setSearchTerm:r,activeSearchTerm:a,setActiveSearchTerm:i,setSearchLineNumbers:l,setExpandedFiles:b,isSearching:w,queue:k,isAtTop:L,clipStart:v,clipEnd:h,mobileClipPlayerComponent:m,selectedWatchDirs:D,setSelectedWatchDirs:M,availableWatchDirs:T,selectedSources:F,setSelectedSources:E,availableSources:S,showAllFiles:P,onToggleShowAllFiles:j,onSearch:V,onClearSearch:q,onScrollToTop:f,onConfigClick:x,onQueueClick:W,onPlayClip:H}){const[g,_]=d.useState(!1),c=Jt(),O=()=>{r(""),i(""),l({}),b(new Set),q()};return e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:`fixed top-0 left-0 right-0 bg-background/95 border-b border-border px-2 sm:px-4 z-10 backdrop-blur-sm ${c?"py-1":"py-2"}`,children:e.jsx("div",{className:"w-full",children:c?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center gap-1",children:[e.jsx("div",{className:"flex items-center flex-shrink-0",children:e.jsx("span",{className:"text-primary font-bold text-lg",children:"atci"})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs(be,{onClick:x,variant:"ghost",size:"sm",className:"px-2 py-1 rounded hover:bg-accent group text-xs gap-1",title:"Edit configuration",children:[e.jsx("svg",{className:"w-4 h-4 group-hover:animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"})}),e.jsx("span",{children:"Config"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs(be,{onClick:W,variant:"ghost",size:"sm",className:"px-2 py-1 rounded hover:bg-accent text-xs gap-1 group",title:"View processing queue",children:[e.jsx("div",{className:"relative w-4 h-4 overflow-hidden",children:e.jsxs("div",{className:"group-hover:animate-[moveUp_1s_linear_infinite] transition-transform",children:[e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"2px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"6px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"10px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"14px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"18px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"22px"}})]})}),e.jsx("span",{children:"Queue"})]}),k.length>0&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1",children:k.length})]}),e.jsxs(be,{onClick:H,disabled:v==null||h===null||h===void 0||!H||m!==null,variant:"ghost",size:"sm",className:"px-2 py-1 rounded hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed text-xs gap-1",title:m!==null?"Clip player is already open":v!=null&&h!==null&&h!==void 0?"Play Clip":"No clip selected",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})}),e.jsx("span",{children:"Clip"})]})]})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"looking for something?",value:n,onChange:R=>{const Q=R.target.value;r(Q),Q.trim()===""&&(i(""),l({}),b(new Set))},onKeyDown:R=>R.key==="Enter"&&V(),className:"w-full px-3 py-1.5 bg-muted text-foreground text-sm rounded-full border border-border focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),(n||a)&&e.jsx("button",{onClick:O,className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-0.5 text-muted-foreground hover:text-foreground transition-colors rounded-full hover:bg-accent",title:"Clear search",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx(be,{onClick:()=>{P&&j(),V()},disabled:w,variant:P&&!a?"secondary":"default",className:`px-3 py-1.5 rounded-full text-sm font-medium disabled:opacity-50 ${P&&!a?"":"bg-primary hover:bg-primary/90 text-primary-foreground"}`,children:w?e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7",strokeWidth:2}),e.jsx("line",{x1:"16.5",y1:"16.5",x2:"21",y2:"21",strokeWidth:2,strokeLinecap:"round"})]}):"Search"}),e.jsx(be,{onClick:()=>{O(),P||j(),f()},variant:P&&!a?"default":"secondary",className:"px-3 py-1.5 rounded-full text-sm font-medium",children:"All"})]})]}):e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"flex items-center flex-shrink-0",children:e.jsx("span",{className:"text-primary font-bold text-lg",children:"atci"})}),e.jsx("div",{className:"flex-1 max-w-md mx-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"looking for something?",value:n,onChange:R=>{const Q=R.target.value;r(Q),Q.trim()===""&&(i(""),l({}),b(new Set))},onKeyDown:R=>R.key==="Enter"&&V(),className:"w-full px-4 py-2 bg-muted text-foreground rounded-full border border-border focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"}),(n||a)&&e.jsx("button",{onClick:O,className:"absolute right-3 top-1/2 transform -translate-y-1/2 p-1 text-muted-foreground hover:text-foreground transition-colors rounded-full hover:bg-accent",title:"Clear search",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex gap-1 items-center flex-shrink-0",children:[e.jsx(be,{onClick:()=>{P&&j(),V()},disabled:w,variant:P&&!a?"secondary":"default",className:`px-4 py-2 rounded-full text-sm font-medium disabled:opacity-50 ${P&&!a?"":"bg-primary hover:bg-primary/90 text-primary-foreground"}`,children:w?e.jsxs("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"11",cy:"11",r:"7",strokeWidth:2}),e.jsx("line",{x1:"16.5",y1:"16.5",x2:"21",y2:"21",strokeWidth:2,strokeLinecap:"round"})]}):"Search"}),e.jsx(be,{onClick:()=>{O(),P||j(),f()},variant:P&&!a?"default":"secondary",className:"px-4 py-2 rounded-full text-sm font-medium",children:"All"}),e.jsxs("div",{className:"relative",children:[e.jsx(be,{onClick:W,variant:"ghost",size:"sm",className:"p-2 rounded-full hover:bg-accent group",title:"View processing queue",children:e.jsx("div",{className:"relative w-5 h-5 overflow-hidden",children:e.jsxs("div",{className:"group-hover:animate-[moveUp_1s_linear_infinite] transition-transform",children:[e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"3px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"8px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"13px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"18px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"23px"}}),e.jsx("div",{className:"absolute left-0 right-0 h-px bg-current rounded-full",style:{top:"28px"}})]})})}),k.length>0&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full min-w-[18px] h-[18px] flex items-center justify-center px-1",children:k.length})]}),e.jsx(be,{onClick:x,variant:"ghost",size:"sm",className:"p-2 rounded-full hover:bg-accent group",title:"Edit configuration",children:e.jsx("svg",{className:"w-5 h-5 group-hover:animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"})})})]})]})})}),e.jsx(Vn,{searchTerm:n,setSearchTerm:r,activeSearchTerm:a,setActiveSearchTerm:i,setSearchLineNumbers:l,setExpandedFiles:b,isSearching:w,isOpen:g,onClose:()=>_(!1),onSearch:V,onClearSearch:q,selectedWatchDirs:D,setSelectedWatchDirs:M,availableWatchDirs:T,selectedSources:F,setSelectedSources:E,availableSources:S})]})}const Mt=({isOpen:t,filename:n,transcriptInitialValue:r,onTranscriptSave:a,onCancel:i,isTranscriptSubmitting:l,transcriptTargetLineNumber:b})=>{const[w,k]=u.useState(r),L=u.useRef(null);u.useEffect(()=>{t&&k(r)},[t,r]),u.useEffect(()=>{t&&b&&L.current&&setTimeout(()=>{const h=L.current;if(!h)return;const m=h.value.split(`
`);if(b<=m.length){let D=0;for(let F=0;F<b-1;F++)D+=m[F].length+1;h.setSelectionRange(D,D),h.focus();const M=h.scrollHeight/m.length,T=(b-1)*M;h.scrollTop=T-h.clientHeight/2}},100)},[t,b]);const v=()=>{a(w)};return t?e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-card border border-border rounded-lg max-w-5xl w-full mx-4 max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-border",children:[e.jsxs("h3",{className:"text-lg font-semibold text-foreground",children:["Edit Transcript - ",n]}),e.jsx("button",{onClick:i,className:"p-1 text-muted-foreground hover:text-foreground hover:bg-accent rounded transition-colors",title:"Close",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"text-md font-medium text-foreground",children:"Transcript (.txt)"}),e.jsx("button",{onClick:v,disabled:l,className:"px-3 py-1.5 text-xs font-normal text-primary-foreground bg-primary border border-transparent rounded hover:bg-primary/90 disabled:opacity-50 transition-colors",children:l?"Saving...":"Save Transcript"})]}),e.jsx("textarea",{ref:L,value:w,onChange:h=>k(h.target.value),className:"w-full h-64 p-3 border border-input bg-background text-foreground rounded-md font-mono text-sm leading-6 focus:outline-none focus:ring-2 focus:ring-ring focus:border-transparent",placeholder:"Enter transcript content...",readOnly:l})]})})]})}):null},zt=({open:t,onOpenChange:n,selectedTime:r,clipStart:a,clipEnd:i,clipTranscript:l,currentTranscript:b,onSetClipStart:w,onSetClipEnd:k,onClearClip:L,onClipBlock:v,blockStartTime:h,blockEndTime:m,children:D})=>{const M=l!==null&&l!==b,T=!M&&i!==null&&r>=i,F=!M&&a!==null&&r<=a;return e.jsxs(Fe,{modal:!1,open:t,onOpenChange:n,children:[e.jsx(He,{asChild:!0,children:D}),e.jsxs(ze,{align:"start",side:"right",sideOffset:8,children:[e.jsxs(we,{onClick:()=>w(r),disabled:T,className:`flex items-center gap-2 ${T?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(yt,{size:16,className:"text-green-600"}),"Set Clip Start"]}),e.jsxs(we,{onClick:()=>k(r),disabled:F,className:`flex items-center gap-2 ${F?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(yt,{size:16,className:"text-red-600"}),"Set Clip End"]}),v&&h!==void 0&&m!==void 0&&e.jsxs(we,{onClick:()=>v(h,m),className:"flex items-center gap-2",children:[e.jsx(yt,{size:16,className:"text-purple-600"}),"Clip Block"]}),(a!==null||i!==null)&&e.jsxs(we,{onClick:L,className:"flex items-center gap-2",children:[e.jsx(An,{size:16,className:"text-gray-600"}),"Clear Clip"]})]})]})},Yn=u.memo(({startTime:t,endTime:n,visible:r,text:a,name:i,fullPath:l,isSearchResult:b=!1,lineNumbers:w,onEditSuccess:k,fullTranscript:L="",isSmallScreen:v=!1,onSetRightPaneUrl:h,clipStart:m,clipEnd:D,clipTranscript:M,onSetClipStart:T,onSetClipEnd:F,onClearClip:E,onClipBlock:S})=>{const[P,j]=u.useState(!1),[V,q]=u.useState(!1),[f,x]=u.useState(!1),[W,H]=u.useState(null),[g,_]=u.useState(null),[c,O]=u.useState(!1),[R,Q]=u.useState(null),N=p=>{const o=p.split(":"),U=parseInt(o[0],10),X=parseInt(o[1],10),ce=o[2].split("."),ne=parseInt(ce[0],10),Pe=parseInt(ce[1]||"0",10);return U*3600+X*60+ne+Pe/1e3},se=u.useMemo(()=>{if(!t||!n||m===null||m===void 0||M!==i)return!1;const p=N(t),o=N(n);return m>=p&&m<=o},[t,n,m,M,i]),te=u.useMemo(()=>{if(!t||!n||D===null||D===void 0||M!==i)return!1;const p=N(t),o=N(n);return D>=p&&D<=o},[t,n,D,M,i]),ke=u.useMemo(()=>{if(!t||!n||m===null||m===void 0||D===null||D===void 0||M!==l)return!1;const p=N(t),o=N(n);return p>=m&&o<=D},[t,n,m,D,M,i]),ie=se||te||ke,xe=(p,o)=>{Q({time:p,type:o}),O(!0)};if(u.useEffect(()=>{},[a]),u.useEffect(()=>{},[t,n]),u.useEffect(()=>{const p=o=>{const U=o.target;if(U.classList.contains("timestamp-link")){o.preventDefault();const X=U.getAttribute("data-url");X&&h&&h(X)}};return document.addEventListener("click",p),()=>{document.removeEventListener("click",p)}},[h]),!r||a==="WEBVTT")return null;const le=u.useMemo(()=>{const p=/(\d{2}:\d{2}:\d{2}\.\d{3})/g;return a.replace(p,o=>{const U=N(o);return`<span class="text-sky-700 hover:text-sky-600 underline cursor-pointer timestamp-link" data-timestamp="${o}" data-url="/player/${encodeURIComponent(i)}?time=${U}">${o}</span>`})},[a,i]),je=()=>{j(!0)},re=async p=>{var o;if(p.trim()===L.trim()){j(!1);return}q(!0);try{const U=(o=document.querySelector('meta[name="csrf-token"]'))==null?void 0:o.getAttribute("content"),X=await fetch(Ve("/api/transcripts/replace"),{method:"POST",headers:{"X-CSRF-Token":U||"","Content-Type":"application/json"},body:JSON.stringify({video_path:i,new_content:p})});if(X.ok)k&&k(),j(!1);else{const ce=await X.json();alert(`Error: ${ce.error||"Failed to update transcript"}`)}}catch(U){console.error("Error updating transcript:",U),alert("Error: Failed to update transcript. Please try again.")}finally{q(!1)}},$e=()=>{j(!1)},de=()=>{x(!0)},Ce=async p=>{var o;if(p.trim()===L.trim()){x(!1);return}q(!0);try{const U=(o=document.querySelector('meta[name="csrf-token"]'))==null?void 0:o.getAttribute("content"),X=await fetch(Ve("/api/transcripts/replace"),{method:"POST",headers:{"X-CSRF-Token":U||"","Content-Type":"application/json"},body:JSON.stringify({video_path:l,new_content:p})});if(X.ok)k&&k(),x(!1);else{const ce=await X.json();alert(`Error: ${ce.error||"Failed to update timestamp"}`)}}catch(U){console.error("Error updating timestamp:",U),alert("Error: Failed to update timestamp. Please try again.")}finally{q(!1)}},ue=()=>{x(!1)};if(t&&n&&t===n)return e.jsx(e.Fragment,{});const Ne=w[0],ae=w[w.length-1],C=()=>{const p=[];return b&&ie?p.push("bg-gradient-to-r","from-primary/10","to-amber-500/10","border-l-4","border-primary","pl-2"):b?p.push("bg-primary/10","border-l-4","border-primary","pl-2"):ie&&p.push("bg-amber-500/10","border-l-4","border-amber-500","pl-2"),p.join(" ")};return e.jsxs("div",{className:C(),children:[ie&&e.jsx("div",{className:"flex items-center gap-1 text-xs text-amber-600 dark:text-amber-400 mb-1",children:e.jsx("span",{className:"bg-amber-500/20 px-1 py-0.5 rounded text-amber-700 dark:text-amber-300 font-medium",children:"Clip"})}),t&&n&&e.jsx("div",{className:"group",children:e.jsxs("span",{className:"relative",children:[e.jsx("div",{className:"flex items-center gap-1 min-w-0",children:e.jsxs("div",{className:"text-muted-foreground text-sm font-mono flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:`text-xs mr-2 flex-shrink-0 text-right w-8 cursor-pointer transition-colors duration-200 ${W===Ne||g==="timestamp"?"text-blue-600 hover:text-blue-700":"text-muted-foreground hover:text-blue-500"}`,onClick:()=>_(g==="timestamp"?null:"timestamp"),onMouseEnter:()=>H(Ne),onMouseLeave:()=>H(null),children:Ne}),e.jsxs("span",{className:"min-w-0",children:[e.jsx(zt,{open:c&&(R==null?void 0:R.type)==="start",onOpenChange:p=>{O(p),p||Q(null)},selectedTime:(R==null?void 0:R.time)||(t?N(t):0),clipStart:m??null,clipEnd:D??null,clipTranscript:M??null,currentTranscript:i,onSetClipStart:T||(()=>{}),onSetClipEnd:F||(()=>{}),onClearClip:E||(()=>{}),onClipBlock:S?(p,o)=>S(p,o,a,l):void 0,blockStartTime:t?N(t):void 0,blockEndTime:n?N(n):void 0,children:e.jsx("span",{onClick:()=>t&&xe(N(t),"start"),className:"text-sky-700 hover:text-sky-600 underline cursor-pointer",onMouseEnter:()=>H(Ne),onMouseLeave:()=>H(null),children:t})})," --> ",e.jsx(zt,{open:c&&(R==null?void 0:R.type)==="end",onOpenChange:p=>{O(p),p||Q(null)},selectedTime:(R==null?void 0:R.time)||(n?N(n):0),clipStart:m??null,clipEnd:D??null,clipTranscript:M??null,currentTranscript:i,onSetClipStart:T||(()=>{}),onSetClipEnd:F||(()=>{}),onClearClip:E||(()=>{}),onClipBlock:S?(p,o)=>S(p,o,a,l):void 0,blockStartTime:t?N(t):void 0,blockEndTime:n?N(n):void 0,children:e.jsx("span",{onClick:()=>n&&xe(N(n),"end"),className:"text-sky-700 hover:text-sky-600 underline cursor-pointer",onMouseEnter:()=>H(Ne),onMouseLeave:()=>H(null),children:n})})]})]})}),e.jsx("div",{className:"flex items-center gap-1 min-w-0",children:e.jsxs("div",{className:"text-muted-foreground text-sm font-mono flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("span",{className:`text-xs mr-2 flex-shrink-0 text-right w-8 cursor-pointer transition-colors duration-200 ${W===ae||g==="content"?"text-blue-600 hover:text-blue-700":"text-muted-foreground hover:text-blue-500"}`,onClick:()=>_(g==="content"?null:"content"),onMouseEnter:()=>H(ae),onMouseLeave:()=>H(null),children:ae}),e.jsx("div",{className:"text-foreground font-mono text-sm leading-relaxed whitespace-pre-wrap break-words flex-1 min-w-0",dangerouslySetInnerHTML:{__html:le},onMouseEnter:()=>H(ae),onMouseLeave:()=>H(null)})]})}),g&&e.jsx("div",{className:"absolute left-0 top-0 z-10 dropdown-menu-container",children:e.jsxs(Fe,{modal:!1,open:g==="timestamp"||g==="content",onOpenChange:p=>!p&&_(null),children:[e.jsx(He,{asChild:!0,children:e.jsx("div",{className:"invisible"})}),e.jsxs(ze,{align:"start",side:"right",sideOffset:8,children:[e.jsx(we,{asChild:!0,children:e.jsxs("a",{href:`/api/frame?filename=${encodeURIComponent(l)}&time=${N(t)+(N(n)-N(t))/2}&text=${encodeURIComponent(a)}`,target:"_blank",className:"flex items-center gap-2 w-full",children:[e.jsx(Bn,{size:16,className:"text-[#6d28d9]"}),"View Frame"]})}),e.jsxs(we,{onClick:()=>de(),className:"flex items-center gap-2",children:[e.jsx(Ft,{size:16,className:"text-[#3b82f6]"}),"Edit Line"]})]})]})})]})}),a!=null&&!t&&!n&&e.jsx("div",{className:"group",children:e.jsxs("span",{className:"relative",children:[e.jsx("div",{className:"flex items-center gap-1 min-w-0",children:e.jsxs("div",{className:"text-muted-foreground text-sm font-mono flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("span",{className:`text-xs mr-2 flex-shrink-0 text-right w-8 cursor-pointer transition-colors duration-200 ${W===ae||g==="content"?"text-blue-600 hover:text-blue-700":"text-muted-foreground hover:text-blue-500"}`,onClick:()=>_(g==="content"?null:"content"),onMouseEnter:()=>H(ae),onMouseLeave:()=>H(null),children:ae}),e.jsx("div",{className:"text-foreground font-mono text-sm leading-relaxed whitespace-pre-wrap break-words flex-1 min-w-0",dangerouslySetInnerHTML:{__html:le},onMouseEnter:()=>H(ae),onMouseLeave:()=>H(null)})]})}),g==="content"&&e.jsx("div",{className:"absolute left-0 top-0 z-10 dropdown-menu-container",children:e.jsxs(Fe,{modal:!1,open:!0,onOpenChange:p=>!p&&_(null),children:[e.jsx(He,{asChild:!0,children:e.jsx("div",{className:"invisible"})}),e.jsx(ze,{align:"start",side:"right",sideOffset:8,children:e.jsxs(we,{onClick:je,className:"flex items-center gap-2",children:[e.jsx(Ft,{size:16,className:"text-[#3b82f6]"}),"Edit Line"]})})]})})]})}),e.jsx(Mt,{isOpen:P,filename:l,transcriptInitialValue:L,onTranscriptSave:re,onCancel:$e,isTranscriptSubmitting:V,transcriptTargetLineNumber:ae}),e.jsx(Mt,{isOpen:f,filename:l,transcriptInitialValue:L,onTranscriptSave:Ce,onCancel:ue,isTranscriptSubmitting:V,transcriptTargetLineNumber:Ne})]})}),Kt=({visible:t=!1,name:n,fullPath:r,className:a="",searchTerm:i="",text:l="",loading:b=!1,error:w=null,visibleLines:k=[],expandContext:L,onEditSuccess:v,isSmallScreen:h=!1,onSetRightPaneUrl:m,clipStart:D,clipEnd:M,clipTranscript:T,onSetClipStart:F,onSetClipEnd:E,onClearClip:S,onClipBlock:P})=>{const j=u.useRef(null),V=g=>{const _=/\d{2}:\d{2}:\d{2}\.\d{3}/g,c=g.match(_);return c&&c.length>=2&&g.includes("-->")?{hasRange:!0,time1:c[0],time2:c[1]}:{hasRange:!1}},q=(g,_)=>{const c=g.split(`
`).flatMap(N=>N.split("\r")),O=[],R=i.toLowerCase(),Q=_.length===1&&_[0]===-1||_.length===0;for(let N=0;N<c.length;N++){const se=c[N],te=V(se);if(te.hasRange&&te.time1&&te.time2){const ke=N<c.length-1?c[N+1]:"",ie=ke.toLowerCase(),xe=i?ie.includes(R):!1,le=[N+1,N+2],je=Q||le.some(re=>_.includes(re));O.push({startTime:te.time1,endTime:te.time2,text:ke,visible:je,isSearchResult:xe,originalIndex:O.length,lineNumbers:le}),N++}else{const ke=se.toLowerCase(),ie=i?ke.includes(R):!1,xe=[N+1],le=Q||xe.some(je=>_.includes(je));O.push({text:se,visible:le,isSearchResult:ie,originalIndex:O.length,lineNumbers:xe})}}return O},f=u.useMemo(()=>q(l,k),[l,k,i]),x=u.useMemo(()=>{const g=k.length===1&&k[0]===-1;if(k.length===0||g)return f.map(O=>({type:"block",data:O}));const _=[];let c=0;for(let O=0;O<f.length;O++){const R=f[O];if(R.visible){c>0&&(_.push({type:"message",data:{count:c,line:R.lineNumbers[R.lineNumbers.length-1],direction:"up"}}),c=0),_.push({type:"block",data:R});let Q=0;for(let N=O+1;N<f.length;N++){const se=f[N];if(se.visible)break;Q+=se.lineNumbers.length}Q>0&&_.push({type:"message",data:{count:Q,line:R.lineNumbers[R.lineNumbers.length-1],direction:"down"}})}else c+=R.lineNumbers.length}return _},[f,k]),W=u.useMemo(()=>x.map((g,_)=>({...g,virtualIndex:_,originalIndex:_})),[x]),H=(g,_)=>{L(r,_,g)};return t?e.jsx("div",{className:`w-full ${h?"px-4 py-4 bg-transparent":"p-3 sm:p-6 bg-card border border-border"} ${a}`,children:e.jsxs("div",{className:"space-y-4",children:[b&&e.jsx("div",{className:"text-muted-foreground",children:"Loading transcript..."}),w&&e.jsxs("div",{className:"text-destructive",children:["Error: ",w]}),!b&&!w&&e.jsxs("div",{className:"text-muted-foreground text-left relative",children:[i&&f.filter(g=>g.isSearchResult).length===0&&e.jsxs("div",{className:"text-muted-foreground italic",children:['No matches found for "',i,'" in this transcript.']}),f.length>0&&e.jsx("div",{ref:j,className:"space-y-0.5 max-h-[600px] overflow-y-auto",style:{WebkitOverflowScrolling:"touch",scrollBehavior:"smooth"},children:W.map(g=>e.jsx("div",{children:g.type==="block"?e.jsx(Yn,{fullPath:r,startTime:g.data.startTime,endTime:g.data.endTime,visible:g.data.visible,text:g.data.text,name:n,isSearchResult:g.data.isSearchResult,lineNumbers:g.data.lineNumbers,onEditSuccess:v,fullTranscript:l,isSmallScreen:h,onSetRightPaneUrl:m,clipStart:D,clipEnd:M,clipTranscript:T,onSetClipStart:F,onSetClipEnd:E,onClearClip:S,onClipBlock:P}):e.jsx("div",{className:"text-muted-foreground italic",children:e.jsxs("span",{className:"cursor-pointer hover:text-primary hover:underline",onClick:()=>H(g.data.line,g.data.direction),children:["[",g.data.count," lines ",g.data.direction==="up"?"above":"below","]"]})})},g.type==="block"?`${g.data.originalIndex}-${g.virtualIndex}`:`message-${g.virtualIndex}`))})]})]})}):null},bt=d.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Te("rounded-xl border bg-card text-card-foreground shadow",t),...n}));bt.displayName="Card";const Zt=d.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Te("flex flex-col space-y-1.5 p-6",t),...n}));Zt.displayName="CardHeader";const Xn=d.forwardRef(({className:t,...n},r)=>e.jsx("h3",{ref:r,className:Te("font-semibold leading-none tracking-tight",t),...n}));Xn.displayName="CardTitle";const Gn=d.forwardRef(({className:t,...n},r)=>e.jsx("p",{ref:r,className:Te("text-sm text-muted-foreground",t),...n}));Gn.displayName="CardDescription";const wt=d.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Te("p-6 pt-0",t),...n}));wt.displayName="CardContent";const en=d.forwardRef(({className:t,...n},r)=>e.jsx("div",{ref:r,className:Te("flex items-center p-6 pt-0",t),...n}));en.displayName="CardFooter";function Tt({isOpen:t,videoPath:n,source:r,onClose:a,onRegenerate:i}){var V,q;const[,l]=d.useState([]),[,b]=d.useState([]),[w,k]=d.useState([]),[L,v]=d.useState(""),[h,m]=d.useState(!1),[D,M]=d.useState(null),[T,F]=d.useState(!1),E=f=>{if(!r)return!1;if(f.type==="subtitle"){const x=r.match(/subtitles.*\((\d+)\)/);return!!(x&&parseInt(x[1])===f.subtitle_stream_index)}else if(f.type==="whisper")return r===f.model;return!1};d.useEffect(()=>{t&&n&&S()},[t,n]);const S=async()=>{m(!0),M(null);try{const[f,x]=await Promise.all([fetch(Ve(`/api/video/subtitle-streams?path=${encodeURIComponent(n)}`)),fetch(Ve("/api/models/list"))]);let W=[],H=[];if(f.ok){const c=await f.json();c.success&&(W=c.data)}if(x.ok){const c=await x.json();c.success&&(H=c.data.filter(O=>O.downloaded))}l(W),b(H);const g=[];W.forEach(c=>{const O=c.language||"Unknown",R={id:`subtitle_${c.index}`,type:"subtitle",label:`Subtitles: ${O} (${c.index})`,subtitle_stream_index:c.index};E(R)&&(R.label+=" (last used)"),g.push(R)}),H.forEach(c=>{const O={id:`whisper_${c.name}`,type:"whisper",label:`${c.name}`,model:c.name};E(O)&&(O.label+=" (last used)"),g.push(O)}),k(g);const _=g.find(c=>E(c));v(_?_.id:"")}catch(f){console.error("Error fetching regeneration data:",f),M("Failed to load regeneration options")}finally{m(!1)}},P=async()=>{if(!L)return;const f=w.find(x=>x.id===L);if(f){F(!0);try{await i(f.type==="whisper"?f.model:void 0,f.type==="subtitle"?f.subtitle_stream_index:void 0),a()}catch(x){console.error("Regeneration failed:",x),M("Failed to regenerate transcript")}finally{F(!1)}}},j=()=>{T||a()};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background border border-border rounded-lg p-6 w-96 max-w-90vw max-h-80vh overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Regenerate Transcript"}),e.jsx("button",{onClick:j,disabled:T,className:"text-muted-foreground hover:text-foreground disabled:opacity-50",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose a processing method for: ",((V=n.split("/").pop())==null?void 0:V.split("\\").pop())||n]}),h&&e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Loading options..."]})}),D&&e.jsx("div",{className:"text-sm text-destructive mb-4 p-3 bg-destructive/10 border border-destructive/20 rounded",children:D}),!h&&!D&&w.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground mb-4 p-3 bg-muted border border-border rounded",children:"No processing options available. Make sure you have subtitle streams or downloaded Whisper models."}),!h&&!D&&w.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2 mb-6",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Processing Method:"}),e.jsxs(Fe,{children:[e.jsx(He,{asChild:!0,children:e.jsxs(be,{variant:"outline",className:"w-full justify-between",disabled:T,children:[L&&((q=w.find(f=>f.id===L))==null?void 0:q.label)||"Select a processing method...",e.jsx("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsx(ze,{className:"w-full min-w-[400px]",children:w.map(f=>e.jsxs(we,{onClick:()=>v(f.id),className:"flex flex-col items-start p-3",children:[e.jsx("div",{className:"font-medium",children:f.label}),e.jsx("div",{className:"text-xs text-muted-foreground",children:f.type==="subtitle"?"Extract from embedded subtitles":"AI transcription"})]},f.id))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:j,disabled:T,className:"px-4 py-2 text-sm border border-input bg-background text-foreground rounded hover:bg-accent focus:outline-none focus:ring-1 focus:ring-ring disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{onClick:P,disabled:T||!L,className:"px-4 py-2 text-sm bg-primary text-primary-foreground rounded hover:bg-primary/90 focus:outline-none focus:ring-1 focus:ring-ring disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:T?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Regenerating..."]}):"Regenerate"})]})]})]})}):null}function Qn({file:t,onExpand:n,isExpanded:r,isRegenerating:a,isReplacing:i,isProcessing:l,onRegenerate:b,onReplace:w,onRename:k,onRegenerateMeta:L,formatDate:v,getSourceChipColor:h,isSmallScreen:m=!1,mobileTranscriptRowRefs:D}){var j;const[M,T]=d.useState(!1),F=((j=t.name.split("/").pop())==null?void 0:j.split("\\").pop())||t.name,E=V=>{V.stopPropagation(),T(!0)},S=async(V,q)=>{await b({stopPropagation:()=>{}},V,q)};if(m){const V=e.jsxs("div",{className:"w-full bg-background py-4 px-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1 mr-2 min-w-0 text-left",id:"ref",ref:q=>{D.current[t.base_name]=q},children:[e.jsx("h3",{className:"font-medium text-base break-all overflow-hidden text-left",title:t.name,children:F}),t.source&&e.jsx("div",{className:"text-left",children:e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium mt-2 ${h(t.source)}`,children:t.source})})]}),e.jsxs(Fe,{modal:!1,children:[e.jsx(He,{asChild:!0,children:e.jsx("button",{onClick:q=>q.stopPropagation(),className:"p-2 text-muted-foreground hover:text-primary hover:bg-accent rounded-md transition-colors",title:"Actions",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})}),e.jsxs(ze,{align:"end",children:[e.jsxs(we,{onClick:q=>k(q),disabled:l||a||i,children:[e.jsx("span",{children:"Rename"}),e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]}),t.transcript&&e.jsxs(we,{onClick:q=>w(q),disabled:i,className:"text-blue-600 hover:text-blue-700",children:[e.jsx("span",{children:"Edit transcript"}),!i&&e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})]}),t.transcript&&e.jsxs(we,{onClick:E,disabled:a,className:"text-green-600 hover:text-green-700",children:[e.jsx("span",{children:"Regenerate transcript"}),a?e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]}),l&&e.jsxs(we,{disabled:!0,children:[e.jsx("span",{children:"Processing transcript..."}),e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]})]})]})]}),e.jsx("div",{className:"space-y-3 mb-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"min-w-0 text-left",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Date:"}),e.jsx("div",{className:"font-medium break-words text-xs",children:v(t.created_at)})]}),e.jsxs("div",{className:"min-w-0 text-left",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Last Generated:"}),e.jsx("div",{className:"font-medium break-words text-xs",children:v(t.last_generated||"")})]}),e.jsxs("div",{className:"min-w-0 text-left",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Lines:"}),e.jsx("div",{className:"font-medium text-xs",children:t.line_count||0})]}),e.jsxs("div",{className:"min-w-0 text-left",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Length:"}),e.jsx("div",{className:"font-medium flex items-center gap-1 text-xs",children:t.length?t.length:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"-"}),e.jsx("button",{onClick:q=>L(q),disabled:a,className:"p-1 text-muted-foreground hover:text-primary hover:bg-accent rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate video length",children:a?e.jsx("svg",{className:"w-3 h-3 animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})})]})]})}),t.transcript&&e.jsx("button",{onClick:n,className:"w-full px-4 py-2 text-sm font-medium text-primary-foreground bg-primary hover:bg-primary/90 rounded-md transition-colors flex items-center justify-center gap-2",children:r?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Hide Transcript"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Show Transcript"]})})]});return e.jsxs(e.Fragment,{children:[V,e.jsx(Tt,{isOpen:M,videoPath:t.full_path||t.name,source:t.source,onClose:()=>T(!1),onRegenerate:S})]})}const P=e.jsxs(bt,{className:"w-full",children:[e.jsx(Zt,{className:"pb-3",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 mr-2 min-w-0",children:[e.jsx("h3",{className:"font-medium text-base break-all overflow-hidden",title:t.name,children:F}),t.source&&e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium mt-2 ${h(t.source)}`,children:t.source})]}),e.jsxs(Fe,{modal:!1,children:[e.jsx(He,{asChild:!0,children:e.jsx("button",{onClick:V=>V.stopPropagation(),className:"p-2 text-muted-foreground hover:text-primary hover:bg-accent rounded-md transition-colors",title:"Actions",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})}),e.jsxs(ze,{align:"end",children:[e.jsxs(we,{onClick:V=>k(V),disabled:l||a||i,children:[e.jsx("span",{children:"Rename"}),e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]}),t.transcript&&e.jsxs(we,{onClick:V=>w(V),disabled:i,className:"text-blue-600 hover:text-blue-700",children:[e.jsx("span",{children:"Edit transcript"}),!i&&e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})]}),t.transcript&&e.jsxs(we,{onClick:E,disabled:a,className:"text-green-600 hover:text-green-700",children:[e.jsx("span",{children:"Regenerate transcript"}),a?e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]}),l&&e.jsxs(we,{disabled:!0,children:[e.jsx("span",{children:"Processing transcript..."}),e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]})]})]})]})}),e.jsx(wt,{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-muted-foreground",children:"Date:"}),e.jsx("div",{className:"font-medium break-words",children:v(t.created_at)})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Generated:"}),e.jsx("div",{className:"font-medium break-words",children:v(t.last_generated||"")})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-muted-foreground",children:"Lines:"}),e.jsx("div",{className:"font-medium",children:t.line_count||0})]}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("span",{className:"text-muted-foreground",children:"Length:"}),e.jsx("div",{className:"font-medium flex items-center justify-center gap-1",children:t.length?t.length:e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"-"}),e.jsx("button",{onClick:V=>L(V),disabled:a,className:"p-1 text-muted-foreground hover:text-primary hover:bg-accent rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate video length",children:a?e.jsx("svg",{className:"w-3 h-3 animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})})]})]})}),t.transcript&&e.jsx(en,{className:"pt-3",children:e.jsx("button",{onClick:n,className:"w-full px-4 py-2 text-sm font-medium text-primary-foreground bg-primary hover:bg-primary/90 rounded-md transition-colors flex items-center justify-center gap-2",children:r?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Hide Transcript"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Show Transcript"]})})})]});return e.jsxs(e.Fragment,{children:[P,e.jsx(Tt,{isOpen:M,videoPath:t.full_path||t.name,source:t.source,onClose:()=>T(!1),onRegenerate:S})]})}function Jn({sortedFiles:t,activeSearchTerm:n,searchResults:r,showAllFiles:a,transcriptData:i,expandedFiles:l,searchLineNumbers:b,onExpandFile:w,onRegenerate:k,onReplace:L,onRename:v,onFetchTranscript:h,onSetRightPaneUrl:m,formatDate:D,getSourceChipColor:M,expandContext:T,clipStart:F,clipEnd:E,clipTranscript:S,onSetClipStart:P,onSetClipEnd:j,onClearClip:V,onClipBlock:q,mobileTranscriptRowRefs:f}){return e.jsx("div",{className:"divide-y divide-border",children:t.map(x=>{if(!(n?r.includes(x.full_path):a))return null;const H=i[x.full_path]||{text:"",loading:!1,error:null},g=l.has(x.full_path);return e.jsxs("div",{className:"w-full",children:[e.jsx("div",{id:"ref",children:e.jsx(Qn,{file:x,onExpand:()=>w(x.full_path),isExpanded:g,isRegenerating:!x.transcript,isReplacing:!x.transcript,isProcessing:!1,onRegenerate:_=>k(x.full_path,x.source,_),onReplace:_=>L(x.full_path,_),onRename:_=>v(x.full_path,_),onRegenerateMeta:_=>k(x.full_path,x.source,_),formatDate:D,getSourceChipColor:M,isSmallScreen:!0,mobileTranscriptRowRefs:f})}),g&&e.jsx(Kt,{visible:!0,name:x.base_name,fullPath:x.full_path,className:"w-full",searchTerm:n,text:H.text,loading:H.loading,error:H.error,visibleLines:b[x.full_path]||[],expandContext:T,onEditSuccess:()=>{h(x.full_path)},isSmallScreen:!0,onSetRightPaneUrl:m,clipStart:F,clipEnd:E,clipTranscript:S,onSetClipStart:_=>P(_,x.full_path),onSetClipEnd:_=>j(_,x.full_path),onClearClip:V,onClipBlock:q})]},x.base_name)})})}function Kn({watchDirectory:t,isSmallScreen:n,activeSearchTerm:r,searchLineNumbers:a,setSearchLineNumbers:i,expandedFiles:l,setExpandedFiles:b,currentProcessingFile:w,showAllFiles:k,leftPaneWidth:L,setLeftPaneWidth:v,isLeftPaneWidthMeasured:h,setIsLeftPaneWidthMeasured:m,clipStart:D,clipEnd:M,clipTranscript:T,fileRowRefs:F,transcriptRowRefs:E,mobileTranscriptRowRefs:S,leftPaneRef:P,onSetRightPaneUrl:j,onSetClipStart:V,onSetClipEnd:q,onClearClip:f,onClipBlock:x}){var At;const{files:W,refreshFiles:H,selectedWatchDirs:g,setSelectedWatchDirs:_,availableWatchDirs:c,selectedSources:O,setSelectedSources:R,availableSources:Q,page:N,setPage:se,pageSize:te,setPageSize:ke,sortColumn:ie,setSortColumn:xe,sortDirection:le,setSortDirection:je,totalPages:re,totalRecords:$e,transcriptData:de,fetchTranscript:Ce}=Qt(),[ue,Ne]=d.useState(!1),[ae,C]=d.useState(!1),[p,o]=d.useState(""),[U,X]=d.useState(""),[ce,ne]=d.useState(!1),[Pe,Se]=d.useState(!1),[Ae,Ke]=d.useState(""),[Re,Xe]=d.useState(""),[_e,Ze]=d.useState(!1),[st,Me]=d.useState(""),[ot,et]=d.useState(!1),[Ee,De]=d.useState(""),[We,Oe]=d.useState(void 0),it=s=>{var y;return w?((y=w.video_path.split("/").pop())==null?void 0:y.replace(/\.(mp4|MP4)$/,""))===s:!1},Be=Object.keys(a).filter(s=>a[s]&&a[s].length>0),Ie=n||h&&L<753;d.useEffect(()=>{if(!P.current)return;const s=new ResizeObserver(A=>{for(const y of A)v(y.contentRect.width),m(!0)});return s.observe(P.current),()=>{s.disconnect()}},[v,m]),d.useEffect(()=>{$()},[l]);const qe=[...W].sort((s,A)=>{let y,I;switch(ie){case"created_at":y=s.created_at||"",I=A.created_at||"";break;case"last_generated":y=s.last_generated||"",I=A.last_generated||"";break;case"name":y=s.name||"",I=A.name||"";break;case"line_count":y=s.line_count||0,I=A.line_count||0;break;case"length":y=s.length||"0:00",I=A.length||"0:00";break;case"source":y=s.source||"",I=A.source||"";break;default:return 0}if(ie==="created_at"||ie==="last_generated"){const B=new Date(y.replace(" ","T")).getTime(),K=new Date(I.replace(" ","T")).getTime();return le==="asc"?B-K:K-B}return typeof y=="string"&&typeof I=="string"?le==="asc"?y.localeCompare(I):I.localeCompare(y):le==="asc"?y-I:I-y}),z=(s,A,y)=>{const I=a[s];if(!I)return;const B=[...I];if(A==="up")for(let K=1;K<=16;K++){const G=y-K;G>0&&!B.includes(G)&&B.push(G)}else for(let K=1;K<=16;K++){const G=y+K;B.includes(G)||B.push(G)}i(K=>({...K,[s]:B}))},Z=s=>{ie===s?je(A=>A==="asc"?"desc":"asc"):(xe(s),je("asc"))},ee=s=>ie!==s?e.jsx("svg",{className:"w-4 h-4 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}):le==="asc"?e.jsx("svg",{className:"w-4 h-4 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):e.jsx("svg",{className:"w-4 h-4 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),J=s=>{if(!s)return"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300";const A={tiny:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",base:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",small:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",medium:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",large:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",subtitles:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-200",manual:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200"};for(const[y,I]of Object.entries(A))if(s.includes(y))return I;return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"},oe=(s,A=!0)=>{if(!s||s==="N/A")return"N/A";try{const y=new Date(s.replace(" ","T"));if(isNaN(y.getTime()))return"N/A";const I=(y.getMonth()+1).toString().padStart(2,"0"),B=y.getDate().toString().padStart(2,"0"),K=y.getFullYear();if(!A)return`${I}-${B}-${K}`;let G=y.getHours();const Ue=y.getMinutes().toString().padStart(2,"0"),ct=G>=12?"pm":"am";return G=G%12,G=G||12,`${I}-${B}-${K} ${G}:${Ue}${ct}`}catch{return"N/A"}},$=async()=>{const A=Array.from(l).filter(y=>{const I=de[y];return!I||!I.loading&&!I.text&&!I.error});await Promise.all(A.map(y=>Ce(y)))},Y=(s,A,y)=>{y.stopPropagation(),De(s),Oe(A),et(!0)},pe=async(s,A)=>{await ge(Ee,{stopPropagation:()=>{}},s,A)},ge=async(s,A,y,I)=>{var K;A.stopPropagation();const B=(K=document.querySelector('meta[name="csrf-token"]'))==null?void 0:K.getAttribute("content");try{const G={video_path:s};y&&(G.model=y),I!==void 0&&(G.subtitle_stream_index=I);const Ue=await fetch(Ve("/api/transcripts/regenerate"),{method:"POST",headers:{"X-CSRF-Token":B||"","Content-Type":"application/json"},body:JSON.stringify(G)});if(Ue.ok)await H();else{const ct=await Ue.json().catch(()=>({error:"Unknown error"}));console.error("Failed to regenerate transcript:",ct.error),alert(`Failed to regenerate transcript: ${ct.error}`)}}catch(G){console.error("Regeneration error:",G),alert("Error regenerating transcript. Please try again.")}},Le=async(s,A)=>{A.stopPropagation();try{const y=await fetch(Ve(`/api/transcripts?video_path=${encodeURIComponent(s)}`));if(y.ok){const I=await y.json();if(I.success){const B=I.data;o(s),X(B),C(!0)}else throw new Error(I.error)}else throw new Error("Failed to fetch transcript")}catch(y){console.error("Error fetching transcript for replacement:",y),alert("Error loading transcript. Please try again.")}finally{}},me=async s=>{var A;ne(!0);try{const y=(A=document.querySelector('meta[name="csrf-token"]'))==null?void 0:A.getAttribute("content"),I=await fetch(Ve("/api/transcripts/replace"),{method:"POST",headers:{"X-CSRF-Token":y||"","Content-Type":"application/json"},body:JSON.stringify({video_path:p,new_content:s})});if(I.ok)C(!1),o(""),X(""),l.has(p)&&await Ce(p),await H();else{const B=await I.json().catch(()=>({error:"Unknown error"}));console.error("Failed to replace transcript:",B.error),alert(`Failed to replace transcript: ${B.error}`)}}catch(y){console.error("Replace transcript error:",y),alert("Error replacing transcript. Please try again.")}finally{ne(!1)}},he=()=>{C(!1),o(""),X("")},Ye=async(s,A)=>{var I;A.stopPropagation();const y=((I=s.split("/").pop())==null?void 0:I.split("\\").pop())||s;Ke(s),Xe(y),Me(""),Se(!0),setTimeout(()=>{const B=document.getElementById("new-filename");B&&B.select()},100)},tt=async()=>{var A,y;if(!Re.trim()){Me("Filename cannot be empty");return}const s=((A=Ae.split("/").pop())==null?void 0:A.split("\\").pop())||Ae;if(Re===s){Me("New filename must be different from current filename");return}if(/[\/\\]/.test(Re)){Me("Filename cannot contain path separators");return}Ze(!0),Me("");try{const I=(y=document.querySelector('meta[name="csrf-token"]'))==null?void 0:y.getAttribute("content"),B=Ae.split("/");B[B.length-1]=Re.trim();const K=B.join("/"),G=await fetch(Ve("/api/transcripts/rename"),{method:"POST",headers:{"X-CSRF-Token":I||"","Content-Type":"application/json"},body:JSON.stringify({video_path:Ae,new_path:K})});if(!G.ok){const Ue=await G.json();throw new Error(Ue.error||`Failed to rename file: ${G.status} ${G.statusText}`)}Se(!1),Ke(""),Xe(""),await H()}catch(I){console.error("Error renaming file:",I),Me(I instanceof Error?I.message:"An error occurred while renaming the file")}finally{Ze(!1)}},Pt=()=>{Se(!1),Ke(""),Xe(""),Me("")},hn=s=>{_(A=>A.includes(s)?A.filter(I=>I!==s):[...A,s])},pn=()=>{_(c)},xn=()=>{_([])},gn=s=>{R(A=>A.includes(s)?A.filter(I=>I!==s):[...A,s])},vn=()=>{R(Q)},bn=()=>{R([])},lt=s=>{se(s)},wn=s=>{ke(s),se(0)},jn=({className:s=""})=>{if(!k||re<=1)return null;const A=N*te+1,y=Math.min((N+1)*te,$e);return e.jsxs("div",{className:`flex flex-col sm:flex-row items-center gap-2 sm:gap-4 p-4 border-t border-border bg-background ${s}`,children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("span",{className:"hidden sm:inline",children:"Show"}),e.jsxs("select",{value:te,onChange:I=>wn(Number(I.target.value)),className:"border border-border rounded px-2 py-1 bg-background text-xs sm:text-sm",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]}),e.jsx("span",{className:"hidden sm:inline",children:"per page"})]}),e.jsx("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-muted-foreground",children:e.jsxs("span",{children:[A,"-",y," of ",$e]})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("button",{onClick:()=>lt(0),disabled:N===0,className:"px-2 sm:px-3 py-1 text-xs sm:text-sm border border-border rounded hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"hidden sm:inline",children:"First"}),e.jsx("span",{className:"sm:hidden",children:"«"})]}),e.jsxs("button",{onClick:()=>lt(N-1),disabled:N===0,className:"px-2 sm:px-3 py-1 text-xs sm:text-sm border border-border rounded hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"hidden sm:inline",children:"Previous"}),e.jsx("span",{className:"sm:hidden",children:"‹"})]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(Ie?3:5,re)},(I,B)=>{let K;const G=Ie?3:5;return re<=G||N<Math.floor(G/2)?K=B:N>=re-Math.floor(G/2)?K=re-G+B:K=N-Math.floor(G/2)+B,e.jsx("button",{onClick:()=>lt(K),className:`px-2 sm:px-3 py-1 text-xs sm:text-sm border border-border rounded hover:bg-accent min-w-0 ${K===N?"bg-primary text-primary-foreground":""}`,children:K+1},K)})}),e.jsxs("button",{onClick:()=>lt(N+1),disabled:N>=re-1,className:"px-2 sm:px-3 py-1 text-xs sm:text-sm border border-border rounded hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"hidden sm:inline",children:"Next"}),e.jsx("span",{className:"sm:hidden",children:"›"})]}),e.jsxs("button",{onClick:()=>lt(re-1),disabled:N>=re-1,className:"px-2 sm:px-3 py-1 text-xs sm:text-sm border border-border rounded hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"hidden sm:inline",children:"Last"}),e.jsx("span",{className:"sm:hidden",children:"»"})]})]})]})},yn=s=>{b(A=>{const y=new Set(A);return y.has(s)?y.delete(s):y.add(s),y})},kn=async()=>{var K;const s=qe.filter(G=>r&&!Be.includes(G.full_path)?!1:G.transcript);if(s.length===0){alert("No files with transcripts to regenerate");return}const A=O[0],y=s.length,I=`Regenerate ${y} file${y===1?"":"s"} using "${A}" source?`;if(!confirm(I))return;Ne(!0);const B=(K=document.querySelector('meta[name="csrf-token"]'))==null?void 0:K.getAttribute("content");try{let G=0,Ue=0;(await Promise.allSettled(s.map(async at=>{const Bt=await fetch(Ve("/api/transcripts/regenerate"),{method:"POST",headers:{"X-CSRF-Token":B||"","Content-Type":"application/json"},body:JSON.stringify({video_path:at.full_path})});if(!Bt.ok){const Nn=await Bt.json().catch(()=>({error:"Unknown error"}));throw new Error(`${at.full_path}: ${Nn.error}`)}return at.full_path}))).forEach(at=>{at.status==="fulfilled"?G++:(Ue++,console.error("Bulk regeneration error:",at.reason))}),Ue>0?alert(`Bulk regeneration completed with ${G} successes and ${Ue} errors. Check console for details.`):alert(`Successfully queued ${G} files for regeneration`)}catch(G){console.error("Bulk regeneration error:",G),alert("Error during bulk regeneration. Please try again.")}finally{Ne(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{ref:P,className:`${`w-full overflow-y-auto scrollbar-hide px-2 sm:px-4 ${t?n?"pt-24 pb-4":"pt-16 pb-4":"py-10"}`}`,children:[(c.length>1||Q.length>1)&&e.jsxs("div",{className:`mb-6 flex items-center gap-4 ${Ie?"px-4":""}`,children:[c.length>1&&e.jsxs(Fe,{modal:!1,children:[e.jsx(He,{asChild:!0,children:e.jsxs("button",{className:"inline-flex items-center justify-center whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[g.length===c.length||g.length===0?"All Directories":`${g.length} Director${g.length===1?"y":"ies"}`,e.jsx("svg",{className:"ml-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsxs(ze,{align:"start",className:"w-80",children:[e.jsx(vt,{children:"Watch Directories"}),e.jsx(Qe,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 p-2",children:[e.jsx(Je,{checked:g.length===c.length,onCheckedChange:s=>{s?pn():xn()},className:"font-medium",children:"Select All"}),e.jsx(Qe,{}),c.map(s=>e.jsx(Je,{checked:g.includes(s),onCheckedChange:()=>hn(s),children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"font-medium text-sm",children:s.split("/").pop()||s}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s})]})},s))]})]})]}),Q.length>1&&e.jsxs(Fe,{modal:!1,children:[e.jsx(He,{asChild:!0,children:e.jsxs("button",{className:"inline-flex items-center justify-center whitespace-nowrap rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[O.length===Q.length||O.length===0?"All Transcript Sources":`${O.length} Source${O.length===1?"":"s"}`,e.jsx("svg",{className:"ml-2 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),e.jsxs(ze,{align:"start",className:"w-80",children:[e.jsx(vt,{children:"Sources"}),e.jsx(Qe,{}),e.jsxs("div",{className:"grid grid-cols-1 gap-1 p-2",children:[e.jsx(Je,{checked:O.length===Q.length,onCheckedChange:s=>{s?vn():bn()},className:"font-medium",children:"Select All"}),e.jsx(Qe,{}),Q.map(s=>e.jsx(Je,{checked:O.includes(s),onCheckedChange:()=>gn(s),children:e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${J(s)}`,children:s})})},s))]})]})]})]}),O.length===1&&e.jsxs("div",{className:`mb-6 flex items-center justify-between ${Ie?"px-4":""}`,children:[e.jsx("button",{onClick:kn,disabled:ue,className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:ue?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2 animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Regenerating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Regenerate All (",O[0],")"]})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:(()=>{const s=qe.filter(A=>r&&!Be.includes(A.full_path)?!1:A.transcript);return`${s.length} file${s.length===1?"":"s"} with transcripts`})()})]}),e.jsxs("div",{children:[Be.length>0&&e.jsx("div",{className:`mb-6 p-4 bg-accent/10 border border-accent/20 rounded-md ${Ie?"mx-4":""}`,children:e.jsxs("h3",{className:"text-sm font-medium text-accent-foreground mb-2",children:["Found in ",Be.length," file(s)"]})}),r&&Be.length===0&&e.jsx("div",{className:`mb-6 p-4 bg-muted border border-border rounded-md ${Ie?"mx-4":""}`,children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:['No files found containing "',r,'"']})}),!r&&!k&&e.jsx("div",{className:`mb-6 p-4 bg-muted border border-border rounded-md ${Ie?"mx-4":""}`,children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Search to get started!"})}),!n&&!h?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading..."})}):Ie?e.jsx(Jn,{sortedFiles:qe,activeSearchTerm:r,searchResults:Be,showAllFiles:k,transcriptData:de,expandedFiles:l,searchLineNumbers:a,onExpandFile:s=>{const A=qe.find(y=>y.full_path===s);A!=null&&A.transcript&&yn(s)},onRegenerate:Y,onReplace:Le,onRename:Ye,onFetchTranscript:Ce,onSetRightPaneUrl:j,formatDate:s=>oe(s,L>=1129),getSourceChipColor:J,expandContext:z,clipStart:D,clipEnd:M,clipTranscript:T,onSetClipStart:V,onSetClipEnd:q,onClearClip:f,onClipBlock:x,mobileTranscriptRowRefs:S}):e.jsxs(Dn,{className:"table-fixed w-full",children:[e.jsx(On,{children:e.jsxs(jt,{children:[e.jsxs(nt,{className:"text-center w-[34%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>Z("name"),children:[e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Filename",ee("name")]}),r&&Be.length>0&&e.jsx("span",{className:"text-xs text-primary ml-2",children:"(Search Results)"})]}),e.jsx(nt,{className:"text-center w-[14%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>Z("created_at"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Date",ee("created_at")]})}),e.jsx(nt,{className:"text-center w-[14%] pl-6 cursor-pointer hover:bg-accent transition-colors",onClick:()=>Z("last_generated"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Generated",ee("last_generated")]})}),e.jsx(nt,{className:"text-center w-[10%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>Z("line_count"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Lines",ee("line_count")]})}),e.jsx(nt,{className:"text-center w-[10%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>Z("length"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Length",ee("length")]})}),e.jsx(nt,{className:"text-center w-[8%] cursor-pointer hover:bg-accent transition-colors",onClick:()=>Z("source"),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Source",ee("source")]})}),e.jsx(nt,{className:"text-center w-[10%]",children:"Actions"})]})}),e.jsx(Pn,{children:qe.map(s=>{var I;if(!(r?Be.includes(s.full_path):k))return e.jsx(e.Fragment,{});const y=de[s.full_path]||{text:"",loading:!1,error:null};return e.jsxs(e.Fragment,{children:[e.jsxs(jt,{ref:B=>{F.current[s.full_path]=B},"data-filename":s.full_path,className:"",onClick:()=>{s.transcript&&b(B=>{const K=new Set(B);return K.has(s.full_path)?K.delete(s.full_path):K.add(s.full_path),K})},children:[e.jsx(Ge,{className:"font-medium w-[34%] max-w-0",children:e.jsx("div",{className:"leading-tight overflow-hidden whitespace-nowrap text-ellipsis",style:{direction:"rtl",textAlign:"left",unicodeBidi:"plaintext",fontSize:(()=>{var G;const K=(((G=s.name.split("/").pop())==null?void 0:G.split("\\").pop())||s.name).length;return K<=15?"14px":K<=20?"13px":"12px"})()},title:s.name,children:((I=s.name.split("/").pop())==null?void 0:I.split("\\").pop())||s.name})}),e.jsx(Ge,{className:"w-[14%] pr-10 text-foreground",children:oe(s.created_at,L>=1129)}),e.jsx(Ge,{className:"w-[14%] text-center text-foreground",children:oe(s.last_generated||"",L>=1129)}),e.jsx(Ge,{className:"w-[10%] text-foreground",children:s.line_count||0}),e.jsx(Ge,{className:"w-[10%] text-foreground",children:s.length?s.length:e.jsx("button",{onClick:B=>ge(s.full_path,B),disabled:!s.transcript,className:"p-1 text-muted-foreground hover:text-primary hover:bg-accent rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate video length",children:s.transcript?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-4 h-4 animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),e.jsx(Ge,{className:"w-[8%] text-center",children:s.source?L>=1129?e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{className:`inline-flex items-center rounded-full font-medium ${J(s.source)} ${s.source.length>10?"px-1.5 py-0.5 text-xs scale-75":"px-2.5 py-0.5 text-xs"}`,children:s.source})}):e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`w-3 h-3 rounded-full ${J(s.source).split(" ").find(B=>B.startsWith("bg-"))||"bg-gray-200"} ${J(s.source).split(" ").find(B=>B.startsWith("dark:bg-"))||""}`,title:s.source})}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(Ge,{className:"w-[10%] text-center p-2",children:e.jsxs(Fe,{modal:!1,children:[e.jsx(He,{asChild:!0,children:e.jsx("button",{onClick:B=>B.stopPropagation(),className:"p-2 text-muted-foreground hover:text-primary hover:bg-accent rounded-md transition-colors",title:"Actions",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})}),e.jsxs(ze,{align:"end",children:[e.jsxs(we,{onClick:B=>Ye(s.full_path,B),disabled:!s.transcript,children:[e.jsx("span",{children:"Rename"}),e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]}),s.transcript&&e.jsxs(we,{onClick:B=>Le(s.full_path,B),disabled:!s.transcript,className:"text-blue-600 hover:text-blue-700",children:[e.jsx("span",{children:"Edit transcript"}),!s.transcript&&e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})]}),s.transcript&&e.jsxs(we,{onClick:B=>Y(s.full_path,s.source,B),disabled:!s.transcript,className:"text-green-600 hover:text-green-700",children:[e.jsx("span",{children:"Regenerate transcript"}),s.transcript?e.jsx("svg",{className:"w-4 h-4 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]}),it(s.full_path)&&e.jsxs(we,{disabled:!0,children:[e.jsx("span",{children:"Processing transcript..."}),e.jsx("svg",{className:"w-4 h-4 ml-auto animate-reverse-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})]})]})]})})]},s.full_path),e.jsx(jt,{ref:B=>{E.current[s.full_path]=B},"data-filename":s.full_path,children:e.jsx(Ge,{colSpan:7,className:"p-0",children:e.jsx(Kt,{visible:l.has(s.full_path),name:s.base_name,fullPath:s.full_path,className:"w-full",searchTerm:r,text:y.text,loading:y.loading,error:y.error,visibleLines:a[s.full_path]||[],expandContext:z,onEditSuccess:()=>{Ce(s.full_path)},onSetRightPaneUrl:j,clipStart:D,clipEnd:M,clipTranscript:T,onSetClipStart:B=>V(B,s.full_path),onSetClipEnd:B=>q(B,s.full_path),onClearClip:f,onClipBlock:x})})})]})})})]})]}),e.jsx(jn,{})]}),e.jsx(Mt,{isOpen:ae,filename:p,transcriptInitialValue:U,onTranscriptSave:me,onCancel:he,isTranscriptSubmitting:ce}),Pe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-background border border-border rounded-lg p-6 w-96 max-w-90vw",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Rename File"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:['Renaming "',((At=Ae.split("/").pop())==null?void 0:At.split("\\").pop())||Ae,'" (this will rename the video, transcript, and meta files)']}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"new-filename",className:"block text-sm font-medium mb-2",children:"New filename (without extension):"}),e.jsx("input",{id:"new-filename",type:"text",value:Re,onChange:s=>Xe(s.target.value),onKeyDown:s=>{s.key==="Enter"&&!_e&&Re.trim()?tt():s.key==="Escape"&&Pt()},className:"w-full px-3 py-2 border border-input bg-background text-foreground rounded focus:outline-none focus:ring-1 focus:ring-ring focus:border-transparent",placeholder:"Enter new filename",disabled:_e,autoFocus:!0})]}),st&&e.jsx("div",{className:"text-sm text-destructive",children:st}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:Pt,className:"px-4 py-2 text-sm border border-input bg-background text-foreground rounded hover:bg-accent focus:outline-none focus:ring-1 focus:ring-ring",disabled:_e,children:"Cancel"}),e.jsx("button",{onClick:tt,className:"px-4 py-2 text-sm bg-primary text-primary-foreground rounded hover:bg-primary/90 focus:outline-none focus:ring-1 focus:ring-ring disabled:opacity-50 disabled:cursor-not-allowed",disabled:_e||!Re.trim(),children:_e?"Renaming...":"Rename"})]})]})]})}),e.jsx(Tt,{isOpen:ot,videoPath:Ee,source:We,onClose:()=>et(!1),onRegenerate:pe})]})}function Zn(){return e.jsx("div",{className:"w-full h-full flex items-center justify-center p-8 bg-background",children:e.jsxs("div",{className:"text-center text-foreground",children:[e.jsx("div",{className:"mb-6",children:e.jsx("svg",{className:"w-16 h-16 mx-auto text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),e.jsx("h3",{className:"text-xl font-medium mb-3 text-foreground",children:"Clip Editor"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Click on any timestamp in a transcript to open the clip editor and create video clips from specific moments."})]})})}const gt=d.forwardRef(({className:t,type:n,...r},a)=>e.jsx("input",{type:n,className:Te("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...r}));gt.displayName="Input";const tn=d.forwardRef(({className:t,...n},r)=>e.jsx("textarea",{className:Te("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n}));tn.displayName="Textarea";function er({className:t,...n}){return e.jsx(Sn,{"data-slot":"checkbox",className:Te("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:e.jsx(Rn,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(In,{className:"size-3.5"})})})}const Wt=({buttons:t})=>{const n=t.reduce((a,i,l)=>{const b=i.group??0;return a[b]||(a[b]=[]),a[b].push({...i,originalIndex:l}),a},{}),r=Object.keys(n).map(Number).sort((a,i)=>a-i);return e.jsx("div",{className:"mt-2 space-y-3",children:r.map(a=>e.jsx("div",{className:"flex items-center gap-2 justify-center flex-wrap",children:n[a].map(i=>e.jsx(be,{variant:"outline",size:"sm",onClick:i.onClick,className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:i.color?{borderColor:i.color,color:i.color}:void 0,children:i.text},i.originalIndex))},a))})},dt=({filename:t,clip_url:n,start_time_formatted:r="00:00:00.000",end_time_formatted:a="00:00:10.000",font_size:i="",text:l="",display_text:b=!1,onBack:w,onStartTimeChange:k,onEndTimeChange:L})=>{const[v,h]=d.useState(r),[m,D]=d.useState(a),[M,T]=d.useState(i),[F,E]=d.useState(l),[S,P]=d.useState(b),[j,V]=d.useState(!1),[q,f]=d.useState(n||""),[x,W]=d.useState(!1),[H,g]=d.useState(!1),[_]=d.useState(t),[c,O]=d.useState({}),[R,Q]=d.useState("video"),N=d.useRef(null),se=d.useRef(null),te=C=>{const p=C.split(":"),o=parseInt(p[0],10),U=parseInt(p[1],10),X=parseFloat(p[2]);return o*3600+U*60+X},ke=C=>{C=Math.max(0,C);const p=Math.floor(C/3600),o=Math.floor(C%3600/60),U=C%60;return`${p.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}:${U.toFixed(3).padStart(6,"0")}`},ie=C=>/^(\d{2}):(\d{2}):(\d{2})\.(\d{3})$/.test(C),xe=(C="mp4")=>{if(!v||!m||!ie(v)||!ie(m))return"";const p=te(v),o=te(m);if(p<0||o<=p)return"";const U=new URLSearchParams({filename:t,start_time:p.toString(),end_time:o.toString(),format:C,cachebuster:Date.now().toString()});return F&&F.trim()!==""&&U.set("text",F),M&&M.trim()!==""&&U.set("font_size",M),S&&U.set("display_text","true"),"/api/clip?"+U.toString()},le=C=>{let p=`${_}_clip_start_${v}_end_${m}.${C}`;if(F&&F.trim()!==""){const o=F.trim().substring(0,50).replace(/[^a-zA-Z0-9\s\-_]/g,"").replace(/\s+/g,"_");o&&(p=o+`.${C}`)}return p},je=async C=>{const p=xe(C),o=le(C);O(U=>({...U,[C]:!0}));try{const U=await fetch(p);if(!U.ok)throw new Error(`Failed to download file: ${U.statusText}`);const X=await U.blob(),ce={mp4:"video/mp4",gif:"image/gif",mp3:"audio/mpeg"},ne=new File([X],o,{type:ce[C]||"application/octet-stream"});await navigator.share({files:[ne]})}catch(U){console.error("Error sharing:",U);try{await navigator.share({title:`Clip from ${o}`,url:window.location.origin+p})}catch(X){console.error("Error with fallback sharing:",X)}}finally{O(U=>({...U,[C]:!1}))}},re=(C,p,o,U)=>{if(!ie(C))return;const ce=te(C)+p,ne=ke(ce);o(ne),U&&U(ce)},$e=(C,p,o)=>[{text:"+1s",onClick:()=>re(C,1,p,o),color:"#22c55e",group:0},{text:"+0.5s",onClick:()=>re(C,.5,p,o),color:"#22c55e",group:0},{text:"+0.1s",onClick:()=>re(C,.1,p,o),color:"#22c55e",group:0},{text:"+0.01s",onClick:()=>re(C,.01,p,o),color:"#22c55e",group:0},{text:"-1s",onClick:()=>re(C,-1,p,o),color:"#ef4444",group:1},{text:"-0.5s",onClick:()=>re(C,-.5,p,o),color:"#ef4444",group:1},{text:"-0.1s",onClick:()=>re(C,-.1,p,o),color:"#ef4444",group:1},{text:"-0.01s",onClick:()=>re(C,-.01,p,o),color:"#ef4444",group:1}],de=()=>{if(!ie(v)||!ie(m))return;const C=te(v),p=te(m);if(C<0||p<=C)return;const o=xe(R==="video"?"mp4":"gif");o&&f(o)};d.useEffect(()=>{var C;q&&((C=N.current)==null||C.load())},[q]);const Ce=()=>{se.current&&clearTimeout(se.current),se.current=setTimeout(de,500)},ue=()=>{V(!1),N.current&&window.scrollTo({top:0,behavior:"smooth"})},Ne=()=>{V(!1),window.scrollTo({top:0,behavior:"smooth"})},ae=(C,p,o)=>{if(p(C),ie(C)&&o){const U=te(C);o(U)}};return d.useEffect(()=>{T(i),E(l),P(b),f(n||"")},[i,l,b,n]),d.useEffect(()=>{h(r)},[r]),d.useEffect(()=>{D(a)},[a]),d.useEffect(()=>{ie(v)&&ie(m)&&de()},[v,m,R,F,M,S]),d.useEffect(()=>{g(typeof navigator.share=="function")},[]),d.useEffect(()=>(de(),()=>{se.current&&clearTimeout(se.current)}),[t,r,a]),e.jsxs("div",{className:"container max-w-6xl mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:t}),w&&e.jsxs("button",{onClick:w,className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(Fn,{className:"h-4 w-4"}),"Close"]})]}),e.jsx("div",{className:"text-center mb-4",children:e.jsxs("div",{className:"text-lg font-medium text-muted-foreground",children:[v," to ",m]})}),e.jsx(bt,{className:"relative overflow-hidden bg-black",children:e.jsxs(wt,{className:"p-0",children:[j&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center min-h-[300px] bg-black/95 backdrop-blur-sm z-10",children:[e.jsx("div",{className:"w-12 h-12 border-3 border-muted border-t-primary rounded-full animate-spin mb-6"}),e.jsx("div",{className:"text-lg font-semibold text-primary-foreground mb-2",children:"Processing..."}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Generating your clip, please wait"})]}),q&&e.jsx(e.Fragment,{children:R==="video"?e.jsxs("video",{ref:N,controls:!0,autoPlay:!0,playsInline:!0,className:"w-full h-auto block",onLoadedData:ue,onError:Ne,children:[e.jsx("source",{src:q,type:"video/mp4"}),"Your browser does not support the video tag."]}):e.jsx("img",{src:q,alt:"Clip preview",className:"w-full h-auto block",onLoad:ue,onError:Ne})})]})}),e.jsx(bt,{children:e.jsxs(wt,{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex justify-start",children:e.jsxs(be,{onClick:de,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(Hn,{className:"h-4 w-4"}),"Regenerate"]})}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"start_time",className:"text-sm font-medium",children:"Start Time (hh:mm:ss.sss)"}),e.jsx(gt,{id:"start_time",type:"text",value:v,onChange:C=>ae(C.target.value,h,k),pattern:"^(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d{3})$",placeholder:"00:00:00.000",className:"font-mono text-xs tracking-wider",required:!0}),x&&e.jsx(Wt,{buttons:$e(v,h,k)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"end_time",className:"text-sm font-medium",children:"End Time (hh:mm:ss.sss)"}),e.jsx(gt,{id:"end_time",type:"text",value:m,onChange:C=>ae(C.target.value,D,L),pattern:"^(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d{3})$",placeholder:"00:00:00.000",className:"font-mono text-xs tracking-wider",required:!0}),x&&e.jsx(Wt,{buttons:$e(m,D,L)})]})]})}),!x&&e.jsx("div",{className:"flex justify-center",children:e.jsxs(be,{onClick:()=>W(!0),variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(zn,{className:"h-4 w-4"}),"Show Time Controls"]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Preview"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"preview",value:"video",checked:R==="video",onChange:C=>Q(C.target.value),className:"text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm",children:"Video"})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"preview",value:"gif",checked:R==="gif",onChange:C=>Q(C.target.value),className:"text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm",children:"GIF"})]})]})]}),e.jsxs("div",{className:"space-y-2 text-left",children:[e.jsx("label",{htmlFor:"font_size",className:"text-sm font-medium",children:"Font Size"}),e.jsx(gt,{id:"font_size",type:"number",value:M,onChange:C=>{T(C.target.value),Ce()},min:"10",max:"500",placeholder:"Auto",className:"w-20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"text",className:"text-sm font-medium",children:"Text Overlay"}),e.jsx(tn,{id:"text",value:F,onChange:C=>{E(C.target.value),Ce()},placeholder:"Enter text to overlay on video",className:"min-h-[100px] resize-y"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(er,{id:"display_text",checked:S,onCheckedChange:C=>{P(C),de()}}),e.jsx("label",{htmlFor:"display_text",className:"text-sm font-medium cursor-pointer",children:"Show Text Overlay"})]}),e.jsxs("div",{className:"pt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-1 justify-center flex-wrap",children:[e.jsx(be,{asChild:!0,variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#22c55e",color:"#22c55e"},children:e.jsxs("a",{href:xe("mp4"),download:le("mp4"),className:"inline-flex items-center gap-2",children:[e.jsx(kt,{className:"w-3 h-3"}),"Download MP4"]})}),e.jsx(be,{asChild:!0,variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#22c55e",color:"#22c55e"},children:e.jsxs("a",{href:xe("gif"),download:le("gif"),className:"inline-flex items-center gap-2",children:[e.jsx(kt,{className:"w-3 h-3"}),"Download GIF"]})}),e.jsx(be,{asChild:!0,variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#22c55e",color:"#22c55e"},children:e.jsxs("a",{href:xe("mp3"),download:le("mp3"),className:"inline-flex items-center gap-2",children:[e.jsx(kt,{className:"w-3 h-3"}),"Download MP3"]})})]}),H&&e.jsxs("div",{className:"flex items-center gap-1 justify-center flex-wrap",children:[e.jsxs(be,{onClick:()=>je("mp4"),variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#3b82f6",color:"#3b82f6"},disabled:c.mp4,children:[c.mp4?e.jsx("div",{className:"w-3 h-3 mr-1 border border-current border-t-transparent rounded-full animate-spin"}):e.jsx(Nt,{className:"w-3 h-3 mr-1"}),c.mp4?"Sharing...":"Share MP4"]}),e.jsxs(be,{onClick:()=>je("gif"),variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#3b82f6",color:"#3b82f6"},disabled:c.gif,children:[c.gif?e.jsx("div",{className:"w-3 h-3 mr-1 border border-current border-t-transparent rounded-full animate-spin"}):e.jsx(Nt,{className:"w-3 h-3 mr-1"}),c.gif?"Sharing...":"Share GIF"]}),e.jsxs(be,{onClick:()=>je("mp3"),variant:"outline",size:"sm",className:"h-7 px-2 text-xs font-mono hover:bg-muted/80 transition-colors",style:{borderColor:"#3b82f6",color:"#3b82f6"},disabled:c.mp3,children:[c.mp3?e.jsx("div",{className:"w-3 h-3 mr-1 border border-current border-t-transparent rounded-full animate-spin"}):e.jsx(Nt,{className:"w-3 h-3 mr-1"}),c.mp3?"Sharing...":"Share MP3"]})]})]})]})})]})};function tr(t){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}const nn=u.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldAnimate:{current:!0},shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),ft=()=>{const t=u.useContext(nn);if(!t)throw new Error("useDrawerContext must be used within a Drawer.Root");return t};tr(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--initial-transform,100%),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--initial-transform,100%),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-animate=false]{animation:none!important}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,var(--initial-transform,100%),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,var(--initial-transform,100%),0)}}@keyframes slideFromTop{from{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}}@keyframes slideFromLeft{from{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}}@keyframes slideFromRight{from{transform:translate3d(var(--initial-transform,100%),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(var(--initial-transform,100%),0,0)}}`);function nr(){const t=navigator.userAgent;return typeof window<"u"&&(/Firefox/.test(t)&&/Mobile/.test(t)||/FxiOS/.test(t))}function rr(){return Ot(/^Mac/)}function sr(){return Ot(/^iPhone/)}function Ut(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function ar(){return Ot(/^iPad/)||rr()&&navigator.maxTouchPoints>1}function rn(){return sr()||ar()}function Ot(t){return typeof window<"u"&&window.navigator!=null?t.test(window.navigator.platform):void 0}const or=24,ir=typeof window<"u"?d.useLayoutEffect:d.useEffect;function Vt(...t){return(...n)=>{for(let r of t)typeof r=="function"&&r(...n)}}const Ct=typeof document<"u"&&window.visualViewport;function qt(t){let n=window.getComputedStyle(t);return/(auto|scroll)/.test(n.overflow+n.overflowX+n.overflowY)}function sn(t){for(qt(t)&&(t=t.parentElement);t&&!qt(t);)t=t.parentElement;return t||document.scrollingElement||document.documentElement}const lr=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let pt=0,St;function cr(t={}){let{isDisabled:n}=t;ir(()=>{if(!n)return pt++,pt===1&&rn()&&(St=dr()),()=>{pt--,pt===0&&(St==null||St())}},[n])}function dr(){let t,n=0,r=h=>{t=sn(h.target),!(t===document.documentElement&&t===document.body)&&(n=h.changedTouches[0].pageY)},a=h=>{if(!t||t===document.documentElement||t===document.body){h.preventDefault();return}let m=h.changedTouches[0].pageY,D=t.scrollTop,M=t.scrollHeight-t.clientHeight;M!==0&&((D<=0&&m>n||D>=M&&m<n)&&h.preventDefault(),n=m)},i=h=>{let m=h.target;$t(m)&&m!==document.activeElement&&(h.preventDefault(),m.style.transform="translateY(-2000px)",m.focus(),requestAnimationFrame(()=>{m.style.transform=""}))},l=h=>{let m=h.target;$t(m)&&(m.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{m.style.transform="",Ct&&(Ct.height<window.innerHeight?requestAnimationFrame(()=>{Yt(m)}):Ct.addEventListener("resize",()=>Yt(m),{once:!0}))}))},b=()=>{window.scrollTo(0,0)},w=window.pageXOffset,k=window.pageYOffset,L=Vt(ur(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let v=Vt(ut(document,"touchstart",r,{passive:!1,capture:!0}),ut(document,"touchmove",a,{passive:!1,capture:!0}),ut(document,"touchend",i,{passive:!1,capture:!0}),ut(document,"focus",l,!0),ut(window,"scroll",b));return()=>{L(),v(),window.scrollTo(w,k)}}function ur(t,n,r){let a=t.style[n];return t.style[n]=r,()=>{t.style[n]=a}}function ut(t,n,r,a){return t.addEventListener(n,r,a),()=>{t.removeEventListener(n,r,a)}}function Yt(t){let n=document.scrollingElement||document.documentElement;for(;t&&t!==n;){let r=sn(t);if(r!==document.documentElement&&r!==document.body&&r!==t){let a=r.getBoundingClientRect().top,i=t.getBoundingClientRect().top,l=t.getBoundingClientRect().bottom;const b=r.getBoundingClientRect().bottom+or;l>b&&(r.scrollTop+=i-a)}t=r.parentElement}}function $t(t){return t instanceof HTMLInputElement&&!lr.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}function mr(t,n){typeof t=="function"?t(n):t!=null&&(t.current=n)}function fr(...t){return n=>t.forEach(r=>mr(r,n))}function an(...t){return d.useCallback(fr(...t),t)}const on=new WeakMap;function ye(t,n,r=!1){if(!t||!(t instanceof HTMLElement))return;let a={};Object.entries(n).forEach(([i,l])=>{if(i.startsWith("--")){t.style.setProperty(i,l);return}a[i]=t.style[i],t.style[i]=l}),!r&&on.set(t,a)}function hr(t,n){if(!t||!(t instanceof HTMLElement))return;let r=on.get(t);r&&(t.style[n]=r[n])}const ve=t=>{switch(t){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return t}};function xt(t,n){if(!t)return null;const r=window.getComputedStyle(t),a=r.transform||r.webkitTransform||r.mozTransform;let i=a.match(/^matrix3d\((.+)\)$/);return i?parseFloat(i[1].split(", ")[ve(n)?13:12]):(i=a.match(/^matrix\((.+)\)$/),i?parseFloat(i[1].split(", ")[ve(n)?5:4]):null)}function pr(t){return 8*(Math.log(t+1)-2)}function Rt(t,n){if(!t)return()=>{};const r=t.style.cssText;return Object.assign(t.style,n),()=>{t.style.cssText=r}}function xr(...t){return(...n)=>{for(const r of t)typeof r=="function"&&r(...n)}}const fe={DURATION:.5,EASE:[.32,.72,0,1]},ln=.4,gr=.25,vr=100,cn=8,rt=16,Dt=26,Et="vaul-dragging";function dn(t){const n=u.useRef(t);return u.useEffect(()=>{n.current=t}),u.useMemo(()=>(...r)=>n.current==null?void 0:n.current.call(n,...r),[])}function br({defaultProp:t,onChange:n}){const r=u.useState(t),[a]=r,i=u.useRef(a),l=dn(n);return u.useEffect(()=>{i.current!==a&&(l(a),i.current=a)},[a,i,l]),r}function un({prop:t,defaultProp:n,onChange:r=()=>{}}){const[a,i]=br({defaultProp:n,onChange:r}),l=t!==void 0,b=l?t:a,w=dn(r),k=u.useCallback(L=>{if(l){const h=typeof L=="function"?L(t):L;h!==t&&w(h)}else i(L)},[l,t,i,w]);return[b,k]}function wr({activeSnapPointProp:t,setActiveSnapPointProp:n,snapPoints:r,drawerRef:a,overlayRef:i,fadeFromIndex:l,onSnapPointChange:b,direction:w="bottom",container:k,snapToSequentialPoint:L}){const[v,h]=un({prop:t,defaultProp:r==null?void 0:r[0],onChange:n}),[m,D]=u.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);u.useEffect(()=>{function f(){D({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)},[]);const M=u.useMemo(()=>v===(r==null?void 0:r[r.length-1])||null,[r,v]),T=u.useMemo(()=>{var f;return(f=r==null?void 0:r.findIndex(x=>x===v))!=null?f:null},[r,v]),F=r&&r.length>0&&(l||l===0)&&!Number.isNaN(l)&&r[l]===v||!r,E=u.useMemo(()=>{const f=k?{width:k.getBoundingClientRect().width,height:k.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var x;return(x=r==null?void 0:r.map(W=>{const H=typeof W=="string";let g=0;if(H&&(g=parseInt(W,10)),ve(w)){const c=H?g:m?W*f.height:0;return m?w==="bottom"?f.height-c:-f.height+c:c}const _=H?g:m?W*f.width:0;return m?w==="right"?f.width-_:-f.width+_:_}))!=null?x:[]},[r,m,k]),S=u.useMemo(()=>T!==null?E==null?void 0:E[T]:null,[E,T]),P=u.useCallback(f=>{var x;const W=(x=E==null?void 0:E.findIndex(H=>H===f))!=null?x:null;b(W),ye(a.current,{transition:`transform ${fe.DURATION}s cubic-bezier(${fe.EASE.join(",")})`,transform:ve(w)?`translate3d(0, ${f}px, 0)`:`translate3d(${f}px, 0, 0)`}),E&&W!==E.length-1&&l!==void 0&&W!==l&&W<l?ye(i.current,{transition:`opacity ${fe.DURATION}s cubic-bezier(${fe.EASE.join(",")})`,opacity:"0"}):ye(i.current,{transition:`opacity ${fe.DURATION}s cubic-bezier(${fe.EASE.join(",")})`,opacity:"1"}),h(r==null?void 0:r[Math.max(W,0)])},[a.current,r,E,l,i,h]);u.useEffect(()=>{if(v||t){var f;const x=(f=r==null?void 0:r.findIndex(W=>W===t||W===v))!=null?f:-1;E&&x!==-1&&typeof E[x]=="number"&&P(E[x])}},[v,t,r,E,P]);function j({draggedDistance:f,closeDrawer:x,velocity:W,dismissible:H}){if(l===void 0)return;const g=w==="bottom"||w==="right"?(S??0)-f:(S??0)+f,_=T===l-1,c=T===0,O=f>0;if(_&&ye(i.current,{transition:`opacity ${fe.DURATION}s cubic-bezier(${fe.EASE.join(",")})`}),!L&&W>2&&!O){H?x():P(E[0]);return}if(!L&&W>2&&O&&E&&r){P(E[r.length-1]);return}const R=E==null?void 0:E.reduce((N,se)=>typeof N!="number"||typeof se!="number"?N:Math.abs(se-g)<Math.abs(N-g)?se:N),Q=ve(w)?window.innerHeight:window.innerWidth;if(W>ln&&Math.abs(f)<Q*.4){const N=O?1:-1;if(N>0&&M&&r){P(E[r.length-1]);return}if(c&&N<0&&H&&x(),T===null)return;P(E[T+N]);return}P(R)}function V({draggedDistance:f}){if(S===null)return;const x=w==="bottom"||w==="right"?S-f:S+f;(w==="bottom"||w==="right")&&x<E[E.length-1]||(w==="top"||w==="left")&&x>E[E.length-1]||ye(a.current,{transform:ve(w)?`translate3d(0, ${x}px, 0)`:`translate3d(${x}px, 0, 0)`})}function q(f,x){if(!r||typeof T!="number"||!E||l===void 0)return null;const W=T===l-1;if(T>=l&&x)return 0;if(W&&!x)return 1;if(!F&&!W)return null;const g=W?T+1:T-1,_=W?E[g]-E[g-1]:E[g+1]-E[g],c=f/Math.abs(_);return W?1-c:c}return{isLastSnapPoint:M,activeSnapPoint:v,shouldFade:F,getPercentageDragged:q,setActiveSnapPoint:h,activeSnapPointIndex:T,onRelease:j,onDrag:V,snapPointsOffset:E}}const jr=()=>()=>{};function yr(){const{direction:t,isOpen:n,shouldScaleBackground:r,setBackgroundColorOnScale:a,noBodyStyles:i}=ft(),l=u.useRef(null),b=d.useMemo(()=>document.body.style.backgroundColor,[]);function w(){return(window.innerWidth-Dt)/window.innerWidth}u.useEffect(()=>{if(n&&r){l.current&&clearTimeout(l.current);const k=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!k)return;xr(a&&!i?Rt(document.body,{background:"black"}):jr,Rt(k,{transformOrigin:ve(t)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${fe.DURATION}s`,transitionTimingFunction:`cubic-bezier(${fe.EASE.join(",")})`}));const L=Rt(k,{borderRadius:`${cn}px`,overflow:"hidden",...ve(t)?{transform:`scale(${w()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${w()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{L(),l.current=window.setTimeout(()=>{b?document.body.style.background=b:document.body.style.removeProperty("background")},fe.DURATION*1e3)}}},[n,r,b])}let mt=null;function kr({isOpen:t,modal:n,nested:r,hasBeenOpened:a,preventScrollRestoration:i,noBodyStyles:l}){const[b,w]=u.useState(()=>typeof window<"u"?window.location.href:""),k=u.useRef(0),L=u.useCallback(()=>{if(Ut()&&mt===null&&t&&!l){mt={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:h,innerHeight:m}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-k.current}px`,left:`${-h}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const D=m-window.innerHeight;D&&k.current>=m&&(document.body.style.top=`${-(k.current+D)}px`)}),300)}},[t]),v=u.useCallback(()=>{if(Ut()&&mt!==null&&!l){const h=-parseInt(document.body.style.top,10),m=-parseInt(document.body.style.left,10);Object.assign(document.body.style,mt),window.requestAnimationFrame(()=>{if(i&&b!==window.location.href){w(window.location.href);return}window.scrollTo(m,h)}),mt=null}},[b]);return u.useEffect(()=>{function h(){k.current=window.scrollY}return h(),window.addEventListener("scroll",h),()=>{window.removeEventListener("scroll",h)}},[]),u.useEffect(()=>{if(n)return()=>{typeof document>"u"||document.querySelector("[data-vaul-drawer]")||v()}},[n,v]),u.useEffect(()=>{r||!a||(t?(!window.matchMedia("(display-mode: standalone)").matches&&L(),n||window.setTimeout(()=>{v()},500)):v())},[t,a,b,n,r,L,v]),{restorePositionSetting:v}}function Nr({open:t,onOpenChange:n,children:r,onDrag:a,onRelease:i,snapPoints:l,shouldScaleBackground:b=!1,setBackgroundColorOnScale:w=!0,closeThreshold:k=gr,scrollLockTimeout:L=vr,dismissible:v=!0,handleOnly:h=!1,fadeFromIndex:m=l&&l.length-1,activeSnapPoint:D,setActiveSnapPoint:M,fixed:T,modal:F=!0,onClose:E,nested:S,noBodyStyles:P=!1,direction:j="bottom",defaultOpen:V=!1,disablePreventScroll:q=!0,snapToSequentialPoint:f=!1,preventScrollRestoration:x=!1,repositionInputs:W=!0,onAnimationEnd:H,container:g,autoFocus:_=!1}){var c,O;const[R=!1,Q]=un({defaultProp:V,prop:t,onChange:z=>{n==null||n(z),!z&&!S&&st(),setTimeout(()=>{H==null||H(z)},fe.DURATION*1e3),z&&!F&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),z||(document.body.style.pointerEvents="auto")}}),[N,se]=u.useState(!1),[te,ke]=u.useState(!1),[ie,xe]=u.useState(!1),le=u.useRef(null),je=u.useRef(null),re=u.useRef(null),$e=u.useRef(null),de=u.useRef(null),Ce=u.useRef(!1),ue=u.useRef(null),Ne=u.useRef(0),ae=u.useRef(!1),C=u.useRef(!V),p=u.useRef(0),o=u.useRef(null),U=u.useRef(((c=o.current)==null?void 0:c.getBoundingClientRect().height)||0),X=u.useRef(((O=o.current)==null?void 0:O.getBoundingClientRect().width)||0),ce=u.useRef(0),ne=u.useCallback(z=>{l&&z===Re.length-1&&(je.current=new Date)},[]),{activeSnapPoint:Pe,activeSnapPointIndex:Se,setActiveSnapPoint:Ae,onRelease:Ke,snapPointsOffset:Re,onDrag:Xe,shouldFade:_e,getPercentageDragged:Ze}=wr({snapPoints:l,activeSnapPointProp:D,setActiveSnapPointProp:M,drawerRef:o,fadeFromIndex:m,overlayRef:le,onSnapPointChange:ne,direction:j,container:g,snapToSequentialPoint:f});cr({isDisabled:!R||te||!F||ie||!N||!W||!q});const{restorePositionSetting:st}=kr({isOpen:R,modal:F,nested:S??!1,hasBeenOpened:N,preventScrollRestoration:x,noBodyStyles:P});function Me(){return(window.innerWidth-Dt)/window.innerWidth}function ot(z){var Z,ee;!v&&!l||o.current&&!o.current.contains(z.target)||(U.current=((Z=o.current)==null?void 0:Z.getBoundingClientRect().height)||0,X.current=((ee=o.current)==null?void 0:ee.getBoundingClientRect().width)||0,ke(!0),re.current=new Date,rn()&&window.addEventListener("touchend",()=>Ce.current=!1,{once:!0}),z.target.setPointerCapture(z.pointerId),Ne.current=ve(j)?z.pageY:z.pageX)}function et(z,Z){var ee;let J=z;const oe=(ee=window.getSelection())==null?void 0:ee.toString(),$=o.current?xt(o.current,j):null,Y=new Date;if(J.tagName==="SELECT"||J.hasAttribute("data-vaul-no-drag")||J.closest("[data-vaul-no-drag]"))return!1;if(j==="right"||j==="left")return!0;if(je.current&&Y.getTime()-je.current.getTime()<500)return!1;if($!==null&&(j==="bottom"?$>0:$<0))return!0;if(oe&&oe.length>0)return!1;if(de.current&&Y.getTime()-de.current.getTime()<L&&$===0||Z)return de.current=Y,!1;for(;J;){if(J.scrollHeight>J.clientHeight){if(J.scrollTop!==0)return de.current=new Date,!1;if(J.getAttribute("role")==="dialog")return!0}J=J.parentNode}return!0}function Ee(z){if(o.current&&te){const Z=j==="bottom"||j==="right"?1:-1,ee=(Ne.current-(ve(j)?z.pageY:z.pageX))*Z,J=ee>0,oe=l&&!v&&!J;if(oe&&Se===0)return;const $=Math.abs(ee),Y=document.querySelector("[data-vaul-drawer-wrapper]"),pe=j==="bottom"||j==="top"?U.current:X.current;let ge=$/pe;const Le=Ze($,J);if(Le!==null&&(ge=Le),oe&&ge>=1||!Ce.current&&!et(z.target,J))return;if(o.current.classList.add(Et),Ce.current=!0,ye(o.current,{transition:"none"}),ye(le.current,{transition:"none"}),l&&Xe({draggedDistance:ee}),J&&!l){const he=pr(ee),Ye=Math.min(he*-1,0)*Z;ye(o.current,{transform:ve(j)?`translate3d(0, ${Ye}px, 0)`:`translate3d(${Ye}px, 0, 0)`});return}const me=1-ge;if((_e||m&&Se===m-1)&&(a==null||a(z,ge),ye(le.current,{opacity:`${me}`,transition:"none"},!0)),Y&&le.current&&b){const he=Math.min(Me()+ge*(1-Me()),1),Ye=8-ge*8,tt=Math.max(0,14-ge*14);ye(Y,{borderRadius:`${Ye}px`,transform:ve(j)?`scale(${he}) translate3d(0, ${tt}px, 0)`:`scale(${he}) translate3d(${tt}px, 0, 0)`,transition:"none"},!0)}if(!l){const he=$*Z;ye(o.current,{transform:ve(j)?`translate3d(0, ${he}px, 0)`:`translate3d(${he}px, 0, 0)`})}}}u.useEffect(()=>{window.requestAnimationFrame(()=>{C.current=!0})},[]),u.useEffect(()=>{var z;function Z(){if(!o.current||!W)return;const ee=document.activeElement;if($t(ee)||ae.current){var J;const oe=((J=window.visualViewport)==null?void 0:J.height)||0,$=window.innerHeight;let Y=$-oe;const pe=o.current.getBoundingClientRect().height||0,ge=pe>$*.8;ce.current||(ce.current=pe);const Le=o.current.getBoundingClientRect().top;if(Math.abs(p.current-Y)>60&&(ae.current=!ae.current),l&&l.length>0&&Re&&Se){const me=Re[Se]||0;Y+=me}if(p.current=Y,pe>oe||ae.current){const me=o.current.getBoundingClientRect().height;let he=me;me>oe&&(he=oe-(ge?Le:Dt)),T?o.current.style.height=`${me-Math.max(Y,0)}px`:o.current.style.height=`${Math.max(he,oe-Le)}px`}else nr()||(o.current.style.height=`${ce.current}px`);l&&l.length>0&&!ae.current?o.current.style.bottom="0px":o.current.style.bottom=`${Math.max(Y,0)}px`}}return(z=window.visualViewport)==null||z.addEventListener("resize",Z),()=>{var ee;return(ee=window.visualViewport)==null?void 0:ee.removeEventListener("resize",Z)}},[Se,l,Re]);function De(z){Oe(),E==null||E(),z||Q(!1),setTimeout(()=>{l&&Ae(l[0])},fe.DURATION*1e3)}function We(){if(!o.current)return;const z=document.querySelector("[data-vaul-drawer-wrapper]"),Z=xt(o.current,j);ye(o.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${fe.DURATION}s cubic-bezier(${fe.EASE.join(",")})`}),ye(le.current,{transition:`opacity ${fe.DURATION}s cubic-bezier(${fe.EASE.join(",")})`,opacity:"1"}),b&&Z&&Z>0&&R&&ye(z,{borderRadius:`${cn}px`,overflow:"hidden",...ve(j)?{transform:`scale(${Me()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${Me()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${fe.DURATION}s`,transitionTimingFunction:`cubic-bezier(${fe.EASE.join(",")})`},!0)}function Oe(){!te||!o.current||(o.current.classList.remove(Et),Ce.current=!1,ke(!1),$e.current=new Date)}function it(z){if(!te||!o.current)return;o.current.classList.remove(Et),Ce.current=!1,ke(!1),$e.current=new Date;const Z=xt(o.current,j);if(!z||!et(z.target,!1)||!Z||Number.isNaN(Z)||re.current===null)return;const ee=$e.current.getTime()-re.current.getTime(),J=Ne.current-(ve(j)?z.pageY:z.pageX),oe=Math.abs(J)/ee;if(oe>.05&&(xe(!0),setTimeout(()=>{xe(!1)},200)),l){Ke({draggedDistance:J*(j==="bottom"||j==="right"?1:-1),closeDrawer:De,velocity:oe,dismissible:v}),i==null||i(z,!0);return}if(j==="bottom"||j==="right"?J>0:J<0){We(),i==null||i(z,!0);return}if(oe>ln){De(),i==null||i(z,!1);return}var $;const Y=Math.min(($=o.current.getBoundingClientRect().height)!=null?$:0,window.innerHeight);var pe;const ge=Math.min((pe=o.current.getBoundingClientRect().width)!=null?pe:0,window.innerWidth),Le=j==="left"||j==="right";if(Math.abs(Z)>=(Le?ge:Y)*k){De(),i==null||i(z,!1);return}i==null||i(z,!0),We()}u.useEffect(()=>(R&&(ye(document.documentElement,{scrollBehavior:"auto"}),je.current=new Date),()=>{hr(document.documentElement,"scrollBehavior")}),[R]);function Be(z){const Z=z?(window.innerWidth-rt)/window.innerWidth:1,ee=z?-rt:0;ue.current&&window.clearTimeout(ue.current),ye(o.current,{transition:`transform ${fe.DURATION}s cubic-bezier(${fe.EASE.join(",")})`,transform:ve(j)?`scale(${Z}) translate3d(0, ${ee}px, 0)`:`scale(${Z}) translate3d(${ee}px, 0, 0)`}),!z&&o.current&&(ue.current=setTimeout(()=>{const J=xt(o.current,j);ye(o.current,{transition:"none",transform:ve(j)?`translate3d(0, ${J}px, 0)`:`translate3d(${J}px, 0, 0)`})},500))}function Ie(z,Z){if(Z<0)return;const ee=(window.innerWidth-rt)/window.innerWidth,J=ee+Z*(1-ee),oe=-rt+Z*rt;ye(o.current,{transform:ve(j)?`scale(${J}) translate3d(0, ${oe}px, 0)`:`scale(${J}) translate3d(${oe}px, 0, 0)`,transition:"none"})}function qe(z,Z){const ee=ve(j)?window.innerHeight:window.innerWidth,J=Z?(ee-rt)/ee:1,oe=Z?-rt:0;Z&&ye(o.current,{transition:`transform ${fe.DURATION}s cubic-bezier(${fe.EASE.join(",")})`,transform:ve(j)?`scale(${J}) translate3d(0, ${oe}px, 0)`:`scale(${J}) translate3d(${oe}px, 0, 0)`})}return u.useEffect(()=>{F||window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"})},[F]),u.createElement(Ln,{defaultOpen:V,onOpenChange:z=>{!v&&!z||(z?se(!0):De(!0),Q(z))},open:R},u.createElement(nn.Provider,{value:{activeSnapPoint:Pe,snapPoints:l,setActiveSnapPoint:Ae,drawerRef:o,overlayRef:le,onOpenChange:n,onPress:ot,onRelease:it,onDrag:Ee,dismissible:v,shouldAnimate:C,handleOnly:h,isOpen:R,isDragging:te,shouldFade:_e,closeDrawer:De,onNestedDrag:Ie,onNestedOpenChange:Be,onNestedRelease:qe,keyboardIsOpen:ae,modal:F,snapPointsOffset:Re,activeSnapPointIndex:Se,direction:j,shouldScaleBackground:b,setBackgroundColorOnScale:w,noBodyStyles:P,container:g,autoFocus:_}},r))}const mn=u.forwardRef(function({...t},n){const{overlayRef:r,snapPoints:a,onRelease:i,shouldFade:l,isOpen:b,modal:w,shouldAnimate:k}=ft(),L=an(n,r),v=a&&a.length>0;if(!w)return null;const h=u.useCallback(m=>i(m),[i]);return u.createElement(Tn,{onMouseUp:h,ref:L,"data-vaul-overlay":"","data-vaul-snap-points":b&&v?"true":"false","data-vaul-snap-points-overlay":b&&l?"true":"false","data-vaul-animate":k!=null&&k.current?"true":"false",...t})});mn.displayName="Drawer.Overlay";const fn=u.forwardRef(function({onPointerDownOutside:t,style:n,onOpenAutoFocus:r,...a},i){const{drawerRef:l,onPress:b,onRelease:w,onDrag:k,keyboardIsOpen:L,snapPointsOffset:v,activeSnapPointIndex:h,modal:m,isOpen:D,direction:M,snapPoints:T,container:F,handleOnly:E,shouldAnimate:S,autoFocus:P}=ft(),[j,V]=u.useState(!1),q=an(i,l),f=u.useRef(null),x=u.useRef(null),W=u.useRef(!1),H=T&&T.length>0;yr();const g=(c,O,R=0)=>{if(W.current)return!0;const Q=Math.abs(c.y),N=Math.abs(c.x),se=N>Q,te=["bottom","right"].includes(O)?1:-1;if(O==="left"||O==="right"){if(!(c.x*te<0)&&N>=0&&N<=R)return se}else if(!(c.y*te<0)&&Q>=0&&Q<=R)return!se;return W.current=!0,!0};u.useEffect(()=>{H&&window.requestAnimationFrame(()=>{V(!0)})},[]);function _(c){f.current=null,W.current=!1,w(c)}return u.createElement(_n,{"data-vaul-drawer-direction":M,"data-vaul-drawer":"","data-vaul-delayed-snap-points":j?"true":"false","data-vaul-snap-points":D&&H?"true":"false","data-vaul-custom-container":F?"true":"false","data-vaul-animate":S!=null&&S.current?"true":"false",...a,ref:q,style:v&&v.length>0?{"--snap-point-height":`${v[h??0]}px`,...n}:n,onPointerDown:c=>{E||(a.onPointerDown==null||a.onPointerDown.call(a,c),f.current={x:c.pageX,y:c.pageY},b(c))},onOpenAutoFocus:c=>{r==null||r(c),P||c.preventDefault()},onPointerDownOutside:c=>{if(t==null||t(c),!m||c.defaultPrevented){c.preventDefault();return}L.current&&(L.current=!1)},onFocusOutside:c=>{if(!m){c.preventDefault();return}},onPointerMove:c=>{if(x.current=c,E||(a.onPointerMove==null||a.onPointerMove.call(a,c),!f.current))return;const O=c.pageY-f.current.y,R=c.pageX-f.current.x,Q=c.pointerType==="touch"?10:2;g({x:R,y:O},M,Q)?k(c):(Math.abs(R)>Q||Math.abs(O)>Q)&&(f.current=null)},onPointerUp:c=>{a.onPointerUp==null||a.onPointerUp.call(a,c),f.current=null,W.current=!1,w(c)},onPointerOut:c=>{a.onPointerOut==null||a.onPointerOut.call(a,c),_(x.current)},onContextMenu:c=>{a.onContextMenu==null||a.onContextMenu.call(a,c),x.current&&_(x.current)}})});fn.displayName="Drawer.Content";const Cr=250,Sr=120,Rr=u.forwardRef(function({preventCycle:t=!1,children:n,...r},a){const{closeDrawer:i,isDragging:l,snapPoints:b,activeSnapPoint:w,setActiveSnapPoint:k,dismissible:L,handleOnly:v,isOpen:h,onPress:m,onDrag:D}=ft(),M=u.useRef(null),T=u.useRef(!1);function F(){if(T.current){P();return}window.setTimeout(()=>{E()},Sr)}function E(){if(l||t||T.current){P();return}if(P(),!b||b.length===0){L||i();return}if(w===b[b.length-1]&&L){i();return}const V=b.findIndex(f=>f===w);if(V===-1)return;const q=b[V+1];k(q)}function S(){M.current=window.setTimeout(()=>{T.current=!0},Cr)}function P(){M.current&&window.clearTimeout(M.current),T.current=!1}return u.createElement("div",{onClick:F,onPointerCancel:P,onPointerDown:j=>{v&&m(j),S()},onPointerMove:j=>{v&&D(j)},ref:a,"data-vaul-drawer-visible":h?"true":"false","data-vaul-handle":"","aria-hidden":"true",...r},u.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},n))});Rr.displayName="Drawer.Handle";function Er(t){const n=ft(),{container:r=n.container,...a}=t;return u.createElement(Mn,{container:r,...a})}const ht={Root:Nr,Content:fn,Overlay:mn,Portal:Er,Title:En};function Lt({...t}){return e.jsx(ht.Root,{"data-slot":"drawer",...t})}function Lr({...t}){return e.jsx(ht.Portal,{"data-slot":"drawer-portal",...t})}function _r({className:t,...n}){return e.jsx(ht.Overlay,{"data-slot":"drawer-overlay",className:Te("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...n})}function _t({className:t,children:n,...r}){return e.jsxs(Lr,{"data-slot":"drawer-portal",children:[e.jsx(_r,{}),e.jsxs(ht.Content,{"data-slot":"drawer-content",className:Te("group/drawer-content bg-background fixed z-50 flex h-auto flex-col","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg data-[vaul-drawer-direction=top]:border-b","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg data-[vaul-drawer-direction=bottom]:border-t","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:border-l data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:border-r data-[vaul-drawer-direction=left]:sm:max-w-sm",t),...r,children:[e.jsx("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),n]})]})}function Xt({className:t,...n}){return e.jsx("div",{"data-slot":"drawer-header",className:Te("flex flex-col gap-0.5 p-4 group-data-[vaul-drawer-direction=bottom]/drawer-content:text-center group-data-[vaul-drawer-direction=top]/drawer-content:text-center md:gap-1.5 md:text-left",t),...n})}function Gt({className:t,...n}){return e.jsx(ht.Title,{"data-slot":"drawer-title",className:Te("text-foreground font-semibold",t),...n})}function Mr(){const t=Jt(),{selectedWatchDirs:n,selectedSources:r,setFiles:a,refreshFiles:i,showAllFiles:l,setShowAllFiles:b,page:w,setPage:k,pageSize:L,setPageSize:v,sortColumn:h,setSortColumn:m,sortDirection:D,setSortDirection:M,totalPages:T,totalRecords:F}=Qt(),[E,S]=d.useState(new Set),[P,j]=d.useState(""),[V,q]=d.useState(""),[f,x]=d.useState({}),[W,H]=d.useState(!1),[g]=d.useState([]),[_]=d.useState(null),[c]=d.useState("TODO delete"),[O,R]=d.useState(!0),[Q,N]=d.useState(0),[se,te]=d.useState(null),[ke,ie]=d.useState(0),[xe,le]=d.useState(!1),[je,re]=d.useState(!1),[$e,de]=d.useState(!1),[Ce,ue]=d.useState(!1),[Ne,ae]=d.useState(!1),[C,p]=d.useState(!1),[o,U]=d.useState(null),[X,ce]=d.useState(null),[ne,Pe]=d.useState(null),[Se,Ae]=d.useState(""),Ke=d.useRef({}),Re=d.useRef({}),Xe=d.useRef({}),_e=d.useRef(null),Ze=!0;d.useEffect(()=>{const $=_e.current;if(!$||!Ze)return;const Y=()=>{const pe=$.scrollTop;R(pe<=10),N(pe)};return $.addEventListener("scroll",Y),Y(),()=>{$.removeEventListener("scroll",Y)}},[Ze]);const st=()=>{const $=_e.current;$&&$.scrollTo({top:0,behavior:"smooth"})},Me=async()=>{if(!P.trim()){x({}),q("");return}H(!0);try{const $=new URLSearchParams;$.append("query",P),n.length>0&&$.append("filter",n.join(",")),r.length>0&&$.append("sources",r.join(","));const Y=await fetch(Ve(`/api/search?${$.toString()}`));if(Y.ok){const pe=await Y.json();if(pe.success){x(pe.data.map(me=>({[me.file_path]:me.matches.map(he=>he.line_number)})).reduce((me,he)=>({...me,...he}),{}));const Le=pe.data.map(me=>{const he=me.matches[0];return he&&he.video_info?he.video_info:null}).filter(me=>me!==null).filter((me,he,Ye)=>he===Ye.findIndex(tt=>tt.full_path===me.full_path));a(Le)}q(P)}}catch($){console.error("Error searching:",$)}finally{H(!1)}},ot=()=>{b($=>!$)},et=()=>{j(""),q(""),x({}),S(new Set),l&&i()},Ee=$=>{const Y=Math.floor($/3600),pe=Math.floor($%3600/60),ge=$%60,Le=Math.floor(ge),me=Math.round((ge-Le)*1e3);return`${Y.toString().padStart(2,"0")}:${pe.toString().padStart(2,"0")}:${Le.toString().padStart(2,"0")}.${me.toString().padStart(3,"0")}`},De=$=>{U($)},We=$=>{ce($)},Oe=d.useCallback(($,Y)=>{t?$?(ue(!0),ae(!1),p(!1)):ue(!1):(te($),re(!1),de(!1))},[t]),it=()=>{t?(ae(!0),ue(!1),p(!1)):(re(!0),de(!1),te(null))},Be=()=>{t?(p(!0),ue(!1),ae(!1)):(de(!0),re(!1),te(null))},Ie=()=>{if(re(!1),o!==null&&X!==null&&ne){const $=`/clip_player/${encodeURIComponent(ne)}?start_time=${o}&end_time=${X}&display_text=false`,Y=e.jsx("div",{className:"w-full flex-1 overflow-y-auto scrollbar-hide",children:e.jsx(dt,{filename:ne,start_time_formatted:Ee(o),end_time_formatted:Ee(X),font_size:"",text:Se,display_text:!1,onStartTimeChange:De,onEndTimeChange:We,onBack:()=>{t?ue(!1):(te(null),ee())}},ne)});Oe(Y,$)}},qe=()=>{if(de(!1),o!==null&&X!==null&&ne){const $=`/clip_player/${encodeURIComponent(ne)}?start_time=${o}&end_time=${X}&display_text=false`,Y=e.jsx("div",{className:"w-full flex-1 overflow-y-auto scrollbar-hide",children:e.jsx(dt,{filename:ne,start_time_formatted:Ee(o),end_time_formatted:Ee(X),font_size:"",text:Se,display_text:!1,onStartTimeChange:De,onEndTimeChange:We,onBack:()=>{t?ue(!1):(te(null),ee())}},ne)});Oe(Y,$)}},z=($,Y)=>{ne&&ne!==Y?(U($),ce(null),Pe(Y)):(U($),Pe(Y))},Z=($,Y)=>{ne&&ne!==Y?(U(null),ce($),Pe(Y)):(ce($),Pe(Y))},ee=()=>{U(null),ce(null),Pe(null),Ae(""),te(null),ue(!1),ae(!1),p(!1),re(!1),de(!1)},J=($,Y,pe,ge)=>{U($),ce(Y),Pe(ge),Ae(pe)},oe=()=>{if(o!==null&&X!==null&&ne){const $=`/clip_player/${encodeURIComponent(ne)}?start_time=${o}&end_time=${X}&display_text=false`,Y=e.jsx("div",{className:"w-full flex-1 overflow-y-auto scrollbar-hide",children:e.jsx(dt,{filename:ne,start_time_formatted:Ee(o),end_time_formatted:Ee(X),font_size:"",text:Se,display_text:!1,onStartTimeChange:De,onEndTimeChange:We,onBack:()=>{t?(Oe(null),R(!0),setTimeout(()=>{_e.current&&(_e.current.scrollTop=Q)},0)):te(null)}},ne)});Oe(Y,$)}};return d.useEffect(()=>{if(o!==null&&X!==null&&ne){const $=`/clip_player/${encodeURIComponent(ne)}?start_time=${o}&end_time=${X}&display_text=false`,Y=e.jsx("div",{className:"w-full flex-1 overflow-y-auto scrollbar-hide",children:e.jsx(dt,{filename:ne,start_time_formatted:Ee(o),end_time_formatted:Ee(X),font_size:"",text:Se,display_text:!1,onStartTimeChange:De,onEndTimeChange:We,onBack:()=>{t?ue(!1):(te(null),ee())}},ne)});Oe(Y,$)}else(o!==null||X!==null)&&(t?ue(!1):te(null))},[o,X,ne,Oe,t]),d.useEffect(()=>{typeof window<"u"&&(window.handleSetRightPaneComponent=Oe)},[Oe]),e.jsxs(e.Fragment,{children:[e.jsx(qn,{show:!0,searchTerm:P,setSearchTerm:j,activeSearchTerm:V,setActiveSearchTerm:q,setSearchLineNumbers:x,setExpandedFiles:S,isSearching:W,queue:g,currentProcessingFile:_,isAtTop:O,clipStart:o,clipEnd:X,selectedWatchDirs:n,setSelectedWatchDirs:()=>{},availableWatchDirs:[],selectedSources:r,setSelectedSources:()=>{},availableSources:[],showAllFiles:l,onToggleShowAllFiles:ot,onSearch:Me,onClearSearch:et,onScrollToTop:st,onConfigClick:it,onQueueClick:Be,mobileClipPlayerComponent:null,onPlayClip:oe}),e.jsxs("div",{className:"flex h-screen",children:[e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-hide",children:e.jsx(Kn,{watchDirectory:c,isSmallScreen:t,activeSearchTerm:V,searchLineNumbers:f,setSearchLineNumbers:x,expandedFiles:E,setExpandedFiles:S,currentProcessingFile:_,leftPaneWidth:ke,setLeftPaneWidth:ie,isLeftPaneWidthMeasured:xe,setIsLeftPaneWidthMeasured:le,clipStart:o,clipEnd:X,clipTranscript:ne,fileRowRefs:Ke,transcriptRowRefs:Re,mobileTranscriptRowRefs:Xe,leftPaneRef:_e,onSetRightPaneUrl:Oe,onSetClipStart:z,onSetClipEnd:Z,onClearClip:ee,onClipBlock:J,showAllFiles:l})}),!t&&e.jsx("div",{className:"w-1/3 border-l border-border flex flex-col scrollbar-hide pt-16",children:je?e.jsx(Ht,{onClose:Ie}):$e?e.jsx(It,{onClose:qe}):se||e.jsx(Zn,{})})]}),t&&e.jsxs(e.Fragment,{children:[e.jsx(Lt,{open:Ce,onOpenChange:ue,children:e.jsx(_t,{children:e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o!==null&&X!==null&&ne&&e.jsx(dt,{filename:ne,start_time_formatted:Ee(o),end_time_formatted:Ee(X),font_size:"",text:Se,display_text:!1,onStartTimeChange:De,onEndTimeChange:We,onBack:()=>ue(!1)},ne)})})}),e.jsx(Lt,{open:Ne,onOpenChange:ae,children:e.jsxs(_t,{children:[e.jsx(Xt,{children:e.jsx(Gt,{children:"Configuration"})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(Ht,{onClose:()=>ae(!1)})})]})}),e.jsx(Lt,{open:C,onOpenChange:p,children:e.jsxs(_t,{children:[e.jsx(Xt,{children:e.jsx(Gt,{children:"Processing Queue"})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx(It,{onClose:()=>p(!1)})})]})})]})]})}function Fr(){return e.jsx(Mr,{})}export{Fr as default};
